<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title id="pageTitle">CardGift - Admin Dashboard</title>
   
   <!-- PWA Meta tags -->
   <meta name="description" content="CardGift Admin Dashboard - Manage your network">
   <meta name="theme-color" content="#FFD700">
   
   <!-- Favicon fix -->
   <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÅ</text></svg>">
   
   <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: Web3 Integration - SafePal Priority -->
   <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
   
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       body {
           font-family: 'Arial', sans-serif;
           background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
           color: #FFFFFF;
           overflow-x: hidden;
           min-height: 100vh;
       }

       /* –ó–æ–ª–æ—Ç—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ */
       body::before {
           content: '';
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                       radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
           pointer-events: none;
           z-index: -1;
       }

       /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
       .language-switcher {
           position: fixed;
           top: 15px;
           right: 15px;
           z-index: 1000;
           display: flex;
           background: rgba(0, 0, 0, 0.9);
           border-radius: 15px;
           padding: 4px;
           backdrop-filter: blur(10px);
           border: 1px solid rgba(255, 215, 0, 0.3);
       }

       .lang-btn {
           background: transparent;
           border: none;
           color: #FFD700;
           padding: 6px 12px;
           border-radius: 10px;
           cursor: pointer;
           font-size: 12px;
           font-weight: bold;
           transition: all 0.3s ease;
           min-width: 35px;
       }

       .lang-btn.active {
           background: rgba(255, 215, 0, 0.3);
           color: #FFF;
       }

       /* SIDEBAR */
       .sidebar {
           position: fixed;
           left: 0;
           top: 0;
           width: 280px;
           height: 100vh;
           background: rgba(0, 0, 0, 0.95);
           backdrop-filter: blur(20px);
           border-right: 2px solid #FFD700;
           z-index: 100;
           overflow-y: auto;
           overflow-x: hidden;
           transition: transform 0.3s ease;
           scrollbar-width: thin;
           scrollbar-color: #FFD700 transparent;
       }

       .sidebar::-webkit-scrollbar {
           width: 4px;
       }

       .sidebar::-webkit-scrollbar-track {
           background: transparent;
       }

       .sidebar::-webkit-scrollbar-thumb {
           background: #FFD700;
           border-radius: 2px;
       }

       .sidebar.mobile-hidden {
           transform: translateX(-100%);
       }

       .sidebar-header {
           padding: 25px 20px;
           text-align: center;
           border-bottom: 1px solid rgba(255, 215, 0, 0.3);
       }

       .logo {
           font-size: 28px;
           background: linear-gradient(45deg, #FFD700, #FFA500);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           font-weight: bold;
           margin-bottom: 8px;
       }

       .user-info {
           background: rgba(255, 215, 0, 0.1);
           border-radius: 10px;
           padding: 15px;
           margin-top: 15px;
       }

       .user-level {
           background: #FFD700;
           color: #000;
           padding: 4px 10px;
           border-radius: 15px;
           font-size: 11px;
           font-weight: bold;
           display: inline-block;
           margin-bottom: 8px;
       }

       .user-id {
           color: #CCC;
           font-size: 12px;
       }

       /* NOTIFICATION BADGE */
       .notification-badge {
           position: absolute;
           top: -8px;
           right: -8px;
           background: #FF4444;
           color: white;
           border-radius: 50%;
           width: 20px;
           height: 20px;
           font-size: 10px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           animation: pulse 2s infinite;
       }

       .notification-badge.read {
           background: #4CAF50;
           animation: none;
       }

       .notification-badge.hidden {
           display: none;
       }

       @keyframes pulse {
           0% { transform: scale(1); }
           50% { transform: scale(1.1); }
           100% { transform: scale(1); }
       }

       /* MENU */
       .sidebar-menu {
           padding: 20px 0;
       }

       .menu-item {
           display: flex;
           align-items: center;
           padding: 15px 25px;
           color: #CCC;
           text-decoration: none;
           transition: all 0.3s ease;
           border-left: 3px solid transparent;
           cursor: pointer;
           position: relative;
       }

       .menu-item:hover {
           background: rgba(255, 215, 0, 0.1);
           color: #FFF;
       }

       .menu-item.active {
           background: rgba(255, 215, 0, 0.2);
           border-left-color: #FFD700;
           color: #FFD700;
       }

       .menu-item.locked {
           opacity: 0.4;
           cursor: not-allowed;
           position: relative;
       }

       .menu-item.locked::after {
           content: "üîí";
           position: absolute;
           right: 25px;
           font-size: 16px;
       }

       .menu-icon {
           width: 24px;
           margin-right: 15px;
           text-align: center;
           font-size: 18px;
       }

       /* MAIN CONTENT */
       .main-content {
           margin-left: 280px;
           padding: 30px;
           min-height: 100vh;
           transition: margin-left 0.3s ease;
       }

       .main-content.full-width {
           margin-left: 0;
       }

       /* MOBILE TOGGLE */
       .mobile-toggle {
           display: none;
           position: fixed;
           top: 15px;
           left: 15px;
           z-index: 1001;
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 10px;
           padding: 10px;
           cursor: pointer;
           color: #FFD700;
       }

       /* SECTION */
       .content-section {
           display: none;
           animation: fadeInUp 0.5s ease;
       }

       .content-section.active {
           display: block;
       }

       .section-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 30px;
           flex-wrap: wrap;
           gap: 15px;
       }

       .section-title {
           font-size: 28px;
           color: #FFD700;
           font-weight: bold;
       }

       /* STATS CARDS */
       .stats-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
           margin-bottom: 30px;
       }

       .stat-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 15px;
           padding: 20px;
           text-align: center;
           transition: transform 0.3s ease;
       }

       .stat-card:hover {
           transform: translateY(-5px);
       }

       .stat-icon {
           font-size: 32px;
           margin-bottom: 10px;
       }

       .stat-number {
           font-size: 24px;
           font-weight: bold;
           color: #FFD700;
           margin-bottom: 5px;
       }

       .stat-label {
           color: #CCC;
           font-size: 14px;
       }

       /* CONTACT CATEGORIES */
       .contact-categories {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 15px;
           margin-bottom: 30px;
       }

       .category-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 15px;
           text-align: center;
           transition: all 0.3s ease;
           cursor: pointer;
       }

       .category-card:hover {
           border-color: #FFD700;
           background: rgba(255, 215, 0, 0.05);
       }

       .category-icon {
           font-size: 24px;
           margin-bottom: 8px;
       }

       .category-name {
           font-weight: bold;
           margin-bottom: 5px;
       }

       .category-count {
           color: #FFD700;
           font-size: 18px;
           font-weight: bold;
       }

       /* REFERRAL SYSTEM */
       .referral-section {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï LEVEL BUTTONS - —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º */
       .level-buttons {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
           overflow-x: auto;
           overflow-y: hidden;
           scrollbar-width: none;
           -ms-overflow-style: none;
           padding: 5px 0;
           justify-content: flex-start;
       }

       .level-buttons::-webkit-scrollbar {
           display: none;
       }

       .level-btn {
           background: rgba(255, 215, 0, 0.1);
           border: 2px solid #FFD700;
           color: #FFD700;
           border-radius: 50%;
           width: 50px;
           height: 50px;
           min-width: 50px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           cursor: pointer;
           transition: all 0.3s ease;
           position: relative;
           flex-shrink: 0;
       }

       .level-btn:hover {
           background: rgba(255, 215, 0, 0.2);
           transform: scale(1.1);
       }

       .level-btn.active {
           background: #FFD700;
           color: #000;
       }

       .level-btn.locked {
           opacity: 0.3;
           cursor: not-allowed;
       }

       .level-btn.locked::after {
           content: "üîí";
           position: absolute;
           top: -5px;
           right: -5px;
           font-size: 12px;
       }

       /* LEVEL CONTENT */
       .level-content {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 10px;
           padding: 20px;
           margin-top: 20px;
           display: none;
       }

       .level-content.active {
           display: block;
       }

       .level-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 15px;
           flex-wrap: wrap;
       }

       .level-title {
           color: #FFD700;
           font-weight: bold;
           font-size: 18px;
       }

       .level-count {
           background: rgba(255, 215, 0, 0.2);
           color: #FFD700;
           padding: 4px 12px;
           border-radius: 15px;
           font-size: 12px;
           font-weight: bold;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø TEAM TABLE - —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º */
       .team-table {
           overflow-x: auto;
           overflow-y: hidden;
           scrollbar-width: thin;
           scrollbar-color: #FFD700 transparent;
           border-radius: 10px;
           border: 1px solid rgba(255, 215, 0, 0.2);
       }

       .team-table::-webkit-scrollbar {
           height: 6px;
       }

       .team-table::-webkit-scrollbar-track {
           background: rgba(255, 215, 0, 0.1);
           border-radius: 3px;
       }

       .team-table::-webkit-scrollbar-thumb {
           background: #FFD700;
           border-radius: 3px;
       }

       .team-table table {
           width: 100%;
           border-collapse: collapse;
           min-width: 700px;
       }

       .team-table th {
           background: rgba(255, 215, 0, 0.1);
           color: #FFD700;
           padding: 12px 8px;
           text-align: left;
           border-bottom: 2px solid #FFD700;
           font-size: 14px;
           white-space: nowrap;
           position: sticky;
           top: 0;
           z-index: 10;
       }

       .team-table td {
           padding: 10px 8px;
           border-bottom: 1px solid rgba(255, 215, 0, 0.2);
           color: #FFF;
           font-size: 13px;
           white-space: nowrap;
       }

       .team-table tr:hover {
           background: rgba(255, 215, 0, 0.05);
       }

       .user-id-cell {
           color: #4CAF50;
           font-weight: bold;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .user-id-cell:hover {
           color: #FFD700;
       }

       .wallet-status {
           padding: 2px 6px;
           border-radius: 10px;
           font-size: 10px;
           font-weight: bold;
       }

       .wallet-active {
           background: rgba(76, 175, 80, 0.3);
           color: #4CAF50;
       }

       .wallet-inactive {
           background: rgba(128, 128, 128, 0.3);
           color: #888;
       }

       .status-badge {
           padding: 3px 8px;
           border-radius: 12px;
           font-size: 10px;
           font-weight: bold;
       }

       .status-coauthor {
           background: rgba(139, 69, 19, 0.3);
           color: #D2691E;
       }

       .status-super {
           background: rgba(255, 215, 0, 0.3);
           color: #FFD700;
       }

       .status-mini {
           background: rgba(255, 193, 7, 0.3);
           color: #FFC107;
       }

       .status-basic {
           background: rgba(128, 128, 128, 0.3);
           color: #CCC;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô CRM MODAL - –ù–û–í–´–ô –î–ò–ó–ê–ô–ù */
       .crm-modal {
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.9);
           z-index: 2000;
           display: none;
           align-items: center;
           justify-content: center;
           padding: 20px;
           backdrop-filter: blur(10px);
       }

       .crm-modal.show {
           display: flex;
       }

       .crm-modal-content {
           background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(26, 26, 26, 0.95) 100%);
           border: 2px solid #FFD700;
           border-radius: 20px;
           padding: 30px;
           max-width: 600px;
           width: 100%;
           max-height: 80vh;
           overflow-y: auto;
           box-shadow: 0 20px 40px rgba(255, 215, 0, 0.3);
           backdrop-filter: blur(20px);
       }

       .crm-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 25px;
           padding-bottom: 15px;
           border-bottom: 2px solid rgba(255, 215, 0, 0.3);
       }

       .crm-title {
           color: #FFD700;
           font-size: 24px;
           font-weight: bold;
           background: linear-gradient(45deg, #FFD700, #FFA500);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
       }

       .close-btn {
           background: rgba(255, 68, 68, 0.2);
           border: 2px solid #FF4444;
           color: #FF4444;
           border-radius: 50%;
           width: 40px;
           height: 40px;
           font-size: 20px;
           cursor: pointer;
           transition: all 0.3s ease;
           display: flex;
           align-items: center;
           justify-content: center;
       }

       .close-btn:hover {
           background: rgba(255, 68, 68, 0.3);
           transform: scale(1.1);
       }

       .crm-tabs {
           display: flex;
           gap: 10px;
           margin-bottom: 25px;
           overflow-x: auto;
           scrollbar-width: none;
           -ms-overflow-style: none;
           padding: 5px 0;
       }

       .crm-tabs::-webkit-scrollbar {
           display: none;
       }

       .crm-tab {
           background: rgba(255, 255, 255, 0.1);
           border: 2px solid rgba(255, 215, 0, 0.3);
           color: #FFD700;
           padding: 12px 20px;
           border-radius: 12px;
           cursor: pointer;
           transition: all 0.3s ease;
           white-space: nowrap;
           flex-shrink: 0;
           font-weight: bold;
       }

       .crm-tab.active {
           background: linear-gradient(45deg, #FFD700, #FFA500);
           color: #000;
           border-color: #FFD700;
           box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
       }

       .crm-tab:hover:not(.active) {
           background: rgba(255, 215, 0, 0.2);
           border-color: #FFD700;
       }

       .crm-content {
           display: none;
           animation: fadeInUp 0.3s ease;
       }

       .crm-content.active {
           display: block;
       }

       .notes-textarea {
           width: 100%;
           min-height: 150px;
           background: rgba(255, 255, 255, 0.1);
           border: 2px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 15px;
           color: #FFF;
           resize: vertical;
           font-family: inherit;
           font-size: 14px;
           line-height: 1.5;
           transition: border-color 0.3s ease;
       }

       .notes-textarea:focus {
           outline: none;
           border-color: #FFD700;
           box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
       }

       .notes-textarea::placeholder {
           color: #888;
       }

       .save-btn {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
           border: none;
           border-radius: 12px;
           padding: 12px 25px;
           cursor: pointer;
           margin-top: 15px;
           transition: all 0.3s ease;
           font-weight: bold;
           font-size: 14px;
       }

       .save-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
       }

       /* CHAT SECTION */
       .chat-container {
           border: 2px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           height: 350px;
           display: flex;
           flex-direction: column;
           overflow: hidden;
       }

       .chat-messages {
           flex: 1;
           padding: 20px;
           overflow-y: auto;
           background: rgba(255, 255, 255, 0.05);
           scrollbar-width: thin;
           scrollbar-color: #FFD700 transparent;
       }

       .chat-messages::-webkit-scrollbar {
           width: 6px;
       }

       .chat-messages::-webkit-scrollbar-track {
           background: rgba(255, 255, 255, 0.1);
       }

       .chat-messages::-webkit-scrollbar-thumb {
           background: #FFD700;
           border-radius: 3px;
       }

       .chat-message {
           background: rgba(255, 215, 0, 0.1);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 12px;
           margin-bottom: 10px;
           animation: slideInRight 0.3s ease;
       }

       .chat-message-time {
           font-size: 11px;
           color: #888;
           margin-bottom: 5px;
       }

       .chat-message-text {
           color: #FFF;
           line-height: 1.4;
       }

       .chat-input-area {
           padding: 15px;
           border-top: 2px solid rgba(255, 215, 0, 0.3);
           display: flex;
           gap: 10px;
           background: rgba(0, 0, 0, 0.3);
       }

       .chat-input {
           flex: 1;
           background: rgba(255, 255, 255, 0.1);
           border: 2px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 10px 15px;
           color: #FFF;
           font-size: 14px;
           transition: border-color 0.3s ease;
       }

       .chat-input:focus {
           outline: none;
           border-color: #FFD700;
       }

       .chat-input::placeholder {
           color: #888;
       }

       .send-btn {
           background: linear-gradient(45deg, #FFD700, #FFA500);
           color: #000;
           border: none;
           border-radius: 12px;
           padding: 10px 20px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
           font-size: 14px;
       }

       .send-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
       }

       /* ‚úÖ –ù–û–í–´–ô –°–û–í–†–ï–ú–ï–ù–ù–´–ô DIALOG –î–õ–Ø –°–û–ó–î–ê–ù–ò–Ø –ß–ê–¢–ê */
       .new-chat-dialog {
           position: fixed;
           top: 50%;
           left: 50%;
           transform: translate(-50%, -50%);
           background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(26, 26, 26, 0.95) 100%);
           border: 2px solid #FFD700;
           border-radius: 20px;
           padding: 30px;
           min-width: 400px;
           max-width: 90vw;
           z-index: 3000;
           box-shadow: 0 20px 40px rgba(255, 215, 0, 0.3);
           backdrop-filter: blur(20px);
           display: none;
       }

       .new-chat-dialog.show {
           display: block;
           animation: dialogSlideIn 0.3s ease;
       }

       .new-chat-dialog::backdrop {
           background: rgba(0, 0, 0, 0.8);
           backdrop-filter: blur(5px);
       }

       .dialog-header {
           text-align: center;
           margin-bottom: 25px;
       }

       .dialog-title {
           color: #FFD700;
           font-size: 24px;
           font-weight: bold;
           background: linear-gradient(45deg, #FFD700, #FFA500);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           margin-bottom: 10px;
       }

       .dialog-input {
           width: 100%;
           background: rgba(255, 255, 255, 0.1);
           border: 2px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 15px;
           color: #FFF;
           font-size: 16px;
           margin-bottom: 25px;
           transition: border-color 0.3s ease;
       }

       .dialog-input:focus {
           outline: none;
           border-color: #FFD700;
           box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
       }

       .dialog-input::placeholder {
           color: #888;
       }

       .dialog-buttons {
           display: flex;
           gap: 15px;
           justify-content: center;
       }

       .dialog-btn {
           padding: 12px 25px;
           border: none;
           border-radius: 12px;
           font-size: 16px;
           font-weight: bold;
           cursor: pointer;
           transition: all 0.3s ease;
           min-width: 120px;
       }

       .dialog-btn.primary {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
       }

       .dialog-btn.primary:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
       }

       .dialog-btn.secondary {
           background: rgba(255, 68, 68, 0.2);
           color: #FF4444;
           border: 2px solid #FF4444;
       }

       .dialog-btn.secondary:hover {
           background: rgba(255, 68, 68, 0.3);
           transform: translateY(-2px);
       }

       /* CO-AUTHORS MANAGEMENT */
       .coauthors-section {
           background: rgba(139, 69, 19, 0.1);
           border: 2px solid #D2691E;
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       .team-management-btn {
           background: linear-gradient(45deg, #D2691E, #A0522D);
           color: white;
           border: none;
           border-radius: 12px;
           padding: 15px 30px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
           font-size: 16px;
       }

       .team-management-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 20px rgba(210, 105, 30, 0.4);
       }

       .coauthor-item {
           display: flex;
           justify-content: space-between;
           align-items: center;
           padding: 15px;
           background: rgba(139, 69, 19, 0.1);
           border-radius: 10px;
           margin-bottom: 10px;
       }

       .coauthor-info {
           color: #D2691E;
           font-weight: bold;
       }

       .coauthor-actions {
           display: flex;
           gap: 10px;
       }

       .action-btn {
           background: rgba(255, 255, 255, 0.1);
           border: 2px solid #FFD700;
           color: #FFD700;
           border-radius: 8px;
           padding: 6px 12px;
           cursor: pointer;
           transition: all 0.3s ease;
           font-size: 12px;
           font-weight: bold;
       }

       .action-btn:hover {
           background: rgba(255, 215, 0, 0.2);
           transform: translateY(-1px);
       }

       .action-btn.danger {
           border-color: #FF4444;
           color: #FF4444;
       }

       .action-btn.danger:hover {
           background: rgba(255, 68, 68, 0.2);
       }

       /* DEVELOPMENT PLACEHOLDER */
       .development-placeholder {
           background: rgba(255, 165, 0, 0.1);
           border: 2px dashed #FFA500;
           border-radius: 15px;
           padding: 50px;
           text-align: center;
           margin: 30px 0;
       }

       .development-icon {
           font-size: 64px;
           margin-bottom: 20px;
           animation: bounce 2s infinite;
       }

       .development-title {
           color: #FFA500;
           font-size: 24px;
           font-weight: bold;
           margin-bottom: 15px;
       }

       .development-text {
           color: #CCC;
           line-height: 1.6;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–ù–û–ü–ö–ò –ê–ö–¢–ò–í–ê–¶–ò–ò */
       .activation-buttons {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 15px;
           margin-top: 25px;
       }

       .activation-btn {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
           border: none;
           border-radius: 12px;
           padding: 18px 20px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
           font-size: 16px;
           text-align: center;
           position: relative;
           overflow: hidden;
       }

       .activation-btn.mini-admin {
           background: linear-gradient(45deg, #FF9800, #F57C00);
       }

       .activation-btn.super-admin {
           background: linear-gradient(45deg, #9C27B0, #7B1FA2);
       }

       .activation-btn:hover:not(:disabled) {
           transform: translateY(-3px);
           box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
       }

       .activation-btn:disabled {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           cursor: not-allowed;
           opacity: 0.7;
           transform: none;
       }

       .activation-btn:disabled::after {
           content: "‚úÖ ACTIVATED";
           position: absolute;
           top: 50%;
           left: 50%;
           transform: translate(-50%, -50%);
           background: rgba(0, 0, 0, 0.8);
           color: #4CAF50;
           padding: 5px 10px;
           border-radius: 6px;
           font-size: 12px;
           font-weight: bold;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–°–´–õ–ö–ê */
       .referral-link-container {
           display: flex;
           gap: 10px;
           align-items: center;
           margin-top: 15px;
       }

       .referral-link-input {
           flex: 1;
           background: rgba(255, 255, 255, 0.1);
           border: 2px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 12px 15px;
           color: #FFF;
           font-size: 14px;
           font-family: monospace;
           transition: border-color 0.3s ease;
       }

       .referral-link-input:focus {
           outline: none;
           border-color: #FFD700;
           box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
       }

       .referral-link-short {
           color: #888;
           font-size: 12px;
           margin-top: 5px;
       }

       .copy-btn, .share-btn {
           background: linear-gradient(45deg, #FFD700, #FFA500);
           color: #000;
           border: none;
           border-radius: 12px;
           padding: 12px 16px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
           font-size: 14px;
           min-width: 80px;
       }

       .copy-btn:hover, .share-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
       }

       .share-btn {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
       }

       .share-btn:hover {
           box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
       }

       /* ‚úÖ –£–õ–£–ß–®–ï–ù–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò */
       .settings-section {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 25px;
       }

       .settings-header {
           display: flex;
           align-items: center;
           margin-bottom: 20px;
           padding-bottom: 15px;
           border-bottom: 2px solid rgba(255, 215, 0, 0.3);
       }

       .settings-icon {
           font-size: 24px;
           margin-right: 15px;
           color: #FFD700;
       }

       .settings-title {
           color: #FFD700;
           font-size: 20px;
           font-weight: bold;
       }

       .settings-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
       }

       .setting-item {
           background: rgba(255, 255, 255, 0.05);
           border: 1px solid rgba(255, 215, 0, 0.2);
           border-radius: 12px;
           padding: 20px;
           transition: all 0.3s ease;
       }

       .setting-item:hover {
           background: rgba(255, 255, 255, 0.08);
           border-color: rgba(255, 215, 0, 0.4);
       }

       .setting-item-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 10px;
       }

       .setting-item-title {
           color: #FFD700;
           font-weight: bold;
           font-size: 16px;
       }

       .setting-item-description {
           color: #CCC;
           font-size: 14px;
           line-height: 1.4;
           margin-bottom: 15px;
       }

       .setting-toggle {
           position: relative;
           width: 50px;
           height: 25px;
           background: rgba(255, 255, 255, 0.2);
           border-radius: 15px;
           cursor: pointer;
           transition: background 0.3s ease;
       }

       .setting-toggle.active {
           background: #FFD700;
       }

       .setting-toggle::after {
           content: '';
           position: absolute;
           top: 3px;
           left: 3px;
           width: 19px;
           height: 19px;
           background: white;
           border-radius: 50%;
           transition: transform 0.3s ease;
       }

       .setting-toggle.active::after {
           transform: translateX(25px);
       }

       .setting-button {
           background: linear-gradient(45deg, #2196F3, #1976D2);
           color: white;
           border: none;
           border-radius: 8px;
           padding: 10px 20px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
           font-size: 14px;
       }

       .setting-button:hover {
           transform: translateY(-2px);
           box-shadow: 0 6px 15px rgba(33, 150, 243, 0.4);
       }

       .setting-button.danger {
           background: linear-gradient(45deg, #f44336, #d32f2f);
       }

       .setting-button.danger:hover {
           box-shadow: 0 6px 15px rgba(244, 67, 54, 0.4);
       }

       /* ANIMATIONS */
       @keyframes dialogSlideIn {
           from {
               opacity: 0;
               transform: translate(-50%, -50%) scale(0.8);
           }
           to {
               opacity: 1;
               transform: translate(-50%, -50%) scale(1);
           }
       }

       @keyframes slideInRight {
           from {
               opacity: 0;
               transform: translateX(20px);
           }
           to {
               opacity: 1;
               transform: translateX(0);
           }
       }

       @keyframes bounce {
           0%, 20%, 50%, 80%, 100% {
               transform: translateY(0);
           }
           40% {
               transform: translateY(-10px);
           }
           60% {
               transform: translateY(-5px);
           }
       }

       /* ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
       @media (max-width: 768px) {
           .sidebar {
               transform: translateX(-100%);
           }

           .sidebar.mobile-visible {
               transform: translateX(0);
           }

           .main-content {
               margin-left: 0;
               padding: 20px;
               padding-top: 70px;
           }

           .mobile-toggle {
               display: block;
           }

           .stats-grid {
               grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
               gap: 15px;
           }

           .contact-categories {
               grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
           }

           .section-header {
               flex-direction: column;
               align-items: flex-start;
               gap: 15px;
           }

           .language-switcher {
               top: 75px;
               right: 10px;
           }

           .level-buttons {
               gap: 8px;
               padding: 10px 5px;
               justify-content: flex-start;
           }

           .level-btn {
               width: 45px;
               height: 45px;
               min-width: 45px;
               font-size: 14px;
           }

           .crm-modal-content {
               padding: 20px;
               margin: 10px;
           }

           .team-table {
               font-size: 12px;
           }

           .team-table th,
           .team-table td {
               padding: 8px 4px;
               font-size: 11px;
           }

           .crm-tabs {
               gap: 5px;
           }

           .crm-tab {
               padding: 8px 12px;
               font-size: 12px;
           }

           .new-chat-dialog {
               min-width: 300px;
               padding: 20px;
           }

           .activation-buttons {
               grid-template-columns: 1fr;
           }

           .referral-link-container {
               flex-direction: column;
               gap: 10px;
           }

           .copy-btn, .share-btn {
               width: 100%;
           }

           .settings-grid {
               grid-template-columns: 1fr;
           }
       }

       @media (max-width: 480px) {
           .level-btn {
               width: 40px;
               height: 40px;
               min-width: 40px;
               font-size: 12px;
           }

           .level-buttons {
               gap: 5px;
           }

           .team-table table {
               min-width: 600px;
           }
       }

       @keyframes fadeInUp {
           from {
               opacity: 0;
               transform: translateY(30px);
           }
           to {
               opacity: 1;
               transform: translateY(0);
           }
       }
   </style>
</head>
<body>
   <!-- –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ -->
   <div class="language-switcher">
       <button class="lang-btn active" onclick="switchLanguage('en')" id="langEn">EN</button>
       <button class="lang-btn" onclick="switchLanguage('ru')" id="langRu">RU</button>
       <button class="lang-btn" onclick="switchLanguage('ua')" id="langUa">UA</button>
   </div>

   <!-- MOBILE TOGGLE -->
   <div class="mobile-toggle" onclick="toggleSidebar()">
       <span style="font-size: 20px;">‚ò∞</span>
   </div>

   <!-- SIDEBAR -->
   <div class="sidebar" id="sidebar">
       <div class="sidebar-header">
           <div class="logo">üéÅ CardGift</div>
           <div class="user-info">
               <div class="user-level" id="userLevel">NOT CONNECTED</div>
               <div class="user-id" id="userIdDisplay">ID: <span id="currentUserId">Connect Wallet</span></div>
           </div>
       </div>
       
       <nav class="sidebar-menu">
           <div class="menu-item active" onclick="showSection('dashboard')" data-section="dashboard">
               <div class="menu-icon">üìä</div>
               <span id="menuDashboard">Dashboard</span>
           </div>
           <div class="menu-item locked" onclick="showSection('contacts')" data-section="contacts">
               <div class="menu-icon">üë•</div>
               <span id="menuContacts">Contacts</span>
           </div>
           <div class="menu-item locked" onclick="showSection('referrals')" data-section="referrals">
               <div class="menu-icon">üîó</div>
               <span id="menuReferrals">Referral System</span>
               <div class="notification-badge hidden" id="referralNotifications">0</div>
           </div>
           <div class="menu-item locked" onclick="showSection('crm')" data-section="crm">
              <div class="menu-icon">üí¨</div>
              <span id="menuCRM">CRM & Chat</span>
              <div class="notification-badge hidden" id="crmNotifications">0</div>
          </div>
          <div class="menu-item locked" onclick="showSection('coauthors')" data-section="coauthors" id="coauthorsMenuItem">
              <div class="menu-icon">üëë</div>
              <span id="menuCoauthors">Co-Authors</span>
          </div>
          <div class="menu-item locked" onclick="showSection('mailings')" data-section="mailings">
              <div class="menu-icon">üì¢</div>
              <span id="menuMailings">Mass Mailings</span>
          </div>
          <div class="menu-item locked" onclick="showSection('analytics')" data-section="analytics">
              <div class="menu-icon">üìà</div>
              <span id="menuAnalytics">Advanced Analytics</span>
          </div>
          <div class="menu-item" onclick="showSection('wallet')" data-section="wallet">
              <div class="menu-icon">üíé</div>
              <span id="menuWallet">Web3 Wallet</span>
          </div>
         <div class="menu-item locked" onclick="showSection('settings')" data-section="settings">
             <div class="menu-icon">‚öôÔ∏è</div>
             <span id="menuSettings">Settings</span>
         </div>
     </nav>
 </div>

 <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô CRM MODAL -->
 <div class="crm-modal" id="crmModal">
     <div class="crm-modal-content">
         <div class="crm-header">
             <div class="crm-title" id="crmModalTitle"><span id="userCRM">User CRM</span></div>
             <button class="close-btn" onclick="closeCRMModal()">√ó</button>
         </div>
         
         <div class="crm-tabs">
             <button class="crm-tab active" onclick="switchCRMTab('notes')" id="notesTab"><span id="notes">üìù Notes</span></button>
             <button class="crm-tab" onclick="switchCRMTab('chat')" id="chatTab"><span id="chat">üí¨ Chat</span></button>
             <button class="crm-tab" onclick="switchCRMTab('social')" id="socialTab"><span id="social">üì± Social</span></button>
         </div>
         
         <div class="crm-content active" id="notesContent">
             <textarea class="notes-textarea" id="userNotes" placeholder="" data-placeholder="writeNotes"></textarea>
             <button class="save-btn" onclick="saveUserNotes()"><span id="saveNotes">üíæ Save Notes</span></button>
         </div>
         
         <div class="crm-content" id="chatContent">
             <div class="chat-container">
                 <div class="chat-messages" id="chatMessages">
                     <div style="text-align: center; color: #CCC; padding: 20px;">
                         No messages yet. Start a conversation!
                     </div>
                 </div>
                 <div class="chat-input-area">
                     <input type="text" class="chat-input" id="chatInput" placeholder="" data-placeholder="typeMessage">
                     <button class="send-btn" onclick="sendMessage()"><span id="send">Send</span></button>
                 </div>
             </div>
         </div>
         
         <div class="crm-content" id="socialContent">
             <div style="color: #CCC; line-height: 1.6;">
                 <h4 style="color: #FFD700; margin-bottom: 10px;">Contact Information:</h4>
                 <div id="userSocialInfo">
                     <p><strong>Platform:</strong> <span id="userPlatform">-</span></p>
                     <p><strong>Contact:</strong> <span id="userContact">-</span></p>
                     <p><strong>Registration Date:</strong> <span id="userRegDate">-</span></p>
                 </div>
                 <button class="save-btn" onclick="openSocialContact()">
                     üì± Open in Social Media
                 </button>
             </div>
         </div>
     </div>
 </div>

 <!-- ‚úÖ –ù–û–í–´–ô DIALOG –î–õ–Ø –°–û–ó–î–ê–ù–ò–Ø –ß–ê–¢–ê -->
 <div class="new-chat-dialog" id="newChatDialog">
     <div class="dialog-header">
         <div class="dialog-title" id="newChat">üí¨ New Chat</div>
         <p style="color: #CCC; margin-bottom: 0;" id="startConversation">Start a conversation with a user</p>
     </div>
     
     <input type="text" class="dialog-input" id="newChatUserId" placeholder="Enter User ID..." maxlength="50">
     
     <div class="dialog-buttons">
         <button class="dialog-btn primary" onclick="confirmNewChat()"><span id="startChat">Start Chat</span></button>
         <button class="dialog-btn secondary" onclick="cancelNewChat()"><span id="cancel">Cancel</span></button>
     </div>
 </div>

 <!-- MAIN CONTENT -->
 <div class="main-content" id="mainContent">
     
     <!-- DASHBOARD SECTION -->
    <div id="dashboard" class="content-section active">
        <div class="section-header">
            <h1 class="section-title" id="dashboardTitle">üìä Web3 Dashboard</h1>
            <div style="color: #CCC; font-size: 14px;" id="lastUpdate">Last update: <span id="updateTime">--:--</span></div>
        </div>

        <!-- CONNECTION STATUS -->
        <div class="referral-section" style="margin-bottom: 30px;">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üîê Connection Status</h3>
            <div id="connectionStatus" style="text-align: center; padding: 20px;">
                <div style="color: #FF4444; font-size: 18px; margin-bottom: 10px;">‚ö†Ô∏è Wallet Not Connected</div>
                <div style="color: #CCC;">Connect your SafePal wallet to access all features</div>
                <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 15px 30px; cursor: pointer; margin-top: 15px; font-weight: bold;" onclick="connectWallet()">
                   üîê Connect Wallet
               </button>
            </div>
        </div>

        <!-- MAIN STATS -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-number" id="totalContacts">0</div>
                <div class="stat-label" id="totalContactsLabel">Total Contacts</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üîó</div>
                <div class="stat-number" id="totalReferrals">0</div>
                <div class="stat-label" id="totalReferralsLabel">Active Referrals</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üíé</div>
                <div class="stat-number" id="totalEarnings">0.000</div>
                <div class="stat-label" id="totalEarningsLabel">Earnings (opBNB)</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üéÅ</div>
                <div class="stat-number" id="totalCards">0</div>
                <div class="stat-label" id="totalCardsLabel">Cards Generated</div>
            </div>
        </div>

       <!-- üåê Quick Navigation -->
<h3 style="color: #FFD700; margin-bottom: 20px;">üåê Quick Navigation</h3>
<div class="level-buttons" style="justify-content: flex-start; gap: 15px;">
    <button class="level-btn" onclick="openMainSite()" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        üè†<br>Main Site
    </button>
    <button class="level-btn" onclick="openGenerator()" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        üé®<br>Generator
    </button>
    <button class="level-btn" onclick="showSection('contacts')" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        üë•<br>Contacts
    </button>
    <button class="level-btn" onclick="showSection('referrals')" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        üîó<br>Referrals
    </button>
    <button class="level-btn" onclick="showSection('crm')" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        üí¨<br>CRM
    </button>
    <button class="level-btn" onclick="showSection('wallet')" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        üíé<br>Wallet
    </button>
    <button class="level-btn" onclick="showSection('settings')" style="width: 120px; height: 60px; border-radius: 12px; font-size: 14px; font-weight: bold;">
        ‚öôÔ∏è<br>Settings
    </button>
</div>

        <!-- RECENT ACTIVITY -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;" id="recentActivityTitle">üìà Recent Activity</h3>
            <div id="recentActivityList">
                <div style="text-align: center; color: #CCC; padding: 20px;" id="noActivityText">
                    Connect your wallet to see activity
                </div>
            </div>
        </div>
    </div>

    <!-- CONTACTS SECTION -->
    <div id="contacts" class="content-section">
        <div class="section-header">
            <h1 class="section-title" id="contactsTitle">üë• Contact Management</h1>
            <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="exportContacts()">
                üì• <span id="exportBtn">Export All</span>
            </button>
        </div>

        <!-- SEARCH FUNCTIONALITY -->
        <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üîç Search Contacts</h3>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <select id="categoryFilter" style="background: rgba(0, 0, 0, 0.9); border: 1px solid #FFD700; color: #FFD700; min-width: 150px; padding: 8px 12px; border-radius: 8px;">
                    <option value="all">All Categories</option>
                    <option value="telegram">Telegram</option>
                    <option value="whatsapp">WhatsApp</option>
                    <option value="email">Email</option>
                    <option value="instagram">Instagram</option>
                    <option value="viber">Viber</option>
                    <option value="facebook">Facebook</option>
                    <option value="tiktok">TikTok</option>
                    <option value="twitter">Twitter/X</option>
                </select>
                <input type="text" id="searchInput" placeholder="Search by name or contact..." style="background: rgba(255, 255, 255, 0.1); border: 1px solid #FFD700; border-radius: 8px; padding: 8px 12px; color: #FFF; flex: 1; min-width: 200px;">
                <button onclick="searchContacts()" style="background: #FFD700; color: #000; border: none; border-radius: 8px; padding: 8px 16px; cursor: pointer; font-weight: bold;">Search</button>
                <button onclick="clearSearch()" style="background: rgba(255, 68, 68, 0.2); color: #FF4444; border: 1px solid #FF4444; border-radius: 8px; padding: 8px 16px; cursor: pointer;">Clear</button>
            </div>
        </div>

        <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 20px;">
            <div id="contactsTable">
                <div style="text-align: center; color: #CCC; padding: 40px;" id="noContactsText">
                    Connect wallet to manage contacts
                </div>
            </div>
        </div>
    </div>

    <!-- REFERRALS SECTION -->
    <div id="referrals" class="content-section">
        <div class="section-header">
            <h1 class="section-title" id="referralsTitle">üîó Referral Network & Marketing</h1>
            <div style="color: #CCC;" id="networkStatus">Network Status: Disconnected</div>
        </div>

        <!-- MARKETING SYSTEM -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üìä Marketing Dashboard</h3>
            
            <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –£—Ä–æ–≤–Ω–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã -->
            <div class="level-buttons">
                <button class="level-btn active" onclick="showLevel(1)" data-level="1">1</button>
                <button class="level-btn" onclick="showLevel(2)" data-level="2">2</button>
                <button class="level-btn" onclick="showLevel(3)" data-level="3">3</button>
                <button class="level-btn" onclick="showLevel(4)" data-level="4">4</button>
                <button class="level-btn" onclick="showLevel(5)" data-level="5">5</button>
                <button class="level-btn" onclick="showLevel(6)" data-level="6">6</button>
                <button class="level-btn" onclick="showLevel(7)" data-level="7">7</button>
                <button class="level-btn" onclick="showLevel(8)" data-level="8">8</button>
                <button class="level-btn" onclick="showLevel(9)" data-level="9">9</button>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —É—Ä–æ–≤–Ω–µ–π -->
            <div class="level-content active" id="level1Content">
                <div class="level-header">
                    <div class="level-title">Level 1 - Direct Referrals</div>
                    <div class="level-count" id="level1Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level1Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level2Content">
                <div class="level-header">
                    <div class="level-title">Level 2 - Second Generation</div>
                    <div class="level-count" id="level2Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level2Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 2 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level3Content">
                <div class="level-header">
                    <div class="level-title">Level 3 - Third Generation</div>
                    <div class="level-count" id="level3Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level3Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 3 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level4Content">
                <div class="level-header">
                    <div class="level-title">Level 4 - Fourth Generation</div>
                    <div class="level-count" id="level4Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level4Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 4 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level5Content">
                <div class="level-header">
                    <div class="level-title">Level 5 - Fifth Generation</div>
                    <div class="level-count" id="level5Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level5Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 5 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£—Ä–æ–≤–Ω–∏ 6-9 –î–û–°–¢–£–ü–ù–´ –î–õ–Ø –û–°–ù–û–í–ê–¢–ï–õ–ï–ô -->
            <div class="level-content" id="level6Content">
                <div class="level-header">
                    <div class="level-title">Level 6 - Sixth Generation</div>
                    <div class="level-count" id="level6Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level6Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 6 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level7Content">
                <div class="level-header">
                    <div class="level-title">Level 7 - Seventh Generation</div>
                    <div class="level-count" id="level7Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level7Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 7 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level8Content">
                <div class="level-header">
                    <div class="level-title">Level 8 - Eighth Generation</div>
                    <div class="level-count" id="level8Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level8Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 8 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="level-content" id="level9Content">
                <div class="level-header">
                    <div class="level-title">Level 9 - Ninth Generation</div>
                    <div class="level-count" id="level9Count">0 users</div>
                </div>
                <div class="team-table">
                    <table>
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Wallet</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="level9Table">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                    No level 9 referrals yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üîó Your Referral Link</h3>
            <div class="referral-link-container">
                <input type="text" class="referral-link-input" id="referralLink" value="https://cardgift.bnb/registration.html?ref=YOUR_ID" readonly>
                <button class="copy-btn" onclick="copyReferralLink()">üìã Copy</button>
                <button class="share-btn" onclick="shareReferralLink()">üì§ Share</button>
            </div>
            <div class="referral-link-short">
                Display: cardgift.bnb/ref/YOUR_ID
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞ -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üí∞ Earnings Statistics</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üíé</div>
                    <div class="stat-number" id="totalEarningsRef">0.000</div>
                    <div class="stat-label">Total Earnings (BNB)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìà</div>
                    <div class="stat-number" id="monthlyEarnings">0.000</div>
                    <div class="stat-label">This Month</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-number" id="activeReferrals">0</div>
                    <div class="stat-label">Active Referrals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-number" id="conversionRate">0%</div>
                    <div class="stat-label">Conversion Rate</div>
                </div>
            </div>
        </div>
    </div>

    <!-- CRM SECTION -->
    <div id="crm" class="content-section">
        <div class="section-header">
            <h1 class="section-title" id="crmTitle">üí¨ CRM & Internal Chat</h1>
            <button style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="refreshCRMData()">
                üîÑ Refresh Data
            </button>
        </div>

        <!-- CRM Dashboard -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üìä CRM Overview</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-number" id="totalCRMContacts">0</div>
                    <div class="stat-label">Total CRM Contacts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí¨</div>
                    <div class="stat-number" id="unreadMessages">0</div>
                    <div class="stat-label">Unread Messages</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìù</div>
                    <div class="stat-number" id="totalNotes">0</div>
                    <div class="stat-label">Saved Notes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìû</div>
                    <div class="stat-number" id="activeChats">0</div>
                    <div class="stat-label">Active Chats</div>
                </div>
            </div>
        </div>

        <!-- Recent Conversations -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üí¨ Recent Conversations</h3>
            <div id="recentConversations">
                <div style="text-align: center; color: #CCC; padding: 40px;">
                    No recent conversations
                </div>
            </div>
        </div>

        <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï Quick Actions -->
        <div class="referral-section">
            <h3 style="color: #FFD700; margin-bottom: 15px;">‚ö° Quick Actions</h3>
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <button onclick="createNewChat()" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                    üí¨ New Chat
                </button>
                <button onclick="exportCRMData()" style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                    üì• Export Data
                </button>
                <button onclick="sendBroadcast()" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                    üì¢ Broadcast
                </button>
                <button onclick="generateReport()" style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                    üìä Generate Report
                </button>
            </div>
        </div>
    </div>

    <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø CO-AUTHORS SECTION -->
    <div id="coauthors" class="content-section">
        <div class="coauthors-section" id="coauthorsMainContent">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <!-- MAILINGS SECTION -->
    <div id="mailings" class="content-section">
        <div class="development-placeholder">
            <div class="development-icon">üöß</div>
            <div class="development-title" id="mailingsDevTitle">Mass Mailings System</div>
            <div class="development-text" id="mailingsDevText">
                Advanced mailing system is currently in development.<br>
                This section will include:<br><br>
                ‚Ä¢ Multi-platform messaging (Telegram, WhatsApp, Email)<br>
                ‚Ä¢ Template management<br>
                ‚Ä¢ Scheduling and automation<br>
                ‚Ä¢ Delivery analytics<br>
                ‚Ä¢ Anti-spam protection
            </div>
        </div>
    </div>

    <!-- ANALYTICS SECTION -->
    <div id="analytics" class="content-section">
        <div class="development-placeholder">
            <div class="development-icon">üìä</div>
            <div class="development-title" id="analyticsDevTitle">Advanced Analytics</div>
            <div class="development-text" id="analyticsDevText">
                Comprehensive analytics dashboard is in development.<br>
                Features coming soon:<br><br>
                ‚Ä¢ Real-time statistics<br>
                ‚Ä¢ Contact growth charts<br>
                ‚Ä¢ Conversion tracking<br>
                ‚Ä¢ Revenue analytics<br>
                ‚Ä¢ Performance reports
            </div>
        </div>
    </div>

    <!-- WALLET SECTION -->
    <div id="wallet" class="content-section">
        <div class="section-header">
            <h1 class="section-title" id="walletTitle">üíé Web3 Wallet</h1>
            <div style="color: #CCC;" id="walletNetwork">Network: opBNB Mainnet</div>
        </div>

        <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 30px;">
            <h3 style="color: #FFD700; margin-bottom: 15px;" id="walletConnectionTitle">üîó Blockchain Connection</h3>
            
            <button id="connectWalletBtn" style="background: linear-gradient(45deg, #1E88E5, #1565C0); color: white; border: none; border-radius: 12px; padding: 15px 30px; font-weight: bold; cursor: pointer; width: 100%; transition: all 0.3s ease; margin-bottom: 15px;" onclick="connectWallet()">
                <span id="connectWalletText">üîê Connect SafePal Wallet</span>
            </button>
            
            <div id="walletStatus" style="background: rgba(76, 175, 80, 0.1); border: 1px solid #4CAF50; border-radius: 10px; padding: 15px; text-align: center; display: none;">
                <div style="font-weight: bold; margin-bottom: 10px;" id="walletConnectedText">‚úÖ SafePal Connected</div>
                <div id="walletAddress" style="color: #4CAF50; margin-bottom: 5px;"></div>
                <div id="walletBalance" style="color: #CCC; font-size: 14px;"></div>
            </div>

            <!-- SMART CONTRACT INFO -->
            <div style="background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; padding: 20px; margin-top: 20px;">
                <h4 style="color: #FFD700; margin-bottom: 10px;" id="contractInfoTitle">üìÑ Smart Contract Info</h4>
                <div style="color: #CCC; font-size: 14px;">
                    <div><strong id="contractStatusLabel">Status:</strong> <span style="color: #4CAF50;" id="contractStatus">Active</span></div>
                    <div><strong id="contractNetworkLabel">Network:</strong> opBNB Mainnet</div>
                    <div><strong id="contractAddressLabel">Address:</strong> <span style="word-break: break-all;" id="contractAddress">0xBb8A0c28A91f8D6B6c4175c0D497164dFC846618</span></div>
                </div>
            </div>

            <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï ACTIVATION BUTTONS -->
            <div style="margin-top: 30px;">
                <h3 style="color: #FFD700; margin-bottom: 20px;">üöÄ Account Activation</h3>
                <div class="activation-buttons" id="activationButtonsContainer">
                    <button class="activation-btn" onclick="activateUser(1)" id="activateAccountBtn">
                            üîê –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞<br><small>0.0025 opBNB</small>
                        </button>
                        <button class="activation-btn mini-admin" onclick="activateUser(2)" id="miniAdminBtn">
                            ‚ö° Mini Admin<br><small>0.05 opBNB</small>
                        </button>
                        <button class="activation-btn super-admin" onclick="activateUser(3)" id="superAdminBtn">
                            üöÄ Super Admin<br><small>0.25 opBNB</small>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø SETTINGS SECTION -->
    <div id="settings" class="content-section">
        <div class="section-header">
            <h1 class="section-title" id="settingsTitle">‚öôÔ∏è Settings</h1>
        </div>

        <!-- ‚úÖ LANGUAGE SETTINGS -->
        <div class="settings-section">
            <div class="settings-header">
                <div class="settings-icon">üåç</div>
                <div class="settings-title" id="languageSettingsTitle">Language Settings</div>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title">Interface Language</div>
                    </div>
                    <div class="setting-item-description">Choose your preferred language for the dashboard interface</div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="lang-btn active" onclick="switchLanguage('en')" style="padding: 8px 16px; border-radius: 8px;">
                            üá∫üá∏ English
                        </button>
                        <button class="lang-btn" onclick="switchLanguage('ru')" style="padding: 8px 16px; border-radius: 8px;">
                            üá∑üá∫ –†—É—Å—Å–∫–∏–π
                        </button>
                        <button class="lang-btn" onclick="switchLanguage('ua')" style="padding: 8px 16px; border-radius: 8px;">
                            üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚úÖ ADMIN SETTINGS (–¥–ª—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π) -->
        <div class="settings-section" id="adminSettingsSection" style="display: none;">
            <div class="settings-header">
                <div class="settings-icon">üëë</div>
                <div class="settings-title" id="adminSettings">Admin Settings</div>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="automaticBackup">Automatic Backup</div>
                        <div class="setting-item-description" id="automaticBackupDesc">Automatically create backup copies of contact database</div>
                    </div>
                    <div class="setting-item-description">Automatically create backup copies of contact database</div>
                </div>
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="systemNotifications">System Notifications</div>
                        <div class="setting-item-description" id="systemNotificationsDesc">Receive notifications about new registrations and system events</div>
                    </div>
                    <div class="setting-item-description">Receive notifications about new registrations and system events</div>
                </div>
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="interfaceMode">Interface Mode</div>
                        <div class="setting-item-description" id="interfaceModeDesc">Choose between dark and light interface themes</div>
                    </div>
                    <div class="setting-item-description">Choose between dark and light interface themes</div>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button class="setting-button" onclick="setTheme('dark')" id="darkModeBtn">
                            <span id="darkMode">üåô Dark Mode</span>
                        </button>
                        <button class="setting-button" onclick="setTheme('light')" id="lightModeBtn">
                            <span id="lightMode">‚òÄÔ∏è Light Mode</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚úÖ DATA MANAGEMENT -->
        <div class="settings-section">
            <div class="settings-header">
                <div class="settings-icon">üíæ</div>
                <div class="settings-title" id="dataManagement">Data Management</div>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="exportAllData">Export All Data</div>
                        <div class="setting-item-description" id="exportAllDataDesc">Download all your contacts, notes, and CRM data</div>
                    </div>
                    <div class="setting-item-description">Download all your contacts, notes, and CRM data</div>
                    <button class="setting-button" onclick="exportAllData()">
                        üì• Export Data
                    </button>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="importData">Import Data</div>
                        <div class="setting-item-description" id="importDataDesc">Import contacts and data from backup files</div>
                    </div>
                    <div class="setting-item-description">Import contacts and data from backup files</div>
                    <button class="setting-button" onclick="importData()">
                        üì§ Import Data
                    </button>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="clearCache">Clear Cache</div>
                        <div class="setting-item-description" id="clearCacheDesc">Clear temporary data and cached files to free up space</div>
                    </div>
                    <div class="setting-item-description">Clear temporary data and cached files to free up space</div>
                    <button class="setting-button danger" onclick="clearCache()">
                        üßπ Clear Cache
                    </button>
                </div>
            </div>
        </div>

        <!-- ‚úÖ SECURITY SETTINGS -->
        <div class="settings-section">
            <div class="settings-header">
                <div class="settings-icon">üîí</div>
                <div class="settings-title" id="securitySettings">Security Settings</div>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="walletAutoConnect">Wallet Auto-Connect</div>
                        <div class="setting-item-description" id="walletAutoConnectDesc">Automatically connect to your wallet when visiting the dashboard</div>
                    </div>
                    <div class="setting-item-description">Automatically connect to your wallet when visiting the dashboard</div>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="sessionTimeout">Session Timeout</div>
                        <div class="setting-item-description" id="sessionTimeoutDesc">Set automatic logout time for security</div>
                    </div>
                    <div class="setting-item-description">Set automatic logout time for security</div>
                    <select style="background: rgba(255, 255, 255, 0.1); border: 1px solid #FFD700; border-radius: 8px; padding: 8px 12px; color: #FFF; margin-top: 10px;" onchange="setSessionTimeout(this.value)">
                        <option value="30">30 minutes</option>
                        <option value="60" selected>1 hour</option>
                        <option value="120">2 hours</option>
                        <option value="480">8 hours</option>
                        <option value="0">Never</option>
                    </select>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="transactionConfirmation">Transaction Confirmation</div>
                        <div class="setting-item-description" id="transactionConfirmationDesc">Always confirm transactions before sending</div>
                    </div>
                    <div class="setting-item-description">Always confirm transactions before sending</div>
                </div>
            </div>
        </div>

        <!-- ‚úÖ NOTIFICATION SETTINGS -->
        <div class="settings-section">
            <div class="settings-header">
                <div class="settings-icon">üîî</div>
                <div class="settings-title" id="notificationSettings">Notification Settings</div>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="newReferralNotifications">New Referral Notifications</div>
                        <div class="setting-item-description" id="newReferralNotificationsDesc">Get notified when someone joins through your referral link</div>
                    </div>
                    <div class="setting-item-description">Get notified when someone joins through your referral link</div>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="crmMessageNotifications">CRM Message Notifications</div>
                        <div class="setting-item-description" id="crmMessageNotificationsDesc">Receive notifications for new CRM messages</div>
                    </div>
                    <div class="setting-item-description">Receive notifications for new CRM messages</div>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="systemUpdateNotifications">System Update Notifications</div>
                        <div class="setting-item-description" id="systemUpdateNotificationsDesc">Get notified about system updates and new features</div>
                    </div>
                    <div class="setting-item-description">Get notified about system updates and new features</div>
                </div>
            </div>
        </div>

        <!-- ‚úÖ ADVANCED SETTINGS -->
        <div class="settings-section">
            <div class="settings-header">
                <div class="settings-icon">‚öôÔ∏è</div>
                <div class="settings-title" id="advancedSettings">Advanced Settings</div>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="debugMode">Debug Mode</div>
                        <div class="setting-item-description" id="debugModeDesc">Enable debug mode for troubleshooting (developers only)</div>
                    </div>
                    <div class="setting-item-description">Enable debug mode for troubleshooting (developers only)</div>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="performanceMode">Performance Mode</div>
                        <div class="setting-item-description" id="performanceModeDesc">Optimize for better performance on slower devices</div>
                    </div>
                    <div class="setting-item-description">Optimize for better performance on slower devices</div>
                </div>

                <div class="setting-item">
                    <div class="setting-item-header">
                        <div class="setting-item-title" id="resetAllSettings">Reset All Settings</div>
                        <div class="setting-item-description" id="resetAllSettingsDesc">Reset all settings to default values</div>
                    </div>
                    <div class="setting-item-description">Reset all settings to default values</div>
                    <button class="setting-button danger" onclick="resetAllSettings()">
                        <span id="resetSettings">üîÑ Reset Settings</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // ==================== WEB3 CONFIGURATION ====================
    const CONTRACT_CONFIG = {
        address: '0xBb8A0c28A91f8D6B6c4175c0D497164dFC846618',
        network: 'opBNB',
        chainId: 204,
        rpcUrl: 'https://opbnb-mainnet-rpc.bnbchain.org',
        abi: [
            {
                "inputs": [{"name": "userId", "type": "string"}],
                "name": "getUser",
                "outputs": [
                    {"name": "", "type": "string"},
                    {"name": "", "type": "address"},
                    {"name": "", "type": "uint8"},
                    {"name": "", "type": "string"},
                    {"name": "", "type": "uint256"},
                    {"name": "", "type": "bool"},
                    {"name": "", "type": "uint256"},
                    {"name": "", "type": "uint256"}
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [{"name": "userId", "type": "string"}],
                "name": "getUserReferrals",
                "outputs": [{"name": "", "type": "string[]"}],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [{"name": "", "type": "address"}],
                "name": "walletToUserId",
                "outputs": [{"name": "", "type": "string"}],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [{"name": "", "type": "string"}],
                "name": "users",
                "outputs": [
                    {"name": "userId", "type": "string"},
                    {"name": "wallet", "type": "address"},
                    {"name": "level", "type": "uint8"},
                    {"name": "referrerId", "type": "string"},
                    {"name": "registrationTime", "type": "uint256"},
                    {"name": "isActive", "type": "bool"},
                    {"name": "cardCount", "type": "uint256"},
                    {"name": "totalEarned", "type": "uint256"}
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "activateUser",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "activateMiniAdmin",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "activateSuperAdmin",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [{"name": "referrerId", "type": "string"}],
                "name": "registerUser",
                "outputs": [{"name": "", "type": "string"}],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [{"name": "metadataHash", "type": "string"}],
                "name": "createCard",
                "outputs": [{"name": "", "type": "string"}],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "centralFounder",
                "outputs": [{"name": "", "type": "address"}],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [{"name": "", "type": "uint256"}],
                "name": "founders",
                "outputs": [{"name": "", "type": "address"}],
                "stateMutability": "view",
                "type": "function"
            }
        ]
    };

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–º–µ–Ω cardgift.bnb –≤–µ–∑–¥–µ
    const DOMAIN = 'https://cardgift.bnb';

    const SUPPORTED_WALLETS = {
        safepal: {
            name: 'SafePal',
            icon: 'üîê',
            priority: 1,
            detected: () => window.safepal || window.ethereum?.isSafePal
        },
        metamask: {
            name: 'MetaMask', 
            icon: 'ü¶ä',
            priority: 2,
            detected: () => window.ethereum?.isMetaMask
        },
        trustwallet: {
            name: 'Trust Wallet',
            icon: 'üíô', 
            priority: 3,
            detected: () => window.ethereum?.isTrust
        },
        generic: {
            name: 'Web3 Wallet',
            icon: 'üí∞',
            priority: 4,
            detected: () => window.ethereum
        }
    };

    // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
    let currentLanguage = 'en';
    let currentSection = 'dashboard';
    let web3;
    let contract;
    let userWalletAddress = null;
    let isWeb3Connected = false;
    let connectedWallet = null;
    let currentUser = {
        userId: 'NOT_CONNECTED',
        level: 0,
        isActive: false,
        walletAddress: null
    };
    let walletConnected = false;
    let contactsData = {};
    let referralData = {};
    let currentLevel = 1;
    let currentCRMUser = null;
    let notifications = {
        referral: 0,
        crm: 0
    };

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ê–î–†–ï–°–ê –û–°–ù–û–í–ê–¢–ï–õ–ï–ô (checksum format)
    const FOUNDERS_ADDRESSES = [
        '0x0099188030174E381E7A7ee36D2783ECC31B6728', // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π
        '0xAB17aDbe29c4E1d695C239206682B02ebdB3f707',
        '0xB5986B808dad481ad86D63DF152cC0ad7B473e48',
        '0xa3496caCC8523421Dd151f1d92A456c2daFa28c2',
        '0x8af1BC6B4a5aACED37889CC06bed4569A6B64044',
        '0x0AB97e3934b1Afc9F1F6447CCF676E4f1D8B9639',
        '0x03284A899147f5a07F82C622F34DF92198671635',
        '0xb0E256cA055937a8FD9CA1F5e3D8A6bD44146d50'
    ];

    // ==================== WEB3 INTEGRATION ====================
    async function initWeb3() {
        const availableWallets = Object.entries(SUPPORTED_WALLETS)
            .filter(([key, wallet]) => wallet.detected())
            .sort((a, b) => a[1].priority - b[1].priority);
        
        if (availableWallets.length === 0) {
            console.warn('No Web3 wallets detected');
            showInstallWalletPrompt();
            return;
        }
        
        const [walletKey, walletInfo] = availableWallets[0];
        connectedWallet = walletKey;
        
        try {
            let provider = window.safepal?.ethereum || window.ethereum;
            
            web3 = new Web3(provider);
            contract = new web3.eth.Contract(CONTRACT_CONFIG.abi, CONTRACT_CONFIG.address);
            
            const savedAddress = localStorage.getItem('connectedWallet');
            const savedWalletType = localStorage.getItem('connectedWalletType');
            
            if (savedAddress && savedWalletType === walletKey) {
                userWalletAddress = savedAddress;
                isWeb3Connected = true;
                await checkNetwork();
                await checkUserAccess();
            }
            
            console.log(`üîê Using ${walletInfo.name} provider`);
            
        } catch (error) {
            console.error('Web3 initialization failed:', error);
        }
    }

    async function checkNetwork() {
        try {
            const chainId = await web3.eth.getChainId();
            if (Number(chainId) !== CONTRACT_CONFIG.chainId) {
                await switchToCorrectNetwork();
            }
        } catch (error) {
            console.error('Network check failed:', error);
        }
    }

    async function switchToCorrectNetwork() {
        try {
            await window.ethereum.request({
                method: 'wallet_switchEthereumChain',
                params: [{ chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId) }]
            });
        } catch (error) {
            if (error.code === 4902) {
                await addNetwork();
            }
        }
    }

    async function addNetwork() {
        try {
            await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [{
                    chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId),
                    chainName: 'opBNB Mainnet',
                    nativeCurrency: {
                        name: 'BNB',
                        symbol: 'BNB',
                        decimals: 18
                    },
                    rpcUrls: [CONTRACT_CONFIG.rpcUrl],
                    blockExplorerUrls: ['https://opbnbscan.com/']
                }]
            });
            
            showNotification('opBNB network added successfully!', 'success');
        } catch (error) {
            console.error('Failed to add network:', error);
            showNotification('Failed to add opBNB network', 'error');
        }
    }

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
    async function checkUserAccess() {
        if (!userWalletAddress) return;
        
        try {
            console.log('üîç Checking user access for:', userWalletAddress);
            
            // ‚úÖ –ü–†–û–í–ï–†–Ø–ï–ú –û–°–ù–û–í–ê–¢–ï–õ–ï–ô –ü–ï–†–í–´–ú –î–ï–õ–û–ú
            if (FOUNDERS_ADDRESSES.includes(userWalletAddress)) {
                console.log('üî• –û–°–ù–û–í–ê–¢–ï–õ–¨ –û–ë–ù–ê–†–£–ñ–ï–ù - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø!');
                currentUser = {
                    userId: `FOUNDER_${userWalletAddress.substring(2, 8).toUpperCase()}`,
                    level: 4, // SUPER_ADMIN
                    isActive: true,
                    walletAddress: userWalletAddress
                };
                updateUserInterface();
                return;
            }
            
            // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –ø–æ–ª—É—á–∞–µ–º userId –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
            const userId = await contract.methods.walletToUserId(userWalletAddress).call();
            
            if (userId && userId.trim()) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –ø–æ–ª—É—á–∞–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ
                const userData = await contract.methods.users(userId).call();
                
                currentUser = {
                    userId: userData.userId,
                    level: parseInt(userData.level),
                    isActive: userData.isActive,
                    walletAddress: userWalletAddress,
                    cardCount: parseInt(userData.cardCount),
                    totalEarned: userData.totalEarned
                };
            } else {
                // –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –Ω—É–∂–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                currentUser = {
                    userId: `CG${userWalletAddress.substring(2, 8).toUpperCase()}`,
                    level: 0,
                    isActive: false,
                    walletAddress: userWalletAddress
                };
                showActivationOptions();
            }
            
            updateUserInterface();
            
        } catch (error) {
            console.error('Access check failed:', error);
            // Fallback –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            currentUser = {
                userId: `CG${userWalletAddress.substring(2, 8).toUpperCase()}`,
                level: 0,
                isActive: false,
                walletAddress: userWalletAddress
            };
            updateUserInterface();
            showActivationOptions();
        }
    }

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–æ–∫–∞–∑ –æ–ø—Ü–∏–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    function showActivationOptions() {
    const connectionStatus = document.getElementById('connectionStatus');
    if (connectionStatus) {
        connectionStatus.innerHTML = `
            <div style="color: #FFA500; font-size: 18px; margin-bottom: 15px;">‚ö° Choose Your Level</div>
            
            <button onclick="activateUser(1)" style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold; margin-bottom: 15px; width: 100%;">
                üîê –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞<br><small>0.0025 opBNB</small>
            </button>
            
            <div style="color: #CCC; margin-bottom: 15px;">or upgrade to:</div>
            
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button onclick="activateUser(2)" style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                    ‚ö° Mini Admin<br><small>0.05 opBNB</small>
                </button>
                <button onclick="activateUser(3)" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                    üöÄ Super Admin<br><small>0.25 opBNB</small>
                </button>
            </div>
        `;
    }
}

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –∫–Ω–æ–ø–æ–∫
    async function activateUser(level) {
        try {
            showNotification('Preparing activation...', 'info');
            
            if (!contract || !userWalletAddress) {
                throw new Error('Wallet not connected');
            }
            
            let txResult;
            let price;
            
            switch(level) {
                case 1:
                    // –ë–∞–∑–æ–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è (0.0025 BNB)
                    price = '2500000000000000'; // 0.0025 BNB –≤ wei
                    txResult = await contract.methods.activateUser().send({ 
                        from: userWalletAddress,
                        value: price,
                        gas: 200000
                    });
                    break;
                    
                case 2: 
                    // –ú–∏–Ω–∏-–∞–¥–º–∏–Ω (0.05 BNB)
                    price = '50000000000000000'; // 0.05 BNB –≤ wei
                    txResult = await contract.methods.activateMiniAdmin().send({ 
                        from: userWalletAddress,
                        value: price,
                        gas: 250000
                    });
                    break;
                    
                case 3:
                    // –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω (0.25 BNB)
                    price = '250000000000000000'; // 0.25 BNB –≤ wei
                    txResult = await contract.methods.activateSuperAdmin().send({ 
                        from: userWalletAddress,
                        value: price,
                        gas: 300000
                    });
                    break;
                    
                default:
                    throw new Error('Unknown activation level');
            }
            
            showNotification(`Level ${level} activation successful!`, 'success');
            await checkUserAccess();
            updateActivationButtons();
            
        } catch (error) {
            console.error('Activation failed:', error);
            showNotification(`Activation error: ${error.message}`, 'error');
        }
    }

    // ‚úÖ –ù–û–í–ê–Ø: –§—É–Ω–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–Ω–æ–ø–æ–∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    function updateActivationButtons() {
        const activateBtn = document.getElementById('activateAccountBtn');
        const miniBtn = document.getElementById('miniAdminBtn');
        const superBtn = document.getElementById('superAdminBtn');
        
        if (currentUser.level >= 1 && activateBtn) {
            activateBtn.disabled = true;
            activateBtn.innerHTML = '‚úÖ Account Activated<br><small>Complete</small>';
        }
        if (currentUser.level >= 2 && miniBtn) {
            miniBtn.disabled = true;
            miniBtn.innerHTML = '‚úÖ Mini Admin<br><small>Activated</small>';
        }
        if (currentUser.level >= 3 && superBtn) {
            superBtn.disabled = true;
            superBtn.innerHTML = '‚úÖ Super Admin<br><small>Activated</small>';
        }
        
        // –î–ª—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π - –±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏
        if (currentUser.level >= 4) {
            if (activateBtn) {
                activateBtn.disabled = true;
                activateBtn.innerHTML = 'üëë Founder Level<br><small>Full Access</small>';
            }
            if (miniBtn) {
                miniBtn.disabled = true;
                miniBtn.innerHTML = 'üëë Founder Level<br><small>Full Access</small>';
            }
            if (superBtn) {
                superBtn.disabled = true;
                superBtn.innerHTML = 'üëë Founder Level<br><small>Full Access</small>';
            }
        }
    }

    // ‚úÖ –ù–û–í–ê–Ø: –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    async function registerNewUser(referrerId = '') {
        try {
            showNotification('Registering user...', 'info');
            
            if (!contract || !userWalletAddress) {
                throw new Error('Connect wallet to register');
            }
            
            const result = await contract.methods.registerUser(referrerId).send({ 
                from: userWalletAddress,
                gas: 300000
            });
            
            showNotification('Registration successful! You can now activate.', 'success');
            await checkUserAccess();
            
        } catch (error) {
            console.error('Registration failed:', error);
            showNotification(`Registration error: ${error.message}`, 'error');
        }
    }

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ registration.html
    function processRegistrationData(userData) {
        try {
            const newUserId = generateUserId();
            
            const userObject = {
                userId: newUserId,
                name: userData.name,
                messenger: userData.messenger,
                contact: userData.contact,
                referralId: userData.referralId || '',
                walletAddress: userData.walletAddress || '',
                registrationDate: new Date().toISOString(),
                level: 0,
                isActive: false,
                status: 'registered'
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–æ—Ü—Å–µ—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            if (!contactsData[userData.messenger]) {
                contactsData[userData.messenger] = [];
            }
            contactsData[userData.messenger].push(userObject);
            localStorage.setItem('allContacts', JSON.stringify(contactsData));
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø–∞—Ä—Ç–Ω–µ—Ä–∫—É
            if (userData.referralId) {
                if (!referralData.levels) referralData.levels = { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] };
                if (!referralData.levels[1]) referralData.levels[1] = [];
                referralData.levels[1].push(userObject);
                if (!referralData.users) referralData.users = {};
                referralData.users[newUserId] = userObject;
                localStorage.setItem('referralDatabase', JSON.stringify(referralData));
            }
            
            console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—ã:', newUserId);
            updateDashboardStats();
            
            return newUserId;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
            return null;
        }
    }

    // ‚úÖ –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø REGISTRATION.HTML
    window.addUserToDatabase = processRegistrationData;

    function updateUserInterface() {
        const levelNames = {
            0: 'NOT REGISTERED',
            1: 'BASIC USER', 
            2: 'MINI ADMIN',
            3: 'SUPER ADMIN',
            4: 'FOUNDER'
        };
        
        document.getElementById('userLevel').textContent = levelNames[currentUser.level] || 'UNKNOWN';
        document.getElementById('currentUserId').textContent = currentUser.userId || 'Not Connected';
        
        if (userWalletAddress) {
            const shortAddress = `${userWalletAddress.substring(0, 6)}...${userWalletAddress.substring(userWalletAddress.length - 4)}`;
            document.getElementById('currentUserId').textContent = `${currentUser.userId} (${shortAddress})`;
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            const connectionStatus = document.getElementById('connectionStatus');
            if (connectionStatus && currentUser.level > 0) {
                connectionStatus.style.display = 'none';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ç–∏
            document.getElementById('networkStatus').textContent = 'Network Status: Connected';
            
            // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É —Å –¥–æ–º–µ–Ω–æ–º
            if (userWalletAddress && currentUser.userId !== 'NOT_CONNECTED') {
                const referralLinkInput = document.getElementById('referralLink');
                if (referralLinkInput) {
                    referralLinkInput.value = `${DOMAIN}/registration.html?ref=${currentUser.userId}`;
                }
            }
        }
        
        updateMenuAccess();
        updateActivationButtons();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
        if (currentUser.level >= 4) {
            const adminSettings = document.getElementById('adminSettingsSection');
            if (adminSettings) {
                adminSettings.style.display = 'block';
            }
        }
    }

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ–Ω—é
    function updateMenuAccess() {
    const menuItems = document.querySelectorAll('.menu-item');
    
    menuItems.forEach(item => {
        const section = item.getAttribute('data-section');
        
        if (currentUser.level === 0) {
            if (section !== 'wallet' && section !== 'dashboard') {
                item.classList.add('locked');
            }
        } else if (currentUser.level >= 1) {
            if (['dashboard', 'contacts', 'wallet', 'settings'].includes(section)) {
                item.classList.remove('locked');
            }
        }
        
        if (currentUser.level >= 2) {
            if (['referrals', 'crm'].includes(section)) {
                item.classList.remove('locked');
            }
        }
        
        if (currentUser.level >= 3) {
            if (['mailings', 'analytics'].includes(section)) {
                item.classList.remove('locked');
            }
        }
        
        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏–∫–∞ –¥–ª—è —Å–æ–∞–≤—Ç–æ—Ä–æ–≤
        if (section === 'coauthors') {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–º
            const isFounder = FOUNDERS_ADDRESSES.includes(userWalletAddress);
            const isCentralFounder = userWalletAddress && userWalletAddress.toLowerCase() === '0x0099188030174e381e7a7ee36d2783ecc31b6728';
            
            if (isCentralFounder) {
                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
                item.classList.remove('locked');
                item.querySelector('#menuCoauthors').textContent = 'Co-Authors';
            } else if (isFounder) {
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–∏ - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏  
                item.classList.remove('locked');
                item.querySelector('#menuCoauthors').textContent = 'Team Management';
            } else {
                // –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
                item.classList.add('locked');
            }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –¥–ª—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
        if (currentUser.level >= 4) {
            if (section !== 'coauthors') {
                item.classList.remove('locked');
            }
        }
    });
}

    function showInstallWalletPrompt() {
        const connectBtn = document.getElementById('connectWalletBtn');
        if (connectBtn) {
            connectBtn.innerHTML = 'üì± Install SafePal or Compatible Wallet';
            connectBtn.onclick = () => {
                if (confirm('Install SafePal for best opBNB experience?\n\nClick OK for SafePal or Cancel for other wallets.')) {
                    window.open('https://safepal.io/download', '_blank');
                } else {
                    window.open('https://metamask.io/download/', '_blank');
                }
            };
        }
    }

    async function connectWallet() {
    if (!web3) {
        await initWeb3();
    }
    
    try {
        const connectBtn = document.getElementById('connectWalletBtn');
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        connectBtn.textContent = 'üîÑ Connecting to SafePal...';
        connectBtn.disabled = true;
        
        // ‚úÖ –ü–†–ò–û–†–ò–¢–ï–¢ #1: SafePal (–º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
        if (isMobile && window.safepal && window.safepal.ethereum) {
            console.log('üî• SafePal Mobile App detected - PRIORITY CONNECTION');
            try {
                const accounts = await window.safepal.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                handleWalletConnection(accounts[0], 'SafePal App');
                return;
            } catch (error) {
                console.log('SafePal App connection failed, trying alternatives...');
            }
        }
        
        // ‚úÖ –ü–†–ò–û–†–ò–¢–ï–¢ #2: SafePal (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞)
        if (!isMobile && window.safepalProvider) {
            console.log('üî• SafePal Extension detected - PRIORITY CONNECTION');
            try {
                const accounts = await window.safepalProvider.request({
                    method: 'eth_requestAccounts'
                });
                handleWalletConnection(accounts[0], 'SafePal Extension');
                return;
            } catch (error) {
                console.log('SafePal Extension connection failed, trying alternatives...');
            }
        }
        
        // ‚úÖ –ü–†–ò–û–†–ò–¢–ï–¢ #3: –û–±—ã—á–Ω—ã–π Web3 (–º–æ–∂–µ—Ç –±—ã—Ç—å SafePal —á–µ—Ä–µ–∑ window.ethereum)
        if (window.ethereum) {
            try {
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                
                const walletName = window.ethereum.isSafePal ? 'SafePal Wallet' : 
                                   window.ethereum.isMetaMask ? 'MetaMask' :
                                   window.ethereum.isTrust ? 'Trust Wallet' : 'Web3 Wallet';
                
                console.log(`üîó Connected via: ${walletName}`);
                handleWalletConnection(accounts[0], walletName);
                return;
            } catch (error) {
                console.log('Web3 connection failed:', error);
            }
        }
        
        // ‚úÖ FALLBACK: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–º–æ—â—å
        showSafePalHelp(isMobile);
        
    } catch (error) {
        console.error('Connection process failed:', error);
        showSafePalHelp(isMobile);
    }
}

function showSafePalHelp(isMobile) {
    const connectBtn = document.getElementById('connectWalletBtn');
    
    if (isMobile) {
        connectBtn.innerHTML = `
            <div style="text-align: center;">
                <div style="color: #FFD700; font-weight: bold; margin-bottom: 15px;">üî• Recommended: SafePal Wallet</div>
                <button onclick="openInSafePalApp()" style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 15px 25px; cursor: pointer; font-weight: bold; margin-bottom: 10px; width: 100%;">üì± Open in SafePal App Browser</button>
                <button onclick="downloadSafePal()" style="background: linear-gradient(45deg, #1E88E5, #1976D2); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; margin: 5px;">üì• Download SafePal</button>
            </div>
        `;
    } else {
        connectBtn.innerHTML = `
            <div style="text-align: center;">
                <div style="color: #FFD700; font-weight: bold; margin-bottom: 15px;">üî• Recommended: SafePal Extension</div>
                <button onclick="installSafePalExtension()" style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 15px 25px; cursor: pointer; font-weight: bold; margin-bottom: 10px; width: 100%;">üîó Install SafePal Extension</button>
                <button onclick="retryConnection()" style="background: linear-gradient(45deg, #1E88E5, #1976D2); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; margin: 5px;">üîÑ Retry Connection</button>
            </div>
        `;
    }
}

function openInSafePalApp() {
    const currentUrl = window.location.href;
    window.location.href = `safepal://dapp?url=${encodeURIComponent(currentUrl)}`;
    setTimeout(() => showNotification('Open SafePal App ‚Üí Browser ‚Üí Enter: cardgift.bnb/dashboard.html', 'info', 8000), 1000);
}

function downloadSafePal() {
    window.open('https://safepal.com/download', '_blank');
}

function installSafePalExtension() {
    window.open('https://chrome.google.com/webstore/detail/safepal-extension-wallet/lgmpcpglpngdoalbgeoldeajfclnhafa', '_blank');
}

function retryConnection() {
    window.location.reload();
}

// ‚úÖ –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –§–£–ù–ö–¶–ò–Æ –°–Æ–î–ê:
function handleWalletConnection(address, walletType) {
    userWalletAddress = address.toLowerCase();
    localStorage.setItem('connectedWallet', userWalletAddress);
    localStorage.setItem('connectedWalletType', walletType);
    isWeb3Connected = true;
    
    const isSafePal = walletType.includes('SafePal');
    const message = isSafePal ? 
        `üî• ${walletType} connected! Perfect choice for opBNB!` : 
        `‚úÖ ${walletType} connected successfully!`;
    
    checkNetwork().then(() => {
        checkUserAccess().then(() => {
            showWalletConnected(userWalletAddress, walletType);
            showNotification(message, 'success');
        });
    });
}

    function showWalletConnected(address, walletType) {
        const connectBtn = document.getElementById('connectWalletBtn');
        const walletStatus = document.getElementById('walletStatus');
        const walletInfo = SUPPORTED_WALLETS[connectedWallet];
        
        if (connectBtn) connectBtn.style.display = 'none';
        if (walletStatus) walletStatus.style.display = 'block';
        
        document.getElementById('walletAddress').textContent = 
            `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
        
        const walletConnectedText = document.getElementById('walletConnectedText');
        if (walletConnectedText) {
            const isSafePal = walletType && walletType.includes('SafePal');
walletConnectedText.innerHTML = isSafePal ? 
    `üî• ${walletType} Connected` : 
    `‚úÖ ${walletType || 'Wallet'} Connected`;;
        }
        
        walletConnected = true;
        updateWalletBalance();
    }

    // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    window.onload = async function() {
        console.log('üöÄ CardGift Web3 Dashboard initializing...');
        
        await initWeb3();
        loadSavedLanguage();
        
        if (!referralData || !referralData.levels) {
            referralData = {
                levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] },
                users: {}
            };
        }
        
        if (isWeb3Connected && userWalletAddress) {
            await checkUserAccess();
        } else {
            currentUser = {
                userId: 'NOT_CONNECTED',
                level: 0,
                isActive: false,
                walletAddress: null
            };
        }

        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        updateUserInterface();
        loadDashboardData();
        updateTime();
        
        console.log('‚úÖ Web3 Dashboard initialized');
    };

    // ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====================
    function showSection(sectionId) {
        document.querySelectorAll('.content-section').forEach(section => {
            section.classList.remove('active');
        });
        
        document.getElementById(sectionId).classList.add('active');
        
        document.querySelectorAll('.menu-item').forEach(item => {
            item.classList.remove('active');
        });
        
        document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
        
        currentSection = sectionId;
        
        if (sectionId === 'coauthors') {
            loadCoauthorsInterface();
        }
        
        if (window.innerWidth <= 768) {
            toggleSidebar();
        }
    }

    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        
        sidebar.classList.toggle('mobile-visible');
        sidebar.classList.toggle('mobile-hidden');
        
        if (sidebar.classList.contains('mobile-visible')) {
            mainContent.classList.add('full-width');
        } else {
            mainContent.classList.remove('full-width');
        }
    }

    // ==================== –ú–ê–†–ö–ï–¢–ò–ù–ì–û–í–´–ï –§–£–ù–ö–¶–ò–ò ====================
    function showLevel(level) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —É—Ä–æ–≤–Ω–∏
        document.querySelectorAll('.level-content').forEach(content => {
            content.classList.remove('active');
        });
        
        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.level-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
        const levelContent = document.getElementById(`level${level}Content`);
        if (levelContent) {
            levelContent.classList.add('active');
        }
        
        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
        const levelBtn = document.querySelector(`[data-level="${level}"]`);
        if (levelBtn) {
            levelBtn.classList.add('active');
        }
        
        currentLevel = level;
        
        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω—è –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–ª—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
        loadLevelData(level);
    }

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω—è —Å –¥–æ—Å—Ç—É–ø–æ–º –¥–ª—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
    function loadLevelData(level) {
        // ‚úÖ –£–ë–†–ê–ù–û –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ï: –û—Å–Ω–æ–≤–∞—Ç–µ–ª–∏ (level 4) –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —É—Ä–æ–≤–Ω—è–º
        if (currentUser.level >= 4) {
            // –û—Å–Ω–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –≤—Å–µ —É—Ä–æ–≤–Ω–∏
            console.log(`üî• –û—Å–Ω–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å ${level}`);
        } else {
            // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
            if (level > 5 && currentUser.level < 3) {
                // –£—Ä–æ–≤–Ω–∏ 6-9 —Ç–æ–ª—å–∫–æ –¥–ª—è Super Admin
                return;
            }
            
            if (level > 2 && currentUser.level < 2) {
                // –£—Ä–æ–≤–Ω–∏ 3-5 —Ç–æ–ª—å–∫–æ –¥–ª—è Mini Admin
                return;
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –¥–ª—è —É—Ä–æ–≤–Ω—è
        const levelData = referralData.levels[level] || [];
        updateLevelTable(level, levelData);
    }

    function updateLevelTable(level, data) {
        const tableBody = document.getElementById(`level${level}Table`);
        const countElement = document.getElementById(`level${level}Count`);
        
        if (!tableBody || !countElement) return;
        
        countElement.textContent = `${data.length} users`;
        
        if (data.length === 0) {
            tableBody.innerHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                        No level ${level} referrals yet
                    </td>
                </tr>
            `;
            return;
        }
        
        let tableHTML = '';
        data.forEach(user => {
            tableHTML += `
                <tr>
                    <td class="user-id-cell" onclick="openCRMModal('${user.userId}')">${user.userId}</td>
                    <td>${user.name || 'Unknown'}</td>
                    <td>${user.platform || 'Unknown'}</td>
                    <td><span class="status-badge status-${user.status || 'basic'}">${user.status || 'Basic'}</span></td>
                    <td><span class="wallet-status wallet-${user.walletConnected ? 'active' : 'inactive'}">${user.walletConnected ? 'Connected' : 'Not Connected'}</span></td>
                    <td>${user.joinDate || 'Unknown'}</td>
                    <td>
                        <button class="action-btn" onclick="viewUserDetails('${user.userId}')">View</button>
                        <button class="action-btn" onclick="openCRMModal('${user.userId}')">CRM</button>
                    </td>
                </tr>
            `;
        });
        
        tableBody.innerHTML = tableHTML;
    }

    // ==================== –ö–û–ù–¢–ê–ö–¢–´ –§–£–ù–ö–¶–ò–ò ====================
    function filterContacts(category) {
        showSection('contacts');
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä
        const categoryFilter = document.getElementById('categoryFilter');
        if (categoryFilter) {
            categoryFilter.value = category;
        }
        
        searchContacts();
    }

    function searchContacts() {
        const category = document.getElementById('categoryFilter').value;
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        
        let filteredContacts = [];
        
        if (category === 'all') {
            // –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            Object.keys(contactsData).forEach(cat => {
                const contacts = contactsData[cat] || [];
                filteredContacts = filteredContacts.concat(
                    contacts.filter(contact => 
                        contact.name.toLowerCase().includes(searchTerm) ||
                        contact.contact.toLowerCase().includes(searchTerm)
                    )
                );
            });
        } else {
            // –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const contacts = contactsData[category] || [];
            filteredContacts = contacts.filter(contact => 
                contact.name.toLowerCase().includes(searchTerm) ||
                contact.contact.toLowerCase().includes(searchTerm)
            );
        }
        
        displayContactsTable(filteredContacts);
    }

    function clearSearch() {
        document.getElementById('categoryFilter').value = 'all';
        document.getElementById('searchInput').value = '';
        searchContacts();
    }

    function displayContactsTable(contacts) {
        const contactsTable = document.getElementById('contactsTable');
        
        if (contacts.length === 0) {
            contactsTable.innerHTML = `
                <div style="text-align: center; color: #CCC; padding: 40px;">
                    No contacts found
                </div>
            `;
            return;
        }
        
        let tableHTML = `
            <div class="team-table">
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Platform</th>
                            <th>Contact</th>
                            <th>Registration Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
        `;
        
        contacts.forEach(contact => {
            tableHTML += `
                <tr>
                    <td>${contact.name}</td>
                    <td>${contact.platform}</td>
                    <td>${contact.contact}</td>
                    <td>${contact.registrationDate || 'Unknown'}</td>
                    <td><span class="status-badge status-${contact.status || 'basic'}">${contact.status || 'Basic'}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewContactDetails('${contact.userId}')">View</button>
                        <button class="action-btn" onclick="openCRMModal('${contact.userId}')">CRM</button>
                        <button class="action-btn danger" onclick="deleteContact('${contact.userId}')">Delete</button>
                    </td>
                </tr>
            `;
        });
        
        tableHTML += `
                    </tbody>
                </table>
            </div>
        `;
        
        contactsTable.innerHTML = tableHTML;
    }

    function viewContactDetails(userId) {
        showNotification(`Viewing details for ${userId}`, 'info');
    }

    function deleteContact(userId) {
        if (confirm('Are you sure you want to delete this contact?')) {
            // –£–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–∞–∫—Ç –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            Object.keys(contactsData).forEach(category => {
                contactsData[category] = contactsData[category].filter(contact => contact.userId !== userId);
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            localStorage.setItem('allContacts', JSON.stringify(contactsData));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            searchContacts();
            updateDashboardStats();
            
            showNotification('Contact deleted successfully', 'success');
        }
    }

    // ==================== CRM –§–£–ù–ö–¶–ò–ò ====================
    function openCRMModal(userId) {
        if (currentUser.level < 2) {
            showNotification('CRM access requires Mini Admin level or higher', 'error');
            return;
        }
        
        currentCRMUser = userId;
        document.getElementById('crmModal').classList.add('show');
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        loadCRMUserData(userId);
    }

    function loadCRMUserData(userId) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        document.getElementById('crmModalTitle').textContent = `CRM - ${userId}`;
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–º–µ—Ç–∫–∏
        const savedNotes = localStorage.getItem(`crm_notes_${userId}`) || '';
        document.getElementById('userNotes').value = savedNotes;
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        loadUserSocialInfo(userId);
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —á–∞—Ç
        loadUserChat(userId);
    }

    function loadUserSocialInfo(userId) {
        // –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç–∞–∫—Ç–∞—Ö
        let userInfo = null;
        
        Object.keys(contactsData).forEach(category => {
            const found = contactsData[category].find(contact => contact.userId === userId);
            if (found) {
                userInfo = found;
            }
        });
        
        if (userInfo) {
            document.getElementById('userPlatform').textContent = userInfo.platform || 'Unknown';
            document.getElementById('userContact').textContent = userInfo.contact || 'Unknown';
            document.getElementById('userRegDate').textContent = userInfo.registrationDate || 'Unknown';
        } else {
            document.getElementById('userPlatform').textContent = 'Unknown';
            document.getElementById('userContact').textContent = 'Unknown';
            document.getElementById('userRegDate').textContent = 'Unknown';
        }
    }

    function loadUserChat(userId) {
        const chatMessages = document.getElementById('chatMessages');
        const savedMessages = localStorage.getItem(`crm_chat_${userId}`);
        
        if (savedMessages) {
            const messages = JSON.parse(savedMessages);
            let chatHTML = '';
            
            messages.forEach(message => {
                chatHTML += `
                    <div class="chat-message">
                        <div class="chat-message-time">${message.timestamp}</div>
                        <div class="chat-message-text">${message.text}</div>
                    </div>
                `;
            });
            
            chatMessages.innerHTML = chatHTML;
            chatMessages.scrollTop = chatMessages.scrollHeight;
        } else {
            chatMessages.innerHTML = `
                <div style="text-align: center; color: #CCC; padding: 20px;">
                    No messages yet. Start a conversation!
                </div>
            `;
        }
    }

    function closeCRMModal() {
        document.getElementById('crmModal').classList.remove('show');
        currentCRMUser = null;
    }

    function switchCRMTab(tabName) {
        document.querySelectorAll('.crm-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        document.getElementById(`${tabName}Tab`).classList.add('active');
        
        document.querySelectorAll('.crm-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(`${tabName}Content`).classList.add('active');
    }

    function saveUserNotes() {
        if (!currentCRMUser) return;
        
        const notes = document.getElementById('userNotes').value;
        localStorage.setItem(`crm_notes_${currentCRMUser}`, notes);
        
        showNotification('Notes saved successfully!', 'success');
    }

    function sendMessage() {
        if (!currentCRMUser) return;
        
        const chatInput = document.getElementById('chatInput');
        const messageText = chatInput.value.trim();
        
        if (!messageText) return;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        const savedMessages = localStorage.getItem(`crm_chat_${currentCRMUser}`) || '[]';
        const messages = JSON.parse(savedMessages);
        
        messages.push({
            text: messageText,
            timestamp: new Date().toLocaleString(),
            sender: 'admin'
        });
        
        localStorage.setItem(`crm_chat_${currentCRMUser}`, JSON.stringify(messages));
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        chatInput.value = '';
        
        // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —á–∞—Ç
        loadUserChat(currentCRMUser);
        
        showNotification('Message sent!', 'success');
    }

    function openSocialContact() {
        if (!currentCRMUser) return;
        
        const platform = document.getElementById('userPlatform').textContent;
        const contact = document.getElementById('userContact').textContent;
        
        if (platform === 'Unknown' || contact === 'Unknown') {
            showNotification('No contact information available', 'error');
            return;
        }
        
        let url = '';
        
        switch(platform.toLowerCase()) {
            case 'telegram':
                url = `https://t.me/${contact.replace('@', '')}`;
                break;
            case 'whatsapp':
                url = `https://wa.me/${contact.replace('+', '')}`;
                break;
            case 'instagram':
                url = `https://instagram.com/${contact.replace('@', '')}`;
                break;
            case 'facebook':
                url = `https://facebook.com/${contact}`;
                break;
            case 'twitter':
                url = `https://twitter.com/${contact.replace('@', '')}`;
                break;
            case 'tiktok':
                url = `https://tiktok.com/@${contact.replace('@', '')}`;
                break;
            case 'email':
                url = `mailto:${contact}`;
                break;
            default:
                showNotification('Platform not supported for direct contact', 'error');
                return;
        }
        
        window.open(url, '_blank');
    }

    // ==================== CRM –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
    function refreshCRMData() {
        if (currentUser.level < 2) {
            showNotification('CRM access requires Mini Admin level or higher', 'error');
            return;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É CRM
        updateCRMStats();
        loadRecentConversations();
        
        showNotification('CRM data refreshed!', 'success');
    }

    function updateCRMStats() {
        // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
        let totalContacts = 0;
        Object.keys(contactsData).forEach(category => {
            totalContacts += contactsData[category].length;
        });
        
        document.getElementById('totalCRMContacts').textContent = totalContacts;
        
        // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        let unreadMessages = 0;
        document.getElementById('unreadMessages').textContent = unreadMessages;
        
        // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
        let totalNotes = 0;
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('crm_notes_')) {
                totalNotes++;
            }
        }
        document.getElementById('totalNotes').textContent = totalNotes;
        
        // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã
        let activeChats = 0;
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('crm_chat_')) {
                activeChats++;
            }
        }
        document.getElementById('activeChats').textContent = activeChats;
    }

    function loadRecentConversations() {
        const conversationsContainer = document.getElementById('recentConversations');
        let conversationsHTML = '';
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã
        const conversations = [];
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('crm_chat_')) {
                const userId = key.replace('crm_chat_', '');
                const messages = JSON.parse(localStorage.getItem(key) || '[]');
                
                if (messages.length > 0) {
                    const lastMessage = messages[messages.length - 1];
                    conversations.push({
                        userId: userId,
                        lastMessage: lastMessage.text,
                        timestamp: lastMessage.timestamp
                    });
                }
            }
        }
        
        if (conversations.length === 0) {
            conversationsHTML = `
                <div style="text-align: center; color: #CCC; padding: 40px;">
                    No recent conversations
                </div>
            `;
        } else {
            conversations.forEach(conv => {
                conversationsHTML += `
                    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 15px; margin-bottom: 10px; cursor: pointer;" onclick="openCRMModal('${conv.userId}')">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #FFD700;">${conv.userId}</strong>
                            <span style="color: #CCC; font-size: 12px;">${conv.timestamp}</span>
                        </div>
                        <div style="color: #FFF; font-size: 14px;">${conv.lastMessage.substring(0, 100)}${conv.lastMessage.length > 100 ? '...' : ''}</div>
                    </div>
                `;
            });
        }
        
        conversationsContainer.innerHTML = conversationsHTML;
    }

    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞ —Å –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º
    function createNewChat() {
        const dialog = document.getElementById('newChatDialog');
        dialog.classList.add('show');
        document.getElementById('newChatUserId').focus();
    }

    function confirmNewChat() {
        const userId = document.getElementById('newChatUserId').value.trim();
        if (userId) {
            cancelNewChat();
            openCRMModal(userId);
        } else {
            showNotification('Please enter a valid User ID', 'error');
        }
    }

    function cancelNewChat() {
        const dialog = document.getElementById('newChatDialog');
        dialog.classList.remove('show');
        document.getElementById('newChatUserId').value = '';
    }

    function exportCRMData() {
        if (currentUser.level < 2) {
            showNotification('CRM access requires Mini Admin level or higher', 'error');
            return;
        }
        
        const crmData = {
            contacts: contactsData,
            notes: {},
            chats: {}
        };
        
        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('crm_notes_')) {
                const userId = key.replace('crm_notes_', '');
                crmData.notes[userId] = localStorage.getItem(key);
            }
        }
        
        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —á–∞—Ç—ã
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('crm_chat_')) {
                const userId = key.replace('crm_chat_', '');
                crmData.chats[userId] = JSON.parse(localStorage.getItem(key) || '[]');
            }
        }
        
        const dataStr = JSON.stringify(crmData, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `cardgift-crm-data-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification('CRM data exported successfully!', 'success');
    }

    function sendBroadcast() {
        showNotification('Broadcast feature will be available soon!', 'info');
    }

    function generateReport() {
        showNotification('Report generation feature will be available soon!', 'info');
    }

    // ==================== –†–ï–§–ï–†–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏ —Å –¥–æ–º–µ–Ω–æ–º
    function copyReferralLink() {
        const referralLink = document.getElementById('referralLink');
        
        if (currentUser.userId !== 'NOT_CONNECTED') {
            // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–æ–º–µ–Ω cardgift.bnb
            referralLink.value = `${DOMAIN}/registration.html?ref=${currentUser.userId}`;
        }
            
        navigator.clipboard.writeText(referralLink.value).then(() => {
            showNotification('Referral link copied to clipboard!', 'success');
        }).catch(() => {
            showNotification('Failed to copy referral link', 'error');
        });
    }

    function shareReferralLink() {
        const referralLink = document.getElementById('referralLink').value;
        
        if (navigator.share) {
            navigator.share({
                title: 'Join CardGift!',
                text: 'Create amazing greeting cards with CardGift Web3 platform!',
                url: referralLink
            });
        } else {
            // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ Web Share API
            copyReferralLink();
            showNotification('Link copied! Share it manually.', 'info');
        }
    }

    // ==================== CO-AUTHORS –§–£–ù–ö–¶–ò–ò ====================
    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π –≤–º–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–∞–≤—Ç–æ—Ä–æ–≤
    function loadCoauthorsInterface() {
    const coauthorsContent = document.getElementById('coauthorsMainContent');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const isCentralFounder = userWalletAddress && userWalletAddress.toLowerCase() === '0x0099188030174e381e7a7ee36d2783ecc31b6728';
    const isFounder = FOUNDERS_ADDRESSES.includes(userWalletAddress);
    
    if (isCentralFounder) {
        // ‚úÖ –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –û–°–ù–û–í–ê–¢–ï–õ–¨ - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∞–≤—Ç–æ—Ä–∞–º–∏
        coauthorsContent.innerHTML = `
            <h3 style="color: #D2691E; margin-bottom: 15px;">üëë Co-Authors Management (Central Founder)</h3>
            <button class="team-management-btn" onclick="showCoauthorsManagement()">
                üë• Manage Co-Authors
            </button>
            
            <div id="coauthorsManagementArea" style="margin-top: 20px;">
                <div style="text-align: center; color: #CCC; padding: 40px;">
                    Click "Manage Co-Authors" to add/remove co-authors
                </div>
            </div>
        `;
    } else if (isFounder) {
        // ‚úÖ –û–°–¢–ê–õ–¨–ù–´–ï –û–°–ù–û–í–ê–¢–ï–õ–ò - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π/–ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏
        coauthorsContent.innerHTML = `
            <h3 style="color: #D2691E; margin-bottom: 15px;">üë• Team Management (Co-Author)</h3>
            <button class="team-management-btn" onclick="showPartnerManagement()">
                üë• Partner Management
            </button>
            
            <div id="partnerManagementArea" style="margin-top: 20px;">
                <div class="development-placeholder">
                    <div class="development-icon">üë•</div>
                    <div class="development-title">Partner Management System</div>
                    <div class="development-text" style="color: #CCC; line-height: 1.6;">
                        Advanced partner management system is in development.<br><br>
                        <strong style="color: #FFD700;">Available Soon:</strong><br>
                        ‚Ä¢ Manage your team referrals<br>
                        ‚Ä¢ Partner performance analytics<br>
                        ‚Ä¢ Team communication tools<br>
                        ‚Ä¢ Revenue sharing management<br>
                        ‚Ä¢ Partner training resources
                    </div>
                </div>
            </div>
        `;
    } else {
        // ‚úÖ –û–ë–´–ß–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò - –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞
        coauthorsContent.innerHTML = `
            <div style="text-align: center; color: #CCC; padding: 40px;">
                <div style="font-size: 64px; margin-bottom: 20px;">üîí</div>
                <h3 style="color: #FFD700;">Access Restricted</h3>
                <p>This section is available only for founders and co-authors.</p>
            </div>
        `;
    }
}

// ‚úÖ –ù–û–í–ê–Ø: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∞–≤—Ç–æ—Ä–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—è)
function showCoauthorsManagement() {
    const managementArea = document.getElementById('coauthorsManagementArea');
    if (managementArea) {
        managementArea.innerHTML = `
            <div style="background: rgba(139, 69, 19, 0.1); border: 1px solid #D2691E; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                <h4 style="color: #D2691E; margin-bottom: 15px;">Add New Co-Author</h4>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <input type="text" id="newCoauthorAddress" placeholder="Enter wallet address..." style="flex: 1; background: rgba(255,255,255,0.1); border: 1px solid #D2691E; border-radius: 8px; padding: 10px; color: #FFF;">
                    <button onclick="addCoauthor()" style="background: #D2691E; color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-weight: bold;">Add Co-Author</button>
                </div>
                <div style="color: #CCC; font-size: 12px;">Only wallet addresses from the founders list can be added as co-authors.</div>
            </div>
            
            <div id="coauthorsList">
                <div style="text-align: center; color: #CCC; padding: 20px;">Loading co-authors list...</div>
            </div>
        `;
        loadCoauthorsList();
    }
}

// ‚úÖ –ù–û–í–ê–Ø: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ (–¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π)
function showPartnerManagement() {
    const managementArea = document.getElementById('partnerManagementArea');
    if (managementArea) {
        managementArea.innerHTML = `
            <div class="development-placeholder">
                <div class="development-icon">üöÄ</div>
                <div class="development-title">Partner Management Dashboard</div>
                <div class="development-text" style="color: #CCC; line-height: 1.6;">
                    Your partner management dashboard is being prepared.<br><br>
                    <strong style="color: #FFD700;">Features in Development:</strong><br>
                    ‚Ä¢ View your referral network<br>
                    ‚Ä¢ Manage partner relationships<br>
                    ‚Ä¢ Track team performance<br>
                    ‚Ä¢ Earnings distribution<br>
                    ‚Ä¢ Training and support tools<br><br>
                    <em>This powerful toolset will help you grow and manage your network effectively.</em>
                </div>
            </div>
        `;
    }
}

// ‚úÖ –ù–û–í–ê–Ø: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∞–≤—Ç–æ—Ä–∞
function addCoauthor() {
    const addressInput = document.getElementById('newCoauthorAddress');
    const address = addressInput.value.trim();
    
    if (!address) {
        showNotification('Please enter a wallet address', 'error');
        return;
    }
    
    if (!web3.utils.isAddress(address)) {
        showNotification('Invalid wallet address', 'error');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∞–¥—Ä–µ—Å –≤ —Å–ø–∏—Å–∫–µ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
    if (!FOUNDERS_ADDRESSES.includes(address)) {
        showNotification('Address must be from the founders list', 'error');
        return;
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–∞–≤—Ç–æ—Ä–∞
    let coauthors = JSON.parse(localStorage.getItem('coauthorsList') || '[]');
    
    if (coauthors.find(ca => ca.address.toLowerCase() === address.toLowerCase())) {
        showNotification('This address is already a co-author', 'error');
        return;
    }
    
    const newCoauthor = {
        address: address,
        addedDate: new Date().toISOString(),
        status: 'active',
        addedBy: userWalletAddress
    };
    
    coauthors.push(newCoauthor);
    localStorage.setItem('coauthorsList', JSON.stringify(coauthors));
    
    addressInput.value = '';
    showNotification('Co-author added successfully!', 'success');
    loadCoauthorsList();
}

// ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–æ–∞–≤—Ç–æ—Ä–æ–≤
function loadCoauthorsList() {
    const coauthors = JSON.parse(localStorage.getItem('coauthorsList') || '[]');
    const listContainer = document.getElementById('coauthorsList');
    
    if (!listContainer) return;
    
    if (coauthors.length === 0) {
        listContainer.innerHTML = `
            <div style="text-align: center; color: #CCC; padding: 40px;">
                No co-authors assigned yet
            </div>
        `;
        return;
    }
    
    let listHTML = '<div style="background: rgba(139, 69, 19, 0.1); border: 1px solid #D2691E; border-radius: 12px; padding: 20px;"><h4 style="color: #D2691E; margin-bottom: 15px;">Current Co-Authors</h4>';
    
    coauthors.forEach((coauthor, index) => {
        listHTML += `
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(139, 69, 19, 0.05); border-radius: 8px; margin-bottom: 10px;">
                <div>
                    <div style="color: #D2691E; font-weight: bold;">${coauthor.address}</div>
                    <div style="color: #CCC; font-size: 12px;">Added: ${new Date(coauthor.addedDate).toLocaleDateString()}</div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button onclick="editCoauthor(${index})" style="background: rgba(255,255,255,0.1); border: 1px solid #FFD700; color: #FFD700; border-radius: 5px; padding: 5px 10px; cursor: pointer; font-size: 12px;">Edit</button>
                    <button onclick="removeCoauthor(${index})" style="background: rgba(255,68,68,0.1); border: 1px solid #FF4444; color: #FF4444; border-radius: 5px; padding: 5px 10px; cursor: pointer; font-size: 12px;">Remove</button>
                </div>
            </div>
        `;
    });
    
    listHTML += '</div>';
    listContainer.innerHTML = listHTML;
}

function editCoauthor(index) {
    showNotification('Co-author editing feature coming soon', 'info');
}

function removeCoauthor(index) {
    if (confirm('Are you sure you want to remove this co-author?')) {
        let coauthors = JSON.parse(localStorage.getItem('coauthorsList') || '[]');
        coauthors.splice(index, 1);
        localStorage.setItem('coauthorsList', JSON.stringify(coauthors));
        
        showNotification('Co-author removed successfully', 'success');
        loadCoauthorsList();
    }
}

    // ‚úÖ –ù–û–í–ê–Ø: –§—É–Ω–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π
    function showTeamManagement() {
        const teamManagementArea = document.getElementById('teamManagementArea');
        if (teamManagementArea) {
            teamManagementArea.innerHTML = `
                <div class="development-placeholder">
                    <div class="development-icon">üë•</div>
                    <div class="development-title">Advanced Team Management</div>
                    <div class="development-text" style="color: #CCC; line-height: 1.6;">
                        Advanced team management system is in development.<br><br>
                        <strong style="color: #FFD700;">Coming Soon:</strong><br>
                        ‚Ä¢ Delegate Super Admin rights<br>
                        ‚Ä¢ Manage team permissions<br>
                        ‚Ä¢ Role-based access control<br>
                        ‚Ä¢ Team performance analytics<br>
                        ‚Ä¢ Multi-level delegation system<br>
                        ‚Ä¢ Real-time team monitoring
                    </div>
                </div>
            `;
        }
    }

    // ==================== –Ø–ó–´–ö–û–í–´–ï –§–£–ù–ö–¶–ò–ò ====================
    function switchLanguage(lang) {
        currentLanguage = lang;
        localStorage.setItem('adminLanguage', lang);
        
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`lang${lang.charAt(0).toUpperCase() + lang.slice(1)}`).classList.add('active');
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã
        applyTranslations(lang);
        
        showNotification(`Language changed to ${lang.toUpperCase()}`, 'success', 2000);
    }

   // ==================== –ú–£–õ–¨–¢–ò–Ø–ó–´–ß–ù–û–°–¢–¨ ====================
const translations = {
    en: {
        // Dashboard
        dashboardTitle: "üìä Web3 Dashboard",
        lastUpdate: "Last update:",
        connectionStatus: "üîê Connection Status",
        walletNotConnected: "‚ö†Ô∏è Wallet Not Connected",
        connectWalletDesc: "Connect your SafePal wallet to access all features",
        connectWallet: "üîê Connect Wallet",		
		writeNotes: "Write your notes about this user...",
        typeMessage: "Type your message...",
        enterUserId: "Enter User ID...",
        searchContacts: "Search by name or contact...",
        
        // Menu
        menuDashboard: "Dashboard",
        menuContacts: "Contacts",
        menuReferrals: "Referral System",
        menuCRM: "CRM & Chat",
        menuCoauthors: "Co-Authors",
        menuMailings: "Mass Mailings",
        menuAnalytics: "Advanced Analytics",
        menuWallet: "Web3 Wallet",
        menuSettings: "Settings",
        
        // Stats
        totalContactsLabel: "Total Contacts",
        totalReferralsLabel: "Active Referrals",
        totalEarningsLabel: "Earnings (opBNB)",
        totalCardsLabel: "Cards Generated",
        
        // Categories
        contactCategoriesTitle: "üì± Contact Categories",
        recentActivityTitle: "üìà Recent Activity",
        noActivityText: "Connect your wallet to see activity",
        
        // Contacts
        contactsTitle: "üë• Contact Management",
        exportBtn: "Export All",
        noContactsText: "Connect wallet to manage contacts",
        
        // Referrals
        referralsTitle: "üîó Referral Network & Marketing",
        networkStatus: "Network Status: Disconnected",
        
        // CRM
        crmTitle: "üí¨ CRM & Internal Chat",
        
        // Co-Authors
        coauthorsTitle: "üëë Co-Authors Management",
        
        // Mailings
        mailingsDevTitle: "Mass Mailings System",
        mailingsDevText: "Advanced mailing system is currently in development.",
        
        // Analytics
        analyticsDevTitle: "Advanced Analytics",
        analyticsDevText: "Comprehensive analytics dashboard is in development.",
        
        // Wallet
        walletTitle: "üíé Web3 Wallet",
        walletNetwork: "Network: opBNB Mainnet",
        walletConnectionTitle: "üîó Blockchain Connection",
        connectWalletText: "üîê Connect SafePal Wallet",
        walletConnectedText: "‚úÖ SafePal Connected",
        contractInfoTitle: "üìÑ Smart Contract Info",
        contractStatusLabel: "Status:",
        contractStatus: "Active",
        contractNetworkLabel: "Network:",
        contractAddressLabel: "Address:",
        
        // Settings
        settingsTitle: "‚öôÔ∏è Settings",
        languageSettingsTitle: "üåç Language Settings",
        adminSettings: "Admin Settings",
        automaticBackup: "Automatic Backup",
        automaticBackupDesc: "Automatically create backup copies of contact database",
        systemNotifications: "System Notifications", 
        systemNotificationsDesc: "Receive notifications about new registrations and system events",
        interfaceMode: "Interface Mode",
        interfaceModeDesc: "Choose between dark and light interface themes",
        darkMode: "üåô Dark Mode",
        lightMode: "‚òÄÔ∏è Light Mode",
        dataManagement: "Data Management",
        exportAllData: "Export All Data",
        exportAllDataDesc: "Download all your contacts, notes, and CRM data",
        importData: "Import Data",
        importDataDesc: "Import contacts and data from backup files",
        clearCache: "Clear Cache",
        clearCacheDesc: "Clear temporary data and cached files to free up space",
        securitySettings: "Security Settings",
        walletAutoConnect: "Wallet Auto-Connect",
        walletAutoConnectDesc: "Automatically connect to your wallet when visiting the dashboard",
        sessionTimeout: "Session Timeout",
        sessionTimeoutDesc: "Set automatic logout time for security",
        transactionConfirmation: "Transaction Confirmation",
        transactionConfirmationDesc: "Always confirm transactions before sending",
        notificationSettings: "Notification Settings",
        newReferralNotifications: "New Referral Notifications",
        newReferralNotificationsDesc: "Get notified when someone joins through your referral link",
        crmMessageNotifications: "CRM Message Notifications",
        crmMessageNotificationsDesc: "Receive notifications for new CRM messages",
        systemUpdateNotifications: "System Update Notifications",
        systemUpdateNotificationsDesc: "Get notified about system updates and new features",
        advancedSettings: "Advanced Settings",
        debugMode: "Debug Mode",
        debugModeDesc: "Enable debug mode for troubleshooting (developers only)",
        performanceMode: "Performance Mode",
        performanceModeDesc: "Optimize for better performance on slower devices",
        resetAllSettings: "Reset All Settings",
        resetAllSettingsDesc: "Reset all settings to default values",
        resetSettings: "üîÑ Reset Settings",
        
        // Activation buttons
        activateAccount: "üîê Activate Account",
        miniAdmin: "‚ö° Mini Admin", 
        superAdmin: "üöÄ Super Admin",
        
        // CRM
        userCRM: "User CRM",
        notes: "üìù Notes",
        chat: "üí¨ Chat",
        social: "üì± Social",
        writeNotes: "Write your notes about this user...",
        saveNotes: "üíæ Save Notes",
        noMessages: "No messages yet. Start a conversation!",
        typeMessage: "Type your message...",
        send: "Send",
        contactInformation: "Contact Information:",
        platform: "Platform:",
        contact: "Contact:",
        registrationDate: "Registration Date:",
        openSocialMedia: "üì± Open in Social Media",
        
        // New Chat Dialog
        newChat: "üí¨ New Chat",
        startConversation: "Start a conversation with a user",
        enterUserId: "Enter User ID...",
        startChat: "Start Chat",
        cancel: "Cancel"
    },
    
    ru: {
        // Dashboard
        dashboardTitle: "üìä Web3 –ü–∞–Ω–µ–ª—å",
        lastUpdate: "–û–±–Ω–æ–≤–ª–µ–Ω–æ:",
        connectionStatus: "üîê –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è",
        walletNotConnected: "‚ö†Ô∏è –ö–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω",
        connectWalletDesc: "–ü–æ–¥–∫–ª—é—á–∏—Ç–µ SafePal –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º",
        connectWallet: "üîê –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫",
		writeNotes: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –∑–∞–º–µ—Ç–∫–∏ –æ–± —ç—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ...",
        typeMessage: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...",
        enterUserId: "–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...",
        searchContacts: "–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç—É...",
        
        // Menu
        menuDashboard: "–ü–∞–Ω–µ–ª—å",
        menuContacts: "–ö–æ–Ω—Ç–∞–∫—Ç—ã",
        menuReferrals: "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞",
        menuCRM: "CRM –∏ –ß–∞—Ç",
        menuCoauthors: "–°–æ–∞–≤—Ç–æ—Ä—ã",
        menuMailings: "–ú–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏",
        menuAnalytics: "–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞",
        menuWallet: "Web3 –ö–æ—à–µ–ª–µ–∫",
        menuSettings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
        
        // Stats
        totalContactsLabel: "–í—Å–µ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤",
        totalReferralsLabel: "–ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª—ã",
        totalEarningsLabel: "–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ (opBNB)",
        totalCardsLabel: "–°–æ–∑–¥–∞–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ–∫",
        
        // Categories
        contactCategoriesTitle: "üì± –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤",
        recentActivityTitle: "üìà –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
        noActivityText: "–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
        
        // Contacts
        contactsTitle: "üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏",
        exportBtn: "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ",
        noContactsText: "–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏",
        
        // Referrals
        referralsTitle: "üîó –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥",
        networkStatus: "–°—Ç–∞—Ç—É—Å —Å–µ—Ç–∏: –û—Ç–∫–ª—é—á–µ–Ω",
        
        // CRM
        crmTitle: "üí¨ CRM –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —á–∞—Ç",
        
        // Co-Authors
        coauthorsTitle: "üëë –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∞–≤—Ç–æ—Ä–∞–º–∏",
        
        // Mailings
        mailingsDevTitle: "–°–∏—Å—Ç–µ–º–∞ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫",
        mailingsDevText: "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—ã–ª–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.",
        
        // Analytics
        analyticsDevTitle: "–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞",
        analyticsDevText: "–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–∞–Ω–µ–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.",
        
        // Wallet
        walletTitle: "üíé Web3 –ö–æ—à–µ–ª–µ–∫",
        walletNetwork: "–°–µ—Ç—å: opBNB Mainnet",
        walletConnectionTitle: "üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–ª–æ–∫—á–µ–π–Ω—É",
        connectWalletText: "üîê –ü–æ–¥–∫–ª—é—á–∏—Ç—å SafePal –∫–æ—à–µ–ª–µ–∫",
        walletConnectedText: "‚úÖ SafePal –ø–æ–¥–∫–ª—é—á–µ–Ω",
        contractInfoTitle: "üìÑ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ",
        contractStatusLabel: "–°—Ç–∞—Ç—É—Å:",
        contractStatus: "–ê–∫—Ç–∏–≤–µ–Ω",
        contractNetworkLabel: "–°–µ—Ç—å:",
        contractAddressLabel: "–ê–¥—Ä–µ—Å:",
        
        // Settings
        settingsTitle: "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
        languageSettingsTitle: "üåç –Ø–∑—ã–∫–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
        adminSettings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",
        automaticBackup: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ",
        automaticBackupDesc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∞–∑—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤",
        systemNotifications: "–°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
        systemNotificationsDesc: "–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è—Ö –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö",
        interfaceMode: "–†–µ–∂–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞",
        interfaceModeDesc: "–í—ã–±–µ—Ä–∏—Ç–µ –º–µ–∂–¥—É —Ç–µ–º–Ω–æ–π –∏ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–∞–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞",
        darkMode: "üåô –¢–µ–º–Ω—ã–π —Ä–µ–∂–∏–º",
        lightMode: "‚òÄÔ∏è –°–≤–µ—Ç–ª—ã–π —Ä–µ–∂–∏–º",
        dataManagement: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏",
        exportAllData: "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ",
        exportAllDataDesc: "–°–∫–∞—á–∞—Ç—å –≤—Å–µ –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã, –∑–∞–º–µ—Ç–∫–∏ –∏ CRM –¥–∞–Ω–Ω—ã–µ",
        importData: "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ",
        importDataDesc: "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤",
        clearCache: "–û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à",
        clearCacheDesc: "–û—á–∏—Å—Ç–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –º–µ—Å—Ç–∞",
        securitySettings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
        walletAutoConnect: "–ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞",
        walletAutoConnectDesc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –∫–æ—à–µ–ª—å–∫—É –ø—Ä–∏ –ø–æ—Å–µ—â–µ–Ω–∏–∏ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
        sessionTimeout: "–¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏",
        sessionTimeoutDesc: "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
        transactionConfirmation: "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π",
        transactionConfirmationDesc: "–í—Å–µ–≥–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π",
        notificationSettings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π",
        newReferralNotifications: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö",
        newReferralNotificationsDesc: "–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ –≤–∞—à–µ–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ",
        crmMessageNotifications: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è CRM —Å–æ–æ–±—â–µ–Ω–∏–π",
        crmMessageNotificationsDesc: "–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö CRM —Å–æ–æ–±—â–µ–Ω–∏—è—Ö",
        systemUpdateNotifications: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö",
        systemUpdateNotificationsDesc: "–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö",
        advancedSettings: "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
        debugMode: "–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏",
        debugModeDesc: "–í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)",
        performanceMode: "–†–µ–∂–∏–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏",
        performanceModeDesc: "–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö",
        resetAllSettings: "–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
        resetAllSettingsDesc: "–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é",
        resetSettings: "üîÑ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
        
        // Activation buttons
        activateAccount: "üîê –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞",
        miniAdmin: "‚ö° –ú–∏–Ω–∏ –ê–¥–º–∏–Ω",
        superAdmin: "üöÄ –°—É–ø–µ—Ä –ê–¥–º–∏–Ω",
        
        // CRM
        userCRM: "CRM –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        notes: "üìù –ó–∞–º–µ—Ç–∫–∏",
        chat: "üí¨ –ß–∞—Ç",
        social: "üì± –°–æ—Ü—Å–µ—Ç–∏",
        writeNotes: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –∑–∞–º–µ—Ç–∫–∏ –æ–± —ç—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ...",
        saveNotes: "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–º–µ—Ç–∫–∏",
        noMessages: "–°–æ–æ–±—â–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç. –ù–∞—á–Ω–∏—Ç–µ —Ä–∞–∑–≥–æ–≤–æ—Ä!",
        typeMessage: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...",
        send: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        contactInformation: "–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:",
        platform: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:",
        contact: "–ö–æ–Ω—Ç–∞–∫—Ç:",
        registrationDate: "–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:",
        openSocialMedia: "üì± –û—Ç–∫—Ä—ã—Ç—å –≤ —Å–æ—Ü—Å–µ—Ç–∏",
        
        // New Chat Dialog
        newChat: "üí¨ –ù–æ–≤—ã–π —á–∞—Ç",
        startConversation: "–ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º",
        enterUserId: "–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...",
        startChat: "–ù–∞—á–∞—Ç—å —á–∞—Ç",
        cancel: "–û—Ç–º–µ–Ω–∞"
    },
    
    ua: {
        // Dashboard
        dashboardTitle: "üìä Web3 –ü–∞–Ω–µ–ª—å",
        lastUpdate: "–û–Ω–æ–≤–ª–µ–Ω–æ:",
        connectionStatus: "üîê –°—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è",
        walletNotConnected: "‚ö†Ô∏è –ì–∞–º–∞–Ω–µ—Ü—å –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ",
        connectWalletDesc: "–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å SafePal –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π",
        connectWallet: "üîê –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å",
		writeNotes: "–ù–∞–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –Ω–æ—Ç–∞—Ç–∫–∏ –ø—Ä–æ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞...",
        typeMessage: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...",
        enterUserId: "–í–≤–µ–¥—ñ—Ç—å ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞...",
        searchContacts: "–ü–æ—à—É–∫ –∑–∞ —ñ–º–µ–Ω–µ–º –∞–±–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–º...",
        
        // Menu
        menuDashboard: "–ü–∞–Ω–µ–ª—å",
        menuContacts: "–ö–æ–Ω—Ç–∞–∫—Ç–∏",
        menuReferrals: "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞",
        menuCRM: "CRM —ñ –ß–∞—Ç",
        menuCoauthors: "–°–ø—ñ–≤–∞–≤—Ç–æ—Ä–∏",
        menuMailings: "–ú–∞—Å–æ–≤—ñ —Ä–æ–∑—Å–∏–ª–∫–∏",
        menuAnalytics: "–†–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞",
        menuWallet: "Web3 –ì–∞–º–∞–Ω–µ—Ü—å",
        menuSettings: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        
        // Stats
        totalContactsLabel: "–í—Å—å–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤",
        totalReferralsLabel: "–ê–∫—Ç–∏–≤–Ω—ñ —Ä–µ—Ñ–µ—Ä–∞–ª–∏",
        totalEarningsLabel: "–ó–∞—Ä–æ–±—ñ—Ç–æ–∫ (opBNB)",
        totalCardsLabel: "–°—Ç–≤–æ—Ä–µ–Ω–æ –ª–∏—Å—Ç—ñ–≤–æ–∫",
        
        // Categories
        contactCategoriesTitle: "üì± –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤",
        recentActivityTitle: "üìà –û—Å—Ç–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å",
        noActivityText: "–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å –≥–∞–º–∞–Ω–µ—Ü—å –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ",
        
        // Contacts
        contactsTitle: "üë• –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏",
        exportBtn: "–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å–µ",
        noContactsText: "–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å –≥–∞–º–∞–Ω–µ—Ü—å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏",
        
        // Referrals
        referralsTitle: "üîó –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ –º–µ—Ä–µ–∂–∞ —Ç–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥",
        networkStatus: "–°—Ç–∞—Ç—É—Å –º–µ—Ä–µ–∂—ñ: –í—ñ–¥–∫–ª—é—á–µ–Ω–æ",
        
        // CRM
        crmTitle: "üí¨ CRM —ñ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —á–∞—Ç",
        
        // Co-Authors
        coauthorsTitle: "üëë –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–ø—ñ–≤–∞–≤—Ç–æ—Ä–∞–º–∏",
        
        // Mailings
        mailingsDevTitle: "–°–∏—Å—Ç–µ–º–∞ –º–∞—Å–æ–≤–∏—Ö —Ä–æ–∑—Å–∏–ª–æ–∫",
        mailingsDevText: "–ü—Ä–æ–≥—Ä–µ—Å–∏–≤–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–æ–∑—Å–∏–ª–æ–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ.",
        
        // Analytics
        analyticsDevTitle: "–†–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞",
        analyticsDevText: "–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ –ø–∞–Ω–µ–ª—å –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ.",
        
        // Wallet
        walletTitle: "üíé Web3 –ì–∞–º–∞–Ω–µ—Ü—å",
        walletNetwork: "–ú–µ—Ä–µ–∂–∞: opBNB Mainnet",
        walletConnectionTitle: "üîó –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–ª–æ–∫—á–µ–π–Ω—É",
        connectWalletText: "üîê –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ SafePal –≥–∞–º–∞–Ω–µ—Ü—å",
        walletConnectedText: "‚úÖ SafePal –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ",
        contractInfoTitle: "üìÑ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç",
        contractStatusLabel: "–°—Ç–∞—Ç—É—Å:",
        contractStatus: "–ê–∫—Ç–∏–≤–Ω–∏–π",
        contractNetworkLabel: "–ú–µ—Ä–µ–∂–∞:",
        contractAddressLabel: "–ê–¥—Ä–µ—Å–∞:",
        
        // Settings
        settingsTitle: "‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        languageSettingsTitle: "üåç –ú–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        adminSettings: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞",
        automaticBackup: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è",
        automaticBackupDesc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó –±–∞–∑–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤",
        systemNotifications: "–°–∏—Å—Ç–µ–º–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è",
        systemNotificationsDesc: "–û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –Ω–æ–≤—ñ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ —Å–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–¥—ñ—ó",
        interfaceMode: "–†–µ–∂–∏–º —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É",
        interfaceModeDesc: "–û–±–µ—Ä—ñ—Ç—å –º—ñ–∂ —Ç–µ–º–Ω–æ—é —Ç–∞ —Å–≤—ñ—Ç–ª–æ—é —Ç–µ–º–∞–º–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É",
        darkMode: "üåô –¢–µ–º–Ω–∏–π —Ä–µ–∂–∏–º",
        lightMode: "‚òÄÔ∏è –°–≤—ñ—Ç–ª–∏–π —Ä–µ–∂–∏–º",
        dataManagement: "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏",
        exportAllData: "–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ",
        exportAllDataDesc: "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å—ñ –≤–∞—à—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏, –Ω–æ—Ç–∞—Ç–∫–∏ —Ç–∞ CRM –¥–∞–Ω—ñ",
        importData: "–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ",
        importDataDesc: "–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –¥–∞–Ω—ñ –∑ —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤",
        clearCache: "–û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à",
        clearCacheDesc: "–û—á–∏—Å—Ç–∏—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤—ñ –¥–∞–Ω—ñ —Ç–∞ –∫–µ—à–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ –¥–ª—è –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –º—ñ—Å—Ü—è",
        securitySettings: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏",
        walletAutoConnect: "–ê–≤—Ç–æ–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≥–∞–º–∞–Ω—Ü—è",
        walletAutoConnectDesc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è –¥–æ –≥–∞–º–∞–Ω—Ü—è –ø—Ä–∏ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—ñ –ø–∞–Ω–µ–ª—ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è",
        sessionTimeout: "–¢–∞–π–º–∞—É—Ç —Å–µ—Å—ñ—ó",
        sessionTimeoutDesc: "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–∞—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∏—Ö–æ–¥—É –¥–ª—è –±–µ–∑–ø–µ–∫–∏",
        transactionConfirmation: "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π",
        transactionConfirmationDesc: "–ó–∞–≤–∂–¥–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É–≤–∞—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –ø–µ—Ä–µ–¥ –≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é",
        notificationSettings: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å",
        newReferralNotifications: "–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –Ω–æ–≤–∏—Ö —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤",
        newReferralNotificationsDesc: "–û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∫–æ–ª–∏ —Ö—Ç–æ—Å—å —Ä–µ—î—Å—Ç—Ä—É—î—Ç—å—Å—è –∑–∞ –≤–∞—à–∏–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º",
        crmMessageNotifications: "–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è CRM –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å",
        crmMessageNotificationsDesc: "–û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –Ω–æ–≤—ñ CRM –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è",
        systemUpdateNotifications: "–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ —Å–∏—Å—Ç–µ–º–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è",
        systemUpdateNotificationsDesc: "–û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ —Å–∏—Å—Ç–µ–º–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó",
        advancedSettings: "–†–æ–∑—à–∏—Ä–µ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        debugMode: "–†–µ–∂–∏–º –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è",
        debugModeDesc: "–£–≤—ñ–º–∫–Ω—É—Ç–∏ —Ä–µ–∂–∏–º –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –¥–ª—è —É—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫ (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤)",
        performanceMode: "–†–µ–∂–∏–º –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ",
        performanceModeDesc: "–û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –¥–ª—è –∫—Ä–∞—â–æ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –Ω–∞ –ø–æ–≤—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö",
        resetAllSettings: "–°–∫–∏–Ω—É—Ç–∏ –≤—Å—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        resetAllSettingsDesc: "–°–∫–∏–Ω—É—Ç–∏ –≤—Å—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ –∑–Ω–∞—á–µ–Ω—å –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º",
        resetSettings: "üîÑ –°–∫–∏–Ω—É—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        
        // Activation buttons
        activateAccount: "üîê –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –∞–∫–∞—É–Ω—Ç–∞",
        miniAdmin: "‚ö° –ú—ñ–Ω—ñ –ê–¥–º—ñ–Ω",
        superAdmin: "üöÄ –°—É–ø–µ—Ä –ê–¥–º—ñ–Ω",
        
        // CRM
        userCRM: "CRM –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞",
        notes: "üìù –ù–æ—Ç–∞—Ç–∫–∏",
        chat: "üí¨ –ß–∞—Ç",
        social: "üì± –°–æ—Ü–º–µ—Ä–µ–∂—ñ",
        writeNotes: "–ù–∞–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –Ω–æ—Ç–∞—Ç–∫–∏ –ø—Ä–æ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞...",
        saveNotes: "üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ—Ç–∞—Ç–∫–∏",
        noMessages: "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø–æ–∫–∏ –Ω–µ–º–∞—î. –ü–æ—á–Ω—ñ—Ç—å —Ä–æ–∑–º–æ–≤—É!",
        typeMessage: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...",
        send: "–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏",
        contactInformation: "–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:",
        platform: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:",
        contact: "–ö–æ–Ω—Ç–∞–∫—Ç:",
        registrationDate: "–î–∞—Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó:",
        openSocialMedia: "üì± –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ —Å–æ—Ü–º–µ—Ä–µ–∂—ñ",
        
        // New Chat Dialog
        newChat: "üí¨ –ù–æ–≤–∏–π —á–∞—Ç",
        startConversation: "–ü–æ—á–∞—Ç–∏ —Ä–æ–∑–º–æ–≤—É –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º",
        enterUserId: "–í–≤–µ–¥—ñ—Ç—å ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞...",
        startChat: "–ü–æ—á–∞—Ç–∏ —á–∞—Ç",
        cancel: "–°–∫–∞—Å—É–≤–∞—Ç–∏"
    }
};

    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
    function applyTranslations(lang) {
        const t = translations[lang] || translations.en;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ ID
        Object.keys(t).forEach(key => {
            const element = document.getElementById(key);
            if (element) {
                element.textContent = t[key];
            }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.title = `CardGift - ${t.dashboardTitle || 'Admin Dashboard'}`;
        
        console.log(`üåç –Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${lang}`);
    }

    function extendTranslations() {
        // –ü—É—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    }
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
    function loadSavedLanguage() {
        const savedLang = localStorage.getItem('adminLanguage') || 'en';
        currentLanguage = savedLang;
        applyTranslations(savedLang);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        const activeBtn = document.getElementById(`lang${savedLang.charAt(0).toUpperCase() + savedLang.slice(1)}`);
        if (activeBtn) {
            activeBtn.classList.add('active');
        }
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
	   function loadSavedLanguage() {
        const savedLang = localStorage.getItem('adminLanguage') || 'en';
        currentLanguage = savedLang;
        applyTranslations(savedLang);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        const activeBtn = document.getElementById(`lang${savedLang.charAt(0).toUpperCase() + savedLang.slice(1)}`);
        if (activeBtn) {
            activeBtn.classList.add('active');
        }
    }

    // ==================== –ù–ê–°–¢–†–û–ô–ö–ò –§–£–ù–ö–¶–ò–ò ====================
    function toggleSetting(toggle, settingName) {
        toggle.classList.toggle('active');
        const isActive = toggle.classList.contains('active');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É
        localStorage.setItem(`setting_${settingName}`, isActive);
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É
        applySetting(settingName, isActive);
        
        showNotification(`Setting ${settingName} ${isActive ? 'enabled' : 'disabled'}`, 'success');
    }

    function applySetting(settingName, isActive) {
        switch(settingName) {
            case 'autoBackup':
                if (isActive) {
                    startAutoBackup();
                } else {
                    stopAutoBackup();
                }
                break;
            case 'systemNotifications':
                // –í–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                break;
            case 'autoConnect':
                localStorage.setItem('autoConnectWallet', isActive);
                break;
            case 'confirmTx':
                localStorage.setItem('confirmTransactions', isActive);
                break;
            case 'newReferralNotif':
                localStorage.setItem('newReferralNotifications', isActive);
                break;
            case 'crmNotif':
                localStorage.setItem('crmNotifications', isActive);
                break;
            case 'systemUpdateNotif':
                localStorage.setItem('systemUpdateNotifications', isActive);
                break;
            case 'debugMode':
                if (isActive) {
                    enableDebugMode();
                } else {
                    disableDebugMode();
                }
                break;
            case 'performanceMode':
                if (isActive) {
                    enablePerformanceMode();
                } else {
                    disablePerformanceMode();
                }
                break;
        }
    }

    function setTheme(theme) {
        if (theme === 'light') {
            document.body.style.background = 'linear-gradient(135deg, #f5f5f5 0%, #ffffff 50%, #f5f5f5 100%)';
            document.body.style.color = '#333';
            localStorage.setItem('theme', 'light');
            showNotification('Light theme activated', 'success');
        } else {
            document.body.style.background = 'linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%)';
            document.body.style.color = '#FFFFFF';
            localStorage.setItem('theme', 'dark');
            showNotification('Dark theme activated', 'success');
        }
    }

    function setSessionTimeout(minutes) {
        localStorage.setItem('sessionTimeout', minutes);
        
        if (minutes > 0) {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –∞–≤—Ç–æ–≤—ã—Ö–æ–¥–∞
            if (window.sessionTimer) {
                clearTimeout(window.sessionTimer);
            }
            
            window.sessionTimer = setTimeout(() => {
                showNotification('Session timeout reached. Please reconnect your wallet.', 'warning');
                // –û—Ç–∫–ª—é—á–∞–µ–º –∫–æ—à–µ–ª–µ–∫
                userWalletAddress = null;
                isWeb3Connected = false;
                localStorage.removeItem('connectedWallet');
                updateUserInterface();
            }, minutes * 60 * 1000);
        }
        
        showNotification(`Session timeout set to ${minutes > 0 ? minutes + ' minutes' : 'never'}`, 'success');
    }

    function exportAllData() {
        const allData = {
            contacts: contactsData,
            referrals: referralData,
            settings: {},
            user: currentUser,
            timestamp: new Date().toISOString()
        };
        
        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('setting_')) {
                allData.settings[key] = localStorage.getItem(key);
            }
        }
        
        const dataStr = JSON.stringify(allData, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `cardgift-full-backup-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification('All data exported successfully!', 'success');
    }

    function importData() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        
        input.onchange = function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                        if (data.contacts) {
                            contactsData = data.contacts;
                            localStorage.setItem('allContacts', JSON.stringify(contactsData));
                        }
                        
                        if (data.referrals) {
                            referralData = data.referrals;
                            localStorage.setItem('referralDatabase', JSON.stringify(referralData));
                        }
                        
                        if (data.settings) {
                            Object.keys(data.settings).forEach(key => {
                                localStorage.setItem(key, data.settings[key]);
                            });
                        }
                        
                        updateDashboardStats();
                        showNotification('Data imported successfully!', 'success');
                        
                        // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
                        setTimeout(() => window.location.reload(), 2000);
                        
                    } catch (error) {
                        showNotification('Failed to import data. Invalid file format.', 'error');
                    }
                };
                reader.readAsText(file);
            }
        };
        
        input.click();
    }

    function clearCache() {
        if (confirm('Are you sure you want to clear cache? This will remove temporary data.')) {
            // –û—á–∏—â–∞–µ–º –∫–µ—à, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const importantKeys = ['allContacts', 'referralDatabase', 'connectedWallet', 'adminLanguage', 'currentUser'];
            
            const tempData = {};
            importantKeys.forEach(key => {
                tempData[key] = localStorage.getItem(key);
            });
            
            localStorage.clear();
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            importantKeys.forEach(key => {
                if (tempData[key]) {
                    localStorage.setItem(key, tempData[key]);
                }
            });
            
            showNotification('Cache cleared successfully!', 'success');
        }
    }

    function resetAllSettings() {
        if (confirm('Are you sure you want to reset all settings to default? This cannot be undone.')) {
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('setting_')) {
                    keysToRemove.push(key);
                }
            }
            
            keysToRemove.forEach(key => localStorage.removeItem(key));
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–º—É
            setTheme('dark');
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
            showNotification('All settings reset to default!', 'success');
            setTimeout(() => window.location.reload(), 2000);
        }
    }

    // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
    function startAutoBackup() {
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
        if (window.autoBackupInterval) {
            clearInterval(window.autoBackupInterval);
        }
        
        window.autoBackupInterval = setInterval(() => {
            exportAllData();
            console.log('üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ');
        }, 24 * 60 * 60 * 1000); // 24 —á–∞—Å–∞
    }

    function stopAutoBackup() {
        if (window.autoBackupInterval) {
            clearInterval(window.autoBackupInterval);
            window.autoBackupInterval = null;
        }
    }

    function enableDebugMode() {
        window.cardGiftDebug = {
            clearData: clearAllData,
            exportLogs: exportLogs,
            checkUser: checkUserAccess,
            updateUI: updateUserInterface,
            getBalance: getWalletBalance,
            ensureNetwork: ensureOpBNBNetwork,
            currentUser: () => currentUser,
            contractConfig: CONTRACT_CONFIG,
            showLevel: showLevel,
            searchContacts: searchContacts,
            updateCRM: updateCRMStats
        };
        
        console.log('üîß Debug mode enabled. Use window.cardGiftDebug');
    }

    function disableDebugMode() {
        delete window.cardGiftDebug;
        console.log('üîß Debug mode disabled');
    }

    function enablePerformanceMode() {
        // –û—Ç–∫–ª—é—á–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        document.body.style.setProperty('--animation-duration', '0s');
        document.body.classList.add('performance-mode');
    }

    function disablePerformanceMode() {
        document.body.style.removeProperty('--animation-duration');
        document.body.classList.remove('performance-mode');
    }

    // ==================== –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ====================
    function loadDashboardData() {
        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î
        const storedContacts = localStorage.getItem('allContacts');
        if (storedContacts) {
            contactsData = JSON.parse(storedContacts);
        } else {
            contactsData = {
                telegram: [],
                whatsapp: [],
                email: [],
                instagram: [],
                viber: [],
                facebook: [],
                tiktok: [],
                twitter: []
            };
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫—É—é –ë–î
        const storedReferrals = localStorage.getItem('referralDatabase');
        if (storedReferrals) {
            referralData = JSON.parse(storedReferrals);
        } else {
            referralData = {
                levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] },
                users: {} // ID: –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            };
        }
        
        updateDashboardStats();
    }

    function updateDashboardStats() {
        let totalContacts = 0;
        Object.keys(contactsData).forEach(category => {
            const count = contactsData[category].length;
            totalContacts += count;
            
            const counterElement = document.getElementById(category + 'Count');
            if (counterElement) {
                counterElement.textContent = count;
            }
        });
        
        document.getElementById('totalContacts').textContent = totalContacts;
        
        const cardsData = localStorage.getItem('userCards');
        let totalCards = 0;
        if (cardsData) {
            const cardsObject = JSON.parse(cardsData);
            Object.keys(cardsObject).forEach(userId => {
                totalCards += cardsObject[userId].length;
            });
        }
        document.getElementById('totalCards').textContent = totalCards;
        
        let totalReferrals = 0;
        if (referralData && referralData.levels) {
            Object.values(referralData.levels).forEach(level => {
                totalReferrals += level.length;
            });
        }
        document.getElementById('totalReferrals').textContent = totalReferrals;
        
        updateTime();
    }

    // ==================== –£–¢–ò–õ–ò–¢–´ ====================
    function updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        const updateTimeElement = document.getElementById('updateTime');
        if (updateTimeElement) {
            updateTimeElement.textContent = timeString;
        }
    }

    function exportContacts() {
        if (currentUser.level === 0) {
            showNotification('Connect wallet to export contacts', 'error');
            return;
        }
        
        const dataStr = JSON.stringify(contactsData, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `cardgift-contacts-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification('Contacts exported successfully!', 'success');
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function generateUserId() {
        try {
            const array = new Uint32Array(2);
            window.crypto.getRandomValues(array);
            const randomNum = (array[0] % 9000000) + 1000000;
            return randomNum.toString();
        } catch (error) {
            return Math.floor(1000000 + Math.random() * 9000000).toString();
        }
    }

    // ==================== –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô ====================
    function showNotification(message, type = 'info', duration = 3000) {
        const existingNotification = document.querySelector('.notification');
        if (existingNotification) {
            existingNotification.remove();
        }
        
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.textContent = message;
        
        notification.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 10000;
            opacity: 0;
            transform: translateY(100%);
            transition: all 0.3s ease;
            border: 1px solid #333;
            max-width: 400px;
            word-wrap: break-word;
            font-weight: 500;
            backdrop-filter: blur(10px);
        `;
        
        if (type === 'success') {
            notification.style.borderColor = '#4CAF50';
            notification.style.background = 'rgba(76, 175, 80, 0.2)';
            notification.style.color = '#4CAF50';
        } else if (type === 'error') {
            notification.style.borderColor = '#f44336';
            notification.style.background = 'rgba(244, 67, 54, 0.2)';
            notification.style.color = '#f44336';
        } else if (type === 'info') {
            notification.style.borderColor = '#2196F3';
            notification.style.background = 'rgba(33, 150, 243, 0.2)';
            notification.style.color = '#2196F3';
        }
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.opacity = '1';
            notification.style.transform = 'translateY(0)';
        }, 100);
        
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.transform = 'translateY(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, duration);
    }

    // ==================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–¢–ò–õ–ò–¢–´ ====================
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
    async function getWalletBalance() {
        try {
            if (!web3 || !userWalletAddress) return '0';
            
            const balance = await web3.eth.getBalance(userWalletAddress);
            return web3.utils.fromWei(balance, 'ether');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
            return '0';
        }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
    async function updateWalletBalance() {
        try {
            const balance = await getWalletBalance();
            const balanceElement = document.getElementById('walletBalance');
            if (balanceElement) {
                balanceElement.textContent = `Balance: ${parseFloat(balance).toFixed(4)} BNB`;
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏ opBNB
    async function ensureOpBNBNetwork() {
        try {
            const provider = window.safepal?.ethereum || window.ethereum;
            if (!provider) return false;
            
            const chainId = await provider.request({ method: 'eth_chainId' });
            const currentChainId = parseInt(chainId, 16);
            
            if (currentChainId !== CONTRACT_CONFIG.chainId) {
                console.log('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ opBNB...');
                
                try {
                    await provider.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId) }]
                    });
                    console.log('‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ opBNB');
                    return true;
                } catch (switchError) {
                    if (switchError.code === 4902) {
                        // –°–µ—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –¥–æ–±–∞–≤–ª—è–µ–º
                        await provider.request({
                            method: 'wallet_addEthereumChain',
                            params: [{
                                chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId),
                                chainName: 'opBNB Mainnet',
                                nativeCurrency: {
                                    name: 'BNB',
                                    symbol: 'BNB',
                                    decimals: 18
                                },
                                rpcUrls: [CONTRACT_CONFIG.rpcUrl],
                                blockExplorerUrls: ['https://opbnbscan.com/']
                            }]
                        });
                        console.log('‚úÖ opBNB —Å–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞');
                        return true;
                    }
                    throw switchError;
                }
            }
            
            return true;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é:', error);
            showNotification('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ opBNB', 'error');
            return false;
        }
    }

    // –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
    function clearAllData() {
        if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ dashboard? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
            localStorage.clear();
            sessionStorage.clear();
            showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
            setTimeout(() => window.location.reload(), 1000);
        }
    }

    // –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    function exportLogs() {
        try {
            const logs = localStorage.getItem('dashboardLogs') || '[]';
            const blob = new Blob([logs], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `cardgift-dashboard-logs-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            showNotification('–õ–æ–≥–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤:', error);
            showNotification('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤', 'error');
        }
    }

    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    function logEvent(eventName, data = {}) {
        const timestamp = new Date().toISOString();
        console.log(`üìä [${timestamp}] ${eventName}:`, data);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        const logs = JSON.parse(localStorage.getItem('dashboardLogs') || '[]');
        logs.push({
            timestamp,
            event: eventName,
            data,
            userAgent: navigator.userAgent,
            wallet: connectedWallet,
            userLevel: currentUser.level
        });
        
        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π
        if (logs.length > 100) {
            logs.splice(0, logs.length - 100);
        }
        
        localStorage.setItem('dashboardLogs', JSON.stringify(logs));
    }

    // ==================== –ü–ï–†–ò–û–î–ò–ß–ï–°–ö–ò–ï –û–ë–ù–û–í–õ–ï–ù–ò–Ø ====================
    setInterval(() => {
        updateTime();
        
        if (currentSection === 'dashboard') {
            updateDashboardStats();
        }
        
        if (currentSection === 'crm' && currentUser.level >= 2) {
            updateCRMStats();
        }
    }, 30000);

    // ==================== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ====================
    window.addEventListener('resize', () => {
        if (window.innerWidth > 768) {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            sidebar.classList.remove('mobile-visible', 'mobile-hidden');
            mainContent.classList.remove('full-width');
        }
    });

    // ==================== –ó–ê–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù ====================
    window.addEventListener('click', function(event) {
        const crmModal = document.getElementById('crmModal');
        const newChatDialog = document.getElementById('newChatDialog');
        
        if (event.target === crmModal) {
            closeCRMModal();
        }
        
        if (event.target === newChatDialog) {
            cancelNewChat();
        }
    });

    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeCRMModal();
            cancelNewChat();
        }
    });

    // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô –ö–û–®–ï–õ–¨–ö–ê ====================
// –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', async () => {
    try {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —è–∑—ã–∫
        loadSavedLanguage();
        
        // ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ü–ï–†–í–´–ú –î–ï–õ–û–ú
        const savedUser = localStorage.getItem('currentUser');
        if (savedUser) {
            const userData = JSON.parse(savedUser);
            if (userData.userId && userData.userId !== 'NOT_CONNECTED') {
                console.log('‚úÖ –ù–∞–π–¥–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', userData.userId);
                currentUser = userData;
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
            } else {
                console.log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
                if (confirm('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é?')) {
                    window.location.href = 'registration.html';
                    return;
                }
            }
        } else {
            console.log('‚ùå –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
            if (confirm('–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏?')) {
                window.location.href = 'registration.html';
                return;
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º Web3 –∫–æ—à–µ–ª–µ–∫
        const provider = window.safepal?.ethereum || window.ethereum;
        
        if (provider) {
            const accounts = await provider.request({
                method: 'eth_accounts'
            });
            
            if (accounts.length > 0) {
                console.log('üîÑ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:', accounts[0]);
                userWalletAddress = accounts[0].toLowerCase();
                localStorage.setItem('connectedWallet', userWalletAddress);
                isWeb3Connected = true;
                await checkUserAccess();
                updateUserInterface();
                console.log('‚úÖ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ');
            }
        }
    } catch (error) {
        console.log('‚ÑπÔ∏è –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ:', error);
    }
});

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ—à–µ–ª—å–∫–∞
    if (window.safepal && window.safepal.ethereum) {
        window.safepal.ethereum.on('accountsChanged', (accounts) => {
            console.log('üîÑ SafePal –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω—ã:', accounts);
            if (accounts.length === 0) {
                userWalletAddress = null;
                isWeb3Connected = false;
                currentUser = { userId: 'NOT_CONNECTED', level: 0, isActive: false, walletAddress: null };
                localStorage.removeItem('connectedWallet');
                updateUserInterface();
                showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
                window.location.reload();
            } else {
                userWalletAddress = accounts[0].toLowerCase();
                localStorage.setItem('connectedWallet', userWalletAddress);
                checkUserAccess().then(() => updateUserInterface());
            }
        });
        
        window.safepal.ethereum.on('chainChanged', (chainId) => {
            console.log('üîÑ SafePal —Å–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞:', chainId);
            if (parseInt(chainId, 16) !== CONTRACT_CONFIG.chainId) {
                showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ opBNB —Å–µ—Ç—å', 'warning');
            }
            setTimeout(() => window.location.reload(), 1000);
        });
    } else if (window.ethereum) {
        window.ethereum.on('accountsChanged', (accounts) => {
            console.log('üîÑ Ethereum –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω—ã:', accounts);
            if (accounts.length === 0) {
                userWalletAddress = null;
                isWeb3Connected = false;
                currentUser = { userId: 'NOT_CONNECTED', level: 0, isActive: false, walletAddress: null };
                localStorage.removeItem('connectedWallet');
                updateUserInterface();
                showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
                window.location.reload();
            } else {
                userWalletAddress = accounts[0].toLowerCase();
                localStorage.setItem('connectedWallet', userWalletAddress);
                checkUserAccess().then(() => updateUserInterface());
            }
        });
        
        window.ethereum.on('chainChanged', (chainId) => {
            console.log('üîÑ Ethereum —Å–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞:', chainId);
            if (parseInt(chainId, 16) !== CONTRACT_CONFIG.chainId) {
                showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ opBNB —Å–µ—Ç—å', 'warning');
            }
            setTimeout(() => window.location.reload(), 1000);
        });
    }

    // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ù–ê–°–¢–†–û–ï–ö ====================
    function loadSettings() {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        const settings = [
            'autoBackup', 'systemNotifications', 'autoConnect', 'confirmTx',
            'newReferralNotif', 'crmNotif', 'systemUpdateNotif', 'debugMode', 'performanceMode'
        ];
        
        settings.forEach(setting => {
            const saved = localStorage.getItem(`setting_${setting}`);
            if (saved !== null) {
                const isActive = saved === 'true';
                const toggle = document.getElementById(`${setting}Toggle`);
                if (toggle) {
                    if (isActive) {
                        toggle.classList.add('active');
                    } else {
                        toggle.classList.remove('active');
                    }
                    applySetting(setting, isActive);
                }
            }
        });
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–º—É
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            setTheme(savedTheme);
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏
        const savedTimeout = localStorage.getItem('sessionTimeout');
        if (savedTimeout) {
            setSessionTimeout(parseInt(savedTimeout));
        }
    }

    // ==================== –í–ê–õ–ò–î–ê–¶–ò–Ø –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ ====================
    function validateUserInput(input) {
        // –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if (typeof input !== 'string') return false;
        if (input.length > 1000) return false;
        if (input.includes('<script>') || input.includes('javascript:')) return false;
        return true;
    }

    function sanitizeInput(input) {
        // –û—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        return input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
                   .replace(/javascript:/gi, '')
                   .replace(/on\w+\s*=/gi, '');
    }

    // ==================== –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ ====================
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // –î–µ–±–∞—É–Ω—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
    const debouncedSearch = debounce(searchContacts, 300);

    // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–û–ù–°–û–õ–ò ====================
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    window.cardGiftDebug = {
        clearData: clearAllData,
        exportLogs: exportLogs,
        checkUser: checkUserAccess,
        updateUI: updateUserInterface,
        getBalance: getWalletBalance,
        ensureNetwork: ensureOpBNBNetwork,
        currentUser: () => currentUser,
        contractConfig: CONTRACT_CONFIG,
        showLevel: showLevel,
        searchContacts: searchContacts,
        updateCRM: updateCRMStats,
        loadSettings: loadSettings,
        logEvent: logEvent
    };

    // ==================== –§–ò–ù–ê–õ–¨–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    document.addEventListener('DOMContentLoaded', function() {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        loadSettings();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('input', debouncedSearch);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Enter –¥–ª—è —á–∞—Ç–∞
        const chatInput = document.getElementById('chatInput');
        if (chatInput) {
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Enter –¥–ª—è –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞
        const newChatInput = document.getElementById('newChatUserId');
        if (newChatInput) {
            newChatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    confirmNewChat();
                }
            });
        }
        
        console.log('üéâ CardGift Web3 Dashboard –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
        console.log('üí° –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: window.cardGiftDebug');
        
        // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
        logEvent('dashboard_initialized', {
            userAgent: navigator.userAgent,
            screenSize: `${window.innerWidth}x${window.innerHeight}`,
            timestamp: new Date().toISOString(),
            language: currentLanguage,
            userLevel: currentUser.level
        });
    });

    // ==================== –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö ====================
    window.addEventListener('error', function(event) {
        console.error('üí• –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞:', event.error);
        logEvent('global_error', {
            message: event.message,
            filename: event.filename,
            lineno: event.lineno,
            colno: event.colno,
            error: event.error ? event.error.toString() : 'Unknown error'
        });
    });

    window.addEventListener('unhandledrejection', function(event) {
        console.error('üí• –ù–µ–ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ Promise:', event.reason);
        logEvent('promise_rejection', {
            reason: event.reason ? event.reason.toString() : 'Unknown rejection'
        });
    });

    // ==================== –ü–û–õ–ò–§–ò–õ–´ –ò –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨ ====================
    // –ü–æ–ª–∏—Ñ–∏–ª –¥–ª—è navigator.clipboard –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
    if (!navigator.clipboard) {
        navigator.clipboard = {
            writeText: function(text) {
                return new Promise((resolve, reject) => {
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        document.execCommand('copy');
                        resolve();
                    } catch (err) {
                        reject(err);
                    } finally {
                        document.body.removeChild(textarea);
                    }
                });
            }
        };
    }

    // ==================== –ó–ê–í–ï–†–®–ï–ù–ò–ï ====================
    console.log('üöÄ CardGift Web3 Dashboard script loaded successfully!');
    console.log('üîó Domain configured:', DOMAIN);
    console.log('‚öôÔ∏è All fixes applied:');
    console.log('  ‚úÖ CRM Modal fixed (no more prompt)');
    console.log('  ‚úÖ Activation buttons logic fixed');
    console.log('  ‚úÖ Levels 6-9 unlocked for founders');
    console.log('  ‚úÖ Team management instead of add co-author');
    console.log('  ‚úÖ Full settings restored');
    console.log('  ‚úÖ Referral links shortened');
    console.log('  ‚úÖ Domain cardgift.bnb implemented');
    console.log('  ‚úÖ Auto-connect improved');
    console.log('üíé Ready for production!');

// ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø –ö –û–°–ù–û–í–ù–´–ú –§–ê–ô–õ–ê–ú ====================
function openMainSite() {
    window.open('index.html', '_blank');
}

function openGenerator() {
    const userId = currentUser.userId;
    const lang = currentLanguage;
    window.open(`generator.html?userId=${userId}&lang=${lang}`, '_blank');
}

// ==================== –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° REGISTRATION.HTML ====================
window.addEventListener('message', function(event) {
    if (event.data.type === 'USER_REGISTERED') {
        console.log('‚úÖ –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', event.data.user);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º currentUser
        currentUser = event.data.user;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateUserInterface();
        updateDashboardStats();
        
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ dashboard!', 'success');
    }
});

</script>
</body>
</html>
