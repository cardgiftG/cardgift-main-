<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title id="pageTitle">CardGift - –ü–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞</title>
	
	<!-- Favicon fix -->
   <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÅ</text></svg>">
    
    <!-- DYNAMIC OPEN GRAPH –¥–ª—è –ø—Ä–µ–≤—å—é –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö -->
    <meta property="og:title" content="–ü–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞ –æ—Ç CardGift" id="ogTitle">
    <meta property="og:description" content="–ö—Ä–∞—Å–∏–≤–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞" id="ogDescription">
    <meta property="og:image" content="" id="ogImage">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:type" content="website">
    <meta property="og:url" content="" id="ogUrl">
    <meta property="og:site_name" content="CardGift">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="–ü–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞" id="twitterTitle">
    <meta name="twitter:description" content="–ö—Ä–∞—Å–∏–≤–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞" id="twitterDescription">
    <meta name="twitter:image" content="" id="twitterImage">
    
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
	
	<script>
// üé¨ VideoProcessor –¥–ª—è card-viewer (—Ç–æ–ª—å–∫–æ YouTube) - –ò–°–ü–†–ê–í–õ–ï–ù
class VideoProcessor {
    constructor() {
        this.supportedPlatforms = {
            youtube: {
                patterns: [
                    // https://www.youtube.com/watch?v=XXXXXXXXXXX
                    /(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/,
                    // https://youtube.com/embed/XXXXXXXXXXX
                    /youtube\.com\/embed\/([a-zA-Z0-9_-]{11})/
                ],
                // –ò–°–ü–†–ê–í–õ–ï–ù: –£–±—Ä–∞–Ω autoplay, –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                embed: (id) => `https://www.youtube.com/embed/${id}?enablejsapi=1&controls=1&rel=0&modestbranding=1&playsinline=1&origin=${window.location.origin}`
            }
        };
    }

    parseVideoUrl(url) {
        if (!url) return { isValid: false };

        const config = this.supportedPlatforms.youtube;
        for (const pattern of config.patterns) {
            const match = url.match(pattern);
            if (match) {
                return {
                    isValid: true,
                    platform: "youtube",
                    videoId: match[1],
                    embedUrl: config.embed(match[1])
                };
            }
        }
        return { isValid: false };
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –°–æ–∑–¥–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ YouTube —ç–ª–µ–º–µ–Ω—Ç–∞
    createEnhancedYouTubeElement(videoData, container) {
        if (!videoData.isValid) {
            this.showVideoError(container, 'Invalid video URL');
            return;
        }

        container.innerHTML = '';

        // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        const youtubeContainer = document.createElement('div');
        youtubeContainer.className = 'youtube-container';

        // Iframe
        const iframe = document.createElement('iframe');
        iframe.src = videoData.embedUrl;
        iframe.frameBorder = '0';
        iframe.allowFullscreen = true;
        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen';
        iframe.sandbox = 'allow-scripts allow-same-origin allow-presentation allow-forms';
        iframe.loading = 'lazy';

        // –ö–Ω–æ–ø–∫–∞ –∑–≤—É–∫–∞
        const soundBtn = document.createElement('button');
        soundBtn.className = 'sound-control-btn';
        soundBtn.innerHTML = 'üîä –ó–≤—É–∫';
        soundBtn.onclick = () => this.enableSound(iframe, soundBtn);

        youtubeContainer.appendChild(iframe);
        youtubeContainer.appendChild(soundBtn);
        container.appendChild(youtubeContainer);

        return { iframe, container: youtubeContainer };
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –í–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞
    enableSound(iframe, button) {
        try {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –≤ YouTube iframe
            iframe.contentWindow.postMessage(
                '{"event":"command","func":"unMute","args":""}',
                '*'
            );
            iframe.contentWindow.postMessage(
                '{"event":"command","func":"playVideo","args":""}',
                '*'
            );
            
            button.innerHTML = 'üîä –í–ö–õ';
            button.style.background = 'rgba(76, 175, 80, 0.8)';
            
            setTimeout(() => {
                button.style.display = 'none';
            }, 2000);
            
        } catch (error) {
            console.warn('Could not control YouTube player:', error);
            button.innerHTML = '‚ùå';
        }
    }

    showVideoError(container, message) {
        container.innerHTML = `
            <div style="
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(255, 68, 68, 0.9);
                color: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                z-index: 10;
                font-weight: bold;
            ">
                ‚ùå ${message}
            </div>
        `;
    }
}

const videoProcessor = new VideoProcessor();
</script>
    
    <style>
        /* –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            height: 100%;
            width: 100%;
            overflow-x: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        }
        
        /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
        .language-switcher {
            position: fixed;
            top: 8px;
            right: 8px;
            z-index: 1000;
            display: flex;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 12px;
            padding: 2px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: #FFD700;
            padding: 4px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 24px;
        }

        .lang-btn.active {
            background: rgba(255, 215, 0, 0.3);
            color: #FFF;
        }
        
        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† - –ú–û–ë–ò–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø –ö–ê–ö –¢–ï–õ–ï–§–û–ù */
        .mobile-container {
            max-width: 400px;
            width: 90vw;
            height: 80vh;
            min-height: 600px;
            margin: 5vh auto;
            background: #000;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.3),
                0 0 0 1px rgba(255,255,255,0.1);
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        /* –°–¢–ê–¢–£–° –ë–ê–† –ö–ê–ö –£ –¢–ï–õ–ï–§–û–ù–ê */
        .status-bar {
            height: 24px;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            font-size: 12px;
            color: #FFF;
            font-weight: 500;
        }
        
        .status-left {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .status-right {
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        /* –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ë–ï–ì–£–©–ê–Ø –°–¢–†–û–ö–ê –í–í–ï–†–•–£ (–∑–∞–º–µ–Ω—è–µ—Ç –≤–µ—Ä—Ö–Ω–∏–π –±–∞–Ω–Ω–µ—Ä) */
        .top-marquee {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            height: 32px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            display: none;
            align-items: center;
            font-weight: bold;
            font-size: 12px;
        }
        
        .top-marquee.show {
            display: flex;
        }
        
        .top-marquee:hover {
            background: linear-gradient(45deg, #FFE55C, #FFB700);
        }
        
        .marquee-content {
            animation: marqueeMove 15s linear infinite;
            white-space: nowrap;
            padding-left: 100%;
        }
        
        @keyframes marqueeMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
        
        /* –û–°–ù–û–í–ù–ê–Ø –û–ë–õ–ê–°–¢–¨ –ö–ê–†–¢–´ */
        .card-area {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        
        /* –ò–°–ü–†–ê–í–õ–ï–ù–û: –§–û–ù–û–í–û–ï –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï –ë–ï–ó –ó–ê–¢–ï–ú–ù–ï–ù–ò–Ø –ò –ü–†–ê–í–ò–õ–¨–ù–û–ï –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï */
        .background-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 1;
        }
		
		/* üé¨ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø YOUTUBE */
        .youtube-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
            background: #000;
            border-radius: inherit;
            overflow: hidden;
        }

        .youtube-container iframe {
            width: 100%;
            height: 100%;
            border: none;
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: all;
            border-radius: inherit;
        }

        /* –ö–ù–û–ü–ö–ê –ó–í–£–ö–ê */
        .sound-control-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            color: #FFD700;
            border: 2px solid #FFD700;
            padding: 8px 12px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .sound-control-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: scale(1.05);
        }
        
        /* –ö–û–ù–¢–ï–ù–¢ –ü–û–í–ï–†–• */
        .card-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 80px 20px 80px 20px;
            text-align: center;
            pointer-events: none;
        }

        .card-content > * {
            pointer-events: auto;
        }
        
        /* –ó–ê–ì–û–õ–û–í–û–ö */
        .card-title {
            color: #FFFFFF;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 
                -3px -3px 0 #000,
                3px -3px 0 #000,
                -3px 3px 0 #000,
                3px 3px 0 #000,
                -2px 0 0 #000,
                2px 0 0 #000,
                0 -2px 0 #000,
                0 2px 0 #000,
                0 0 15px rgba(0,0,0,1),
                0 0 25px rgba(0,0,0,0.8);
            margin-bottom: 15px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.5s forwards;
            position: relative;
            z-index: 11;
        }
        
        /* –ü–û–î–ó–ê–ì–û–õ–û–í–û–ö */
        .card-subtitle {
            color: #FFD700;
            font-size: 16px;
            font-weight: 600;
            text-shadow: 
                -3px -3px 0 #000,
                3px -3px 0 #000,
                -3px 3px 0 #000,
                3px 3px 0 #000,
                -2px 0 0 #000,
                2px 0 0 #000,
                0 -2px 0 #000,
                0 2px 0 #000,
                0 0 15px rgba(0,0,0,1),
                0 0 25px rgba(0,0,0,0.8);
            margin-bottom: 20px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.8s forwards;
            position: relative;
            z-index: 11;
        }
        
        /* –û–°–ù–û–í–ù–û–ô –¢–ï–ö–°–¢ */
        .greeting-text {
            color: #FFFFFF;
            font-size: 14px;
            font-weight: 500;
            text-shadow: 
                -3px -3px 0 #000,
                3px -3px 0 #000,
                -3px 3px 0 #000,
                3px 3px 0 #000,
                -2px 0 0 #000,
                2px 0 0 #000,
                0 -2px 0 #000,
                0 2px 0 #000,
                0 0 15px rgba(0,0,0,1),
                0 0 25px rgba(0,0,0,0.8);
            line-height: 1.4;
            opacity: 0;
            animation: fadeInUp 1s ease 1.1s forwards;
            max-width: 280px;
            position: relative;
            z-index: 11;
        }
        
        /* –ù–ò–ñ–ù–Ø–Ø –û–ë–õ–ê–°–¢–¨ */
        .bottom-area {
            background: linear-gradient(
                180deg,
                rgba(0,0,0,0.8) 0%,
                rgba(0,0,0,0.95) 100%
            );
            padding: 15px;
            z-index: 3;
        }
        
        /* CTA –°–ï–ö–¶–ò–Ø */
        .cta-section {
            text-align: center;
            margin-bottom: 15px;
            display: none;
        }
        
        .cta-section.show {
            display: block;
        }
        
        .cta-text {
            color: #FFFFFF;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .cta-subtitle {
            color: #FFD700;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* –ö–ù–û–ü–ö–ê –î–ï–ô–°–¢–í–ò–Ø */
        .action-button {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 10px;
            display: none;
        }
        
        .action-button.show {
            display: block;
        }
        
        .action-button:hover {
            background: linear-gradient(45deg, #FFE55C, #FFB700);
            transform: translateY(-1px);
        }
        
        /* –ù–ò–ñ–ù–ò–ô –ë–ê–ù–ù–ï–† */
        .bottom-banner {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            padding: 8px;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(100%);
            display: none;
        }
        
        .bottom-banner.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
            animation: slideUpBanner 0.6s ease forwards;
        }
        
        /* –°–¢–ò–õ–ò –§–û–ù–û–í */
        .style-classic {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .style-sunset {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
        }
        
        .style-ocean {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .style-space {
            background: linear-gradient(135deg, #0c0c0c 0%, #000000 100%);
            position: relative;
        }
        
        .style-space::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #FFD700, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255, 215, 0, 0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #FFD700, transparent);
            background-repeat: repeat;
            background-size: 250px 150px;
            animation: sparkle 3s ease-in-out infinite;
        }
        
        .style-neon {
            background: linear-gradient(45deg, #FF006E, #8338EC, #3A86FF);
            background-size: 400% 400%;
            animation: neonGradient 3s ease infinite;
        }
        
        /* –ê–ù–ò–ú–ê–¶–ò–ò */
        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUpBanner {
            0% { opacity: 0; transform: translateY(100%); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes neonGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* –ó–ê–ì–†–£–ó–ö–ê –ò –û–®–ò–ë–ö–ò */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: #FFD700;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 215, 0, 0.3);
            border-top: 4px solid #FFD700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 18px;
            font-weight: bold;
        }
        
        .error-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
            z-index: 9999;
        }
        
        .error-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .error-title {
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .error-text {
            color: #FFFFFF;
            font-size: 16px;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .error-button {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .error-button:hover {
            background: linear-gradient(45deg, #FFE55C, #FFB700);
            transform: translateY(-2px);
        }
        
        /* üì± –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø YOUTUBE */
        @media (max-width: 480px) {
            .mobile-container {
                width: 95vw;
                height: 85vh;
                margin: 2.5vh auto;
            }
            
            .card-content {
                padding: 60px 15px 60px 15px;
            }
            
            .card-title {
                font-size: 20px;
            }
            
            .card-subtitle {
                font-size: 14px;
            }
            
            .greeting-text {
                font-size: 12px;
            }

            .youtube-container {
                border-radius: 0;
            }
            
            .sound-control-btn {
                top: 10px;
                right: 10px;
                padding: 6px 10px;
                font-size: 11px;
            }
        }
        
        /* –°–ö–†–´–¢–ò–ï –≠–õ–ï–ú–ï–ù–¢–û–í */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ -->
    <div class="language-switcher">
        <button class="lang-btn" onclick="changeLanguage('en')" id="lang-en">EN</button>
        <button class="lang-btn" onclick="changeLanguage('ru')" id="lang-ru">RU</button>
        <button class="lang-btn active" onclick="changeLanguage('ua')" id="lang-ua">UA</button>
    </div>

    <!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ª–∏—Å—Ç—ñ–≤–∫—É...</div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –û–®–ò–ë–ö–ò -->
    <div id="errorScreen" class="error-screen hidden">
        <div class="error-icon">üòî</div>
        <div class="error-title" id="errorTitle">–õ–∏—Å—Ç—ñ–≤–∫—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>
        <div class="error-text" id="errorText">–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –ª–∏—Å—Ç—ñ–≤–∫—É</div>
        <a href="/generator.html" class="error-button" id="errorButton">–°—Ç–≤–æ—Ä–∏—Ç–∏ –ª–∏—Å—Ç—ñ–≤–∫—É</a>
    </div>

    <!-- –û–°–ù–û–í–ù–ê–Ø –ú–û–ë–ò–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø -->
    <div id="mainCard" class="mobile-container hidden">
        <!-- –°—Ç–∞—Ç—É—Å –±–∞—Ä –∫–∞–∫ —É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
        <div class="status-bar">
            <div class="status-left">
                <span>üîã</span>
                <span>üì∂</span>
                <span>üì¥</span>
            </div>
            <div class="status-right">
                <span id="currentTime">12:34</span>
            </div>
        </div>
        
        <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–≤–µ—Ä—Ö—É (–∑–∞–º–µ–Ω—è–µ—Ç –≤–µ—Ä—Ö–Ω–∏–π –±–∞–Ω–Ω–µ—Ä) -->
        <div class="top-marquee" id="topMarquee" onclick="handleMarqueeClick()">
            <div class="marquee-content" id="marqueeContent">
                <!-- –¢–µ–∫—Å—Ç –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∫–∞—Ä—Ç—ã -->
        <div class="card-area">
            <!-- –§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
            <div class="background-image" id="backgroundImage"></div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–≤–µ—Ä—Ö -->
            <div class="card-content">
                <div class="card-title" id="cardTitle">üéâ –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! üåü</div>
                <div class="card-subtitle" id="cardSubtitle">–ü—É—Å—Ç—å –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–π –≥–æ–¥ –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –≤–æ–ª—à–µ–±—Å—Ç–≤–∞!</div>
                <div class="greeting-text" id="greetingText">–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π WEB3.</div>
            </div>
        </div>
        
        <!-- –ù–∏–∂–Ω—è—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="bottom-area">
            <!-- CTA —Å–µ–∫—Ü–∏—è -->
            <div class="cta-section" id="ctaSection">
                <div class="cta-text" id="ctaText">–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ CardGift! üéâ</div>
                <div class="cta-subtitle" id="ctaSubtitle">–¶–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∞ –ª–∏—Å—Ç—ñ–≤–∫–∞ –∑ WEB3 —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é.</div>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è -->
            <button class="action-button" id="actionButton" onclick="handleActionClick()">
                –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫
            </button>
        </div>
        
        <!-- –ù–∏–∂–Ω–∏–π –±–∞–Ω–Ω–µ—Ä -->
        <div class="bottom-banner" id="bottomBanner" onclick="handleBottomBannerClick()">
            <span id="bottomBannerText">–ë–∞–Ω–µ—Ä</span>
        </div>
    </div>

    <script>
        // ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let cardId = null;
        let cardData = null;
        let currentLanguage = 'ua';
        let currentUrl = window.location.href;
        
        // ===== –§–£–ù–ö–¶–ò–Ø –û–ß–ò–°–¢–ö–ò URL =====
        function cleanUrl(url) {
            if (!url || typeof url !== 'string') return '';
            
            // –î–µ–∫–æ–¥–∏—Ä—É–µ–º HTML entities
            let cleanedUrl = url
                .replace(/&amp;/g, '&')
                .replace(/&#x2F;/g, '/')
                .replace(/&lt;/g, '<')
                .replace(/&gt;/g, '>')
                .replace(/&quot;/g, '"')
                .replace(/&#x27;/g, "'");
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å URL
            try {
                if (cleanedUrl.startsWith('http://') || cleanedUrl.startsWith('https://')) {
                    new URL(cleanedUrl); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
                    return cleanedUrl;
                }
            } catch (e) {
                console.warn('–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π URL:', cleanedUrl);
            }
            
            return '';
        }
        
        // ===== –ü–ï–†–ï–í–û–î–´ =====
        const translations = {
            en: {
                loading: "Loading card...",
                error: "Error",
                cardNotFound: "Card not found",
                checkLink: "Check the link or create a new card",
                createCard: "Create Card",
                ctaText: "Welcome to CardGift! üéâ",
                ctaSubtitle: "This is a demo card with WEB3 integration.",
                bottomBanner: "Banner",
                actionButton: "Get Gift",
                marqueeText: "Welcome to CardGift - Create amazing cards!"
            },
            ru: {
                loading: "–ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç–∫—Ä—ã—Ç–∫—É...",
                error: "–û—à–∏–±–∫–∞",
                cardNotFound: "–û—Ç–∫—Ä—ã—Ç–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                checkLink: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Å—ã–ª–∫—É –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –æ—Ç–∫—Ä—ã—Ç–∫—É",
                createCard: "–°–æ–∑–¥–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç–∫—É",
                ctaText: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CardGift! üéâ",
                ctaSubtitle: "–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞ —Å WEB3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π.",
                bottomBanner: "–ë–∞–Ω–µ—Ä",
                actionButton: "–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫",
                marqueeText: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CardGift - –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏!"
            },
            ua: {
                   loading: "–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ª–∏—Å—Ç—ñ–≤–∫—É...",
                   error: "–ü–æ–º–∏–ª–∫–∞",
                   cardNotFound: "–õ–∏—Å—Ç—ñ–≤–∫—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ",
                   checkLink: "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –ª–∏—Å—Ç—ñ–≤–∫—É",
                   createCard: "–°—Ç–≤–æ—Ä–∏—Ç–∏ –ª–∏—Å—Ç—ñ–≤–∫—É",
                   ctaText: "–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ CardGift! üéâ",
                   ctaSubtitle: "–¶–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∞ –ª–∏—Å—Ç—ñ–≤–∫–∞ –∑ WEB3 —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é.",
                   bottomBanner: "–ë–∞–Ω–µ—Ä",
                   actionButton: "–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–¥–∞—Ä—É–Ω–æ–∫",
                   marqueeText: "–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ CardGift - –°—Ç–≤–æ—Ä—é–π—Ç–µ –¥–∏–≤–æ–≤–∏–∂–Ω—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏!"
               }
           };

       // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
       document.addEventListener('DOMContentLoaded', function() {
           console.log('üì± CardGift Mobile Card Viewer LOADING...');
           
           cardId = getCardIdFromUrl();
           initializeLanguage();
           updateTime();
           loadAndDisplayCard();
           
           // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
           setInterval(updateTime, 60000);
       });

       // ===== –í–†–ï–ú–Ø –í –°–¢–ê–¢–£–° –ë–ê–†–ï =====
       function updateTime() {
           const now = new Date();
           const timeString = now.toLocaleTimeString('ru-RU', { 
               hour: '2-digit', 
               minute: '2-digit' 
           });
           document.getElementById('currentTime').textContent = timeString;
       }

       // ===== –Ø–ó–´–ö–û–í–´–ï –§–£–ù–ö–¶–ò–ò =====
       function changeLanguage(lang) {
           currentLanguage = lang;
           localStorage.setItem('cardGift_language', lang);
           
           document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
           document.getElementById(`lang-${lang}`).classList.add('active');
           
           updateTexts();
           console.log('üåç –Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞:', lang);
       }

       function initializeLanguage() {
           const urlParams = new URLSearchParams(window.location.search);
           const langParam = urlParams.get('lang');
           const savedLang = localStorage.getItem('cardGift_language');
           
           if (langParam && ['en', 'ru', 'ua'].includes(langParam)) {
               currentLanguage = langParam;
           } else if (savedLang) {
               currentLanguage = savedLang;
           }
           
           document.documentElement.lang = currentLanguage;
           document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
           document.getElementById(`lang-${currentLanguage}`).classList.add('active');
           
           updateTexts();
       }

       function updateTexts() {
           const t = translations[currentLanguage];
           
           document.getElementById('loadingText').textContent = t.loading;
           document.getElementById('errorTitle').textContent = t.cardNotFound;
           document.getElementById('errorText').textContent = t.checkLink;
           document.getElementById('errorButton').textContent = t.createCard;
           document.getElementById('ctaText').textContent = t.ctaText;
           document.getElementById('ctaSubtitle').textContent = t.ctaSubtitle;
           document.getElementById('bottomBannerText').textContent = t.bottomBanner;
           document.getElementById('actionButton').textContent = t.actionButton;
       }

       // ===== –ü–û–õ–£–ß–ï–ù–ò–ï ID –ö–ê–†–¢–´ =====
       function getCardIdFromUrl() {
           const urlParams = new URLSearchParams(window.location.search);
           return urlParams.get('id') || window.location.hash.replace('#', '') || null;
       }

       // ===== –ó–ê–ì–†–£–ó–ö–ê –ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ö–ê–†–¢–´ =====
       async function loadAndDisplayCard() {
           try {
               console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ä—Ç—É —Å ID:', cardId);
               
               if (!cardId) {
                   console.log('üìù –ù–µ—Ç ID –∫–∞—Ä—Ç—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ');
                   displayDemoCard();
                   return;
               }
               
               // –ü–æ–∏—Å–∫ –∫–∞—Ä—Ç—ã –≤ localStorage
               cardData = await findCardData(cardId);
               
               if (cardData) {
                   console.log('‚úÖ –ö–∞—Ä—Ç–∞ –Ω–∞–π–¥–µ–Ω–∞:', cardData);
                   displayCard(cardData);
               } else {
                   console.log('üé≠ –ö–∞—Ä—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ');
                   displayDemoCard();
               }
               
           } catch (error) {
               console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
               showError();
           }
       }

       // ===== –ü–û–ò–°–ö –î–ê–ù–ù–´–• –ö–ê–†–¢–´ =====
      async function findCardData(cardId) {
          // 1. –ü—Ä—è–º–æ–π –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á—É
          let cardData = localStorage.getItem(`card_${cardId}`);
          if (cardData) {
              try {
                  return JSON.parse(cardData);
              } catch (e) {
                  console.warn('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø—Ä—è–º–æ–≥–æ –∫–ª—é—á–∞');
              }
          }
          
          // 2. –ü–æ–∏—Å–∫ –≤ userCards
          const userCards = localStorage.getItem('userCards');
          if (userCards) {
              try {
                  const userCardsData = JSON.parse(userCards);
                  for (const userId in userCardsData) {
                      const cards = userCardsData[userId] || [];
                      const found = cards.find(card => card.cardId === cardId);
                      if (found) return found;
                  }
              } catch (e) {
                  console.warn('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ userCards');
              }
          }
          
          // 3. –ü–æ–∏—Å–∫ –≤ allCards
          const allCards = localStorage.getItem('allCards');
          if (allCards) {
              try {
                  const allCardsData = JSON.parse(allCards);
                  const found = allCardsData.find(card => card.cardId === cardId);
                  if (found) return found;
              } catch (e) {
                  console.warn('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ allCards');
              }
          }
          
          return null;
      }

      // ===== –î–ï–ú–û –ö–ê–†–¢–ê =====
      function displayDemoCard() {
   const demoStyles = ['classic', 'sunset', 'ocean', 'space', 'neon'];
   const randomStyle = demoStyles[Math.floor(Math.random() * demoStyles.length)];
   
   cardData = {
       cardId: 'demo_card',
       userId: 'demo_user',
       greeting: currentLanguage === 'en' ? 
           "üéâ Welcome to CardGift! üåü\nCreate amazing digital cards\nShare joy with modern technology" :
           currentLanguage === 'ru' ? 
           "üéâ –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! üåü\n–ü—É—Å—Ç—å –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–π –≥–æ–¥ –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –≤–æ–ª—à–µ–±—Å—Ç–≤–∞\n–¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏" :
           "üéâ –ó –ù–æ–≤–∏–º –†–æ–∫–æ–º! üåü\n–ù–µ—Ö–∞–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—ñ–∫ –±—É–¥–µ –ø–æ–≤–Ω–∏–π —á–∞—Ä—ñ–≤–Ω–æ—Å—Ç—ñ\n–¶–∏—Ñ—Ä–æ–≤—ñ –ø—Ä–∏–≤—ñ—Ç–∞–ª—å–Ω—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏",
       style: randomStyle,
       backgroundImage: null,
       music: null,
       fontColor: '#FFFFFF',
       fontSize: 'medium',
       shareLink: currentUrl,
       createdAt: new Date().toISOString(),
       lastModified: new Date().toISOString(),
       views: 0,
       isDemo: true,
       // CTA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
       ctaEnabled: true,
       ctaTitle: translations[currentLanguage].ctaText,
       ctaSubtitle: translations[currentLanguage].ctaSubtitle,
       ctaButton: translations[currentLanguage].actionButton,
       ctaUrl: '',
       ctaTimer: 3,
       // –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞
       marqueeEnabled: true,
       marqueeText: translations[currentLanguage].marqueeText,
       marqueeUrl: '/registration.html',
       marqueeTimer: 5,
       // –ù–∏–∂–Ω–∏–π –±–∞–Ω–Ω–µ—Ä
       bannerEnabled: true,
       bannerHtml: '<div>üéÅ CardGift Demo</div>',
       bannerUrl: '/registration.html'
   };
   
   displayCard(cardData);
}

      // ===== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ö–ê–†–¢–´ - –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –¢–ï–ö–°–¢–ê =====
async function displayCard(data) {
   setTimeout(async () => {
       document.getElementById('loadingScreen').classList.add('hidden');
       document.getElementById('mainCard').classList.remove('hidden');
       
       // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª—å —Ñ–æ–Ω–∞
       const cardArea = document.querySelector('.card-area');
       if (data.style) {
           cardArea.className = `card-area style-${data.style}`;
       }
       
       // üé¨ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
if (data.backgroundImage || data.mediaUrl) {
   const bgElement = document.getElementById('backgroundImage');
   const mediaUrl = data.backgroundImage || data.mediaUrl;
   
   // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –º–µ–¥–∏–∞
   if (data.mediaType === 'video' && mediaUrl.startsWith('data:video/')) {
       // –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ
const videoElement = document.createElement('video');
videoElement.src = mediaUrl;
videoElement.style.cssText = 'width: 100%; height: 100%; object-fit: contain; position: absolute; top: 0; left: 0; z-index: 2;';
videoElement.controls = true;
videoElement.loop = true;
videoElement.muted = true;
videoElement.autoplay = true;
videoElement.playsinline = true;

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
videoElement.addEventListener('loadeddata', () => {
   videoElement.play().catch(e => {
       console.log('Autoplay failed');
   });
});

bgElement.innerHTML = '';
bgElement.appendChild(videoElement);
bgElement.style.backgroundImage = 'none';

// –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–≤—É–∫–∞ –û–¢–î–ï–õ–¨–ù–û –æ—Ç bgElement
setTimeout(() => {
   const cardArea = document.querySelector('.card-area');
   const soundButton = document.createElement('button');
   soundButton.innerHTML = 'üîä –ó–≤—É–∫';
   soundButton.id = 'soundBtn';
   soundButton.style.cssText = 'position: absolute; top: 80px; right: 20px; z-index: 99999; background: #FFD700; color: black; border: 2px solid #FFA500; padding: 8px 12px; border-radius: 25px; cursor: pointer; font-weight: bold; font-size: 12px;';
   
   soundButton.onclick = () => {
       videoElement.muted = false;
       videoElement.play();
       soundButton.remove();
       alert('–ó–≤—É–∫ –≤–∫–ª—é—á–µ–Ω!');
   };
   
   cardArea.appendChild(soundButton);
}, 500);
   } else {
       // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
       bgElement.style.backgroundImage = `url(${mediaUrl})`;
       bgElement.style.backgroundSize = 'contain';
       bgElement.style.backgroundPosition = 'center';
       bgElement.style.backgroundRepeat = 'no-repeat';
   }
}

// üé¨ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ URL
if (data.videoUrl && data.videoUrl.trim()) {
   // –î–µ–∫–æ–¥–∏—Ä—É–µ–º HTML entities
   let cleanVideoUrl = data.videoUrl
       .replace(/&#x2F;/g, '/')
       .replace(/&amp;/g, '&')
       .replace(/&lt;/g, '<')
       .replace(/&gt;/g, '>')
       .replace(/&quot;/g, '"')
       .replace(/&#x27;/g, "'");
   
   console.log('üé¨ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∏–¥–µ–æ URL:', cleanVideoUrl);
   const videoData = videoProcessor.parseVideoUrl(cleanVideoUrl);
   if (videoData.isValid && videoData.platform === 'youtube') {
       console.log('‚úÖ YouTube –≤–∏–¥–µ–æ –≤–∞–ª–∏–¥–Ω–æ:', videoData);
       const bgElement = document.getElementById('backgroundImage');
       
       // –ò–°–ü–û–õ–¨–ó–£–ï–ú –ò–°–ü–†–ê–í–õ–ï–ù–ù–£–Æ –§–£–ù–ö–¶–ò–Æ
       videoProcessor.createEnhancedYouTubeElement(videoData, bgElement);
       bgElement.style.backgroundImage = 'none';
   }
}

// –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –ë–ï–ó –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
let title = '';
let subtitle = '';
let mainText = '';

if (data.greeting && data.greeting.trim()) {
   const greetingLines = data.greeting.split('\n').filter(line => line.trim());
   
   if (greetingLines.length > 0) {
       title = greetingLines[0];
       if (greetingLines.length > 1) {
           subtitle = greetingLines[1];
       }
       if (greetingLines.length > 2) {
           mainText = greetingLines.slice(2).join('\n');
       }
   }
}
       // –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –µ—Å–ª–∏ –Ω–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ - –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º fallback —Ç–µ–∫—Å—Ç—ã
title = title || '';
subtitle = subtitle || '';
mainText = mainText || '';
       
       // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç—ã (—Å–∫—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ –µ—Å—Ç—å –≤–∏–¥–µ–æ)
if ((data.videoUrl && data.videoUrl.trim()) || (data.mediaType === 'video' && data.mediaUrl)) {
   // –ï—Å–ª–∏ –µ—Å—Ç—å –ª—é–±–æ–µ –≤–∏–¥–µ–æ - —Å–∫—Ä—ã–≤–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç
   document.getElementById('cardTitle').style.display = 'none';
   document.getElementById('cardSubtitle').style.display = 'none';
   document.getElementById('greetingText').style.display = 'none';
} else {
   // –ï—Å–ª–∏ –Ω–µ—Ç –≤–∏–¥–µ–æ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç—ã
   document.getElementById('cardTitle').textContent = title;
   document.getElementById('cardSubtitle').textContent = subtitle;
   document.getElementById('greetingText').textContent = mainText;
   document.getElementById('cardTitle').style.display = 'block';
   document.getElementById('cardSubtitle').style.display = 'block';
   document.getElementById('greetingText').style.display = 'block';
}
       
       // CTA —Å–µ–∫—Ü–∏—è –∏ –∫–Ω–æ–ø–∫–∞
       if (data.ctaEnabled && data.ctaTitle && data.ctaButton) {
           document.getElementById('ctaText').textContent = data.ctaTitle;
           document.getElementById('ctaSubtitle').textContent = data.ctaSubtitle || '';
           document.getElementById('actionButton').textContent = data.ctaButton;
           
           const buttonDelay = (data.ctaTimer || 3) * 1000;
           setTimeout(() => {
               document.getElementById('ctaSection').classList.add('show');
               document.getElementById('actionButton').classList.add('show');
               console.log('‚úÖ CTA –ø–æ–∫–∞–∑–∞–Ω —á–µ—Ä–µ–∑', data.ctaTimer, '—Å–µ–∫');
           }, buttonDelay);
       } else {
           document.getElementById('ctaSection').classList.remove('show');
           document.getElementById('actionButton').classList.remove('show');
       }
       
       // –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–≤–µ—Ä—Ö—É
       if (data.marqueeEnabled && data.marqueeText) {
           document.getElementById('marqueeContent').textContent = data.marqueeText;
           const marqueeDelay = (data.marqueeTimer || 5) * 1000;
           setTimeout(() => {
               document.getElementById('topMarquee').classList.add('show');
               console.log('‚úÖ –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∞ –≤–≤–µ—Ä—Ö—É —á–µ—Ä–µ–∑', data.marqueeTimer, '—Å–µ–∫');
           }, marqueeDelay);
       } else {
           document.getElementById('topMarquee').classList.remove('show');
       }
       
       // –ù–∏–∂–Ω–∏–π –±–∞–Ω–Ω–µ—Ä
       if (data.bannerEnabled && (data.bannerHtml || data.bannerUrl)) {
           const bannerDelay = (data.bannerTimer || 8) * 1000;
           setTimeout(() => {
               document.getElementById('bottomBanner').classList.add('show');
               if (data.bannerHtml) {
                   document.getElementById('bottomBannerText').innerHTML = data.bannerHtml;
               }
               console.log('‚úÖ –ù–∏–∂–Ω–∏–π –±–∞–Ω–Ω–µ—Ä –ø–æ–∫–∞–∑–∞–Ω —á–µ—Ä–µ–∑', data.bannerTimer || 8, '—Å–µ–∫');
           }, bannerDelay);
       } else {
           document.getElementById('bottomBanner').classList.remove('show');
       }
       
       // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
       incrementViews(data);
       
       console.log('‚úÖ –ö–∞—Ä—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
       
   }, 1500);
}

      // ===== –°–ß–ï–¢–ß–ò–ö –ü–†–û–°–ú–û–¢–†–û–í =====
      function incrementViews(data) {
          if (data.isDemo) return;
          
          try {
              data.views = (data.views || 0) + 1;
              data.lastViewed = new Date().toISOString();
              localStorage.setItem(`card_${data.cardId}`, JSON.stringify(data));
              console.log('üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—Å—á–∏—Ç–∞–Ω:', data.views);
          } catch (error) {
              console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤:', error);
          }
      }

      // ===== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô =====
      
      // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–µ –≤–≤–µ—Ä—Ö—É
      function handleMarqueeClick() {
          console.log('üéØ –ö–ª–∏–∫ –ø–æ –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–µ');
          
          if (cardData && cardData.marqueeUrl && cardData.marqueeUrl.trim()) {
              const cleanedUrl = cleanUrl(cardData.marqueeUrl);
              if (cleanedUrl) {
                  window.open(cleanedUrl, '_blank');
              } else {
                  // Fallback –∫ registration.html
                  window.open('/registration.html', '_blank');
              }
          } else {
              // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é registration.html
              window.open('/registration.html', '_blank');
          }
      }

      // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
      function handleActionClick() {
          console.log('üéØ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –¥–µ–π—Å—Ç–≤–∏—è');
          
          if (cardData && cardData.ctaUrl && cardData.ctaUrl.trim()) {
              const cleanedUrl = cleanUrl(cardData.ctaUrl);
              if (cleanedUrl) {
                  window.open(cleanedUrl, '_blank');
              } else {
                  // Fallback –∫ registration.html
                  window.open('/registration.html', '_blank');
              }
          } else {
              // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é registration.html
              window.open('/registration.html', '_blank');
          }
      }

      function handleBottomBannerClick() {
          console.log('üéØ –ö–ª–∏–∫ –ø–æ –Ω–∏–∂–Ω–µ–º—É –±–∞–Ω–Ω–µ—Ä—É');
          
          if (cardData && cardData.bannerUrl && cardData.bannerUrl.trim()) {
              const cleanedUrl = cleanUrl(cardData.bannerUrl);
              if (cleanedUrl) {
                  window.open(cleanedUrl, '_blank');
              } else {
                  // Fallback –∫ registration.html
                  window.open('/registration.html', '_blank');
              }
          } else {
              // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é registration.html
              window.open('/registration.html', '_blank');
          }
      }

      // ===== –ü–û–ö–ê–ó –û–®–ò–ë–ö–ò =====
      function showError() {
          document.getElementById('loadingScreen').classList.add('hidden');
          document.getElementById('errorScreen').classList.remove('hidden');
      }

      // ===== WEB3 –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø =====
      async function initWeb3() {
          if (typeof window.ethereum !== 'undefined') {
              console.log('üîó MetaMask –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
              
              try {
                  const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                  console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ MetaMask:', accounts[0]);
                  return accounts[0];
              } catch (error) {
                  console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MetaMask:', error);
                  return null;
              }
          } else {
              console.warn('‚ö†Ô∏è MetaMask –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
              return null;
          }
      }

      // ===== –ü–û–î–ï–õ–ò–¢–¨–°–Ø –ö–ê–†–¢–û–ô =====
      function shareCard() {
          if (navigator.share) {
              navigator.share({
                  title: document.getElementById('cardTitle').textContent,
                  text: document.getElementById('greetingText').textContent,
                  url: currentUrl,
              });
          } else {
              // Fallback - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä
              navigator.clipboard.writeText(currentUrl).then(() => {
                  alert('üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
              });
          }
      }

      // ===== –ì–û–†–Ø–ß–ò–ï –ö–õ–ê–í–ò–®–ò =====
      document.addEventListener('keydown', function(e) {
          switch(e.key) {
              case 'Escape':
                  // –ó–∞–∫—Ä—ã—Ç—å –ª—é–±—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
                  document.querySelectorAll('[style*="position: fixed"]').forEach(el => {
                      if (el.style.zIndex === '10000') {
                          el.remove();
                      }
                  });
                  break;
              case 's':
                  if (e.ctrlKey || e.metaKey) {
                      e.preventDefault();
                      shareCard();
                  }
                  break;
              case 'r':
                  if (e.ctrlKey || e.metaKey) {
                      e.preventDefault();
                      location.reload();
                  }
                  break;
          }
      });

      // ===== –ê–ù–ê–õ–ò–¢–ò–ö–ê =====
      function trackEvent(eventName, eventData = {}) {
          const analyticsData = {
              event: eventName,
              cardId: cardData?.cardId || 'demo',
              timestamp: new Date().toISOString(),
              userAgent: navigator.userAgent,
              language: currentLanguage,
              url: currentUrl,
              ...eventData
          };
          
          console.log('üìä –°–æ–±—ã—Ç–∏–µ:', analyticsData);
      }

      // ===== –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö =====
      window.addEventListener('error', function(e) {
          console.error('‚ùå –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞:', e.error);
          trackEvent('error', {
              message: e.message,
              filename: e.filename,
              line: e.lineno,
              column: e.colno
          });
      });

      // ===== –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï –í–ò–î–ò–ú–û–°–¢–ò =====
      document.addEventListener('visibilitychange', function() {
          if (document.hidden) {
              trackEvent('card_hidden');
          } else {
              trackEvent('card_visible');
          }
      });

      console.log('üì± CardGift Mobile Card Viewer v2.1 –∑–∞–≥—Ä—É–∂–µ–Ω');
  </script>
</body>
</html>