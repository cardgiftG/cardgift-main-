<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">üéÅ CardGift - Get Card Generator</title>
    
    <!-- PWA Meta tags -->
    <meta name="description" content="Get free golden greeting card generator with referral system">
    <meta name="theme-color" content="#FFD700">
    
    <!-- Icons -->
    <link rel="icon" href="/assets/icons/icon-32x32.png" sizes="32x32">
    <link rel="manifest" href="/manifest.json">
    
    <!-- WEB3 –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* –ó–æ–ª–æ—Ç—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
        .language-switcher {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 4px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: #FFD700;
            padding: 6px 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 30px;
        }

        .lang-btn.active {
            background: rgba(255, 215, 0, 0.3);
            color: #FFF;
        }

        .lang-btn:hover {
            background: rgba(255, 215, 0, 0.2);
        }

        .registration-container {
            width: 100%;
            max-width: 500px;
            position: relative;
            z-index: 1;
            margin-top: 50px;
        }

        .registration-box {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ffd700;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            backdrop-filter: blur(20px);
        }

        .registration-box h2 {
            color: #ffd700;
            text-align: center;
            margin-bottom: 30px;
            font-size: clamp(24px, 6vw, 32px);
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .referral-info {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 25px;
            text-align: center;
            display: none;
        }

        .referral-info.show {
            display: block;
        }

        .referral-info .icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            color: #ffd700;
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px;
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid #444;
            border-radius: 10px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
            background: rgba(26, 26, 26, 0.9);
        }

        .hint {
            color: #888;
            font-size: 12px;
            margin-top: 5px;
            display: block;
        }

        .consent-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .consent-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin: 0;
            cursor: pointer;
        }

        .consent-text {
            color: #CCC;
            font-size: 14px;
            line-height: 1.5;
        }

        .consent-text strong {
            color: #FFD700;
        }

        .submit-btn {
            width: 100%;
            padding: 18px;
            background: #666;
            color: #333;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: not-allowed;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .submit-btn:disabled {
            background: #666;
            color: #333;
            cursor: not-allowed;
        }

        .submit-btn:enabled {
            background: linear-gradient(45deg, #ffd700, #ffa500);
            color: #1a1a1a;
            cursor: pointer;
            animation: pulse 2s infinite;
        }

        .submit-btn:enabled:hover {
            background: linear-gradient(45deg, #ffed4e, #ffb84d);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
        }

        .submit-btn:enabled:active {
            transform: translateY(0);
        }

        .submit-btn.loading {
            pointer-events: none;
        }

        .submit-btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid transparent;
            border-top-color: #1a1a1a;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* –ù–ï–ü–†–ò–ú–ï–¢–ù–ê–Ø –ö–ù–û–ü–ö–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö–û–®–ï–õ–¨–ö–ê */
        .wallet-connect-small {
            display: flex;
            justify-content: flex-end;
            margin-top: 15px;
            margin-bottom: 10px;
        }

        .wallet-btn-small {
            background: rgba(30, 136, 229, 0.1);
            border: 1px solid rgba(30, 136, 229, 0.3);
            color: #1E88E5;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .wallet-btn-small:hover {
            opacity: 1;
            background: rgba(30, 136, 229, 0.2);
            border-color: #1E88E5;
        }

        .wallet-btn-small:disabled {
            background: #666;
            color: #999;
            cursor: not-allowed;
            opacity: 0.5;
        }

        .wallet-status-small {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            color: #4CAF50;
            display: none;
            opacity: 0.8;
        }

        .wallet-status-small.show {
            display: block;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .success-message {
            text-align: center;
            color: #4CAF50;
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .success-message.show {
            display: block;
        }

        .success-message .icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .success-message h3 {
            color: #4CAF50;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .success-message p {
            margin: 10px 0;
            font-size: 16px;
            color: #CCC;
        }

        .countdown {
            font-size: 24px;
            color: #FFD700;
            font-weight: bold;
        }

        /* –ù–û–í–û–ï: WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï –ü–û–°–õ–ï –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò */
        .web3-offer {
            margin-top: 25px;
            padding: 25px;
            border: 2px solid #FFD700;
            border-radius: 15px;
            background: linear-gradient(135deg, rgba(255,215,0,0.1) 0%, rgba(255,165,0,0.1) 100%);
            text-align: center;
            backdrop-filter: blur(10px);
            display: none;
            animation: fadeInUp 1s ease;
        }

        .web3-offer.show {
            display: block;
        }

        .web3-offer .offer-icon {
            font-size: 3em;
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }

        .web3-offer h3 {
            color: #FFD700;
            font-size: clamp(18px, 5vw, 24px);
            margin-bottom: 15px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .web3-offer p {
            color: #CCC;
            margin-bottom: 20px;
            font-size: clamp(14px, 3.5vw, 16px);
            line-height: 1.5;
        }

        .web3-offer-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .web3-offer-btn {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            border: none;
            border-radius: 12px;
            padding: 15px 25px;
            font-size: clamp(14px, 3.5vw, 16px);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 180px;
        }

        .web3-offer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
            background: linear-gradient(45deg, #ffed4e, #ffb84d);
        }

        .web3-offer-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #CCC;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .web3-offer-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #FFF;
            border-color: rgba(255, 255, 255, 0.5);
        }

        .web3-offer .benefits {
            margin-top: 20px;
            text-align: left;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
        }

        .web3-offer .benefits h4 {
            color: #FFD700;
            margin-bottom: 10px;
            text-align: center;
        }

        .web3-offer .benefits ul {
            list-style: none;
            padding: 0;
        }

        .web3-offer .benefits li {
            color: #CCC;
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
            font-size: 14px;
        }

        .web3-offer .benefits li:before {
            content: '‚ú®';
            position: absolute;
            left: 0;
            color: #FFD700;
        }

        .web3-offer .requirement {
            margin-top: 15px;
            padding: 10px;
            background: rgba(30, 136, 229, 0.1);
            border: 1px solid rgba(30, 136, 229, 0.3);
            border-radius: 8px;
            font-size: 12px;
            color: #1E88E5;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        option {
            background: #1a1a1a;
            color: #fff;
        }

        .error-message {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #ff4444;
            color: #ff6666;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .error-message.show {
            display: block;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤ */
        @media (max-width: 600px) {
            .registration-container {
                padding: 10px;
            }
            
            .registration-box {
                padding: 25px;
            }
            
            .registration-box h2 {
                font-size: 22px;
                margin-bottom: 25px;
            }
            
            .form-group input,
            .form-group select {
                padding: 12px;
            }
            
            .submit-btn {
                padding: 15px;
                font-size: 16px;
            }

            .language-switcher {
                top: 5px;
                right: 5px;
                padding: 3px;
            }

            .lang-btn {
                padding: 4px 8px;
                font-size: 10px;
            }

            .web3-offer-buttons {
                flex-direction: column;
                align-items: center;
            }

            .web3-offer-btn {
                min-width: 200px;
            }
        }

        @media (max-width: 480px) {
            .registration-container {
                margin-top: 45px;
            }

            .web3-offer {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ -->
    <div class="language-switcher">
        <button class="lang-btn active" onclick="switchLanguage('en')" id="langEn">EN</button>
        <button class="lang-btn" onclick="switchLanguage('ru')" id="langRu">RU</button>
        <button class="lang-btn" onclick="switchLanguage('ua')" id="langUa">UA</button>
    </div>

    <div class="registration-container">
        <div class="registration-box">
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ—Ñ–µ—Ä–µ—Ä–µ -->
            <div id="referralInfo" class="referral-info">
                <div class="icon">üéÅ</div>
                <div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;" id="referralText">
                    You were invited by user <span id="referrerDisplay">ID</span>
                </div>
                <div style="color: #CCC; font-size: 14px;" id="referralSubtext">
                    Get free greeting card generator!
                </div>
            </div>

            <h2 id="mainTitle">üéÅ Get Generator as Gift</h2>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
            <div id="errorMessage" class="error-message"></div>
            
            <form id="registrationForm">
                <div class="form-group">
                    <label id="nameLabel">üë§ Your Name:</label>
                    <input type="text" id="userName" placeholder="" required maxlength="50">
                    <small class="hint" id="nameHint">Enter your name or nickname</small>
                </div>

                <div class="form-group">
                    <label id="messengerLabel">üì± Where to find you:</label>
                    <select id="messengerSelect" required>
                        <option value="" id="messengerPlaceholder">Choose messenger</option>
                        <option value="telegram">üì± Telegram</option>
                        <option value="whatsapp">üí¨ WhatsApp</option>
                        <option value="email">üìß Email</option>
                        <option value="instagram">üì∑ Instagram</option>
                        <option value="viber">üíú Viber</option>
                        <option value="facebook">üë§ Facebook</option>
                        <option value="tiktok">üéµ TikTok</option>
                        <option value="twitter">üê¶ Twitter/X</option>
                    </select>
                    <small class="hint" id="messengerHint">Choose convenient way to contact</small>
                </div>

                <div class="form-group" id="contactInputGroup" style="display: none;">
                    <label id="contactLabel">üìû Your Contact:</label>
                    <input type="text" id="contactInput" placeholder="" required maxlength="100">
                    <small id="contactHint" class="hint"></small>
                </div>

                <!-- –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                <div class="consent-checkbox">
                    <input type="checkbox" id="pushConsent" required>
                    <div class="consent-text">
                        <span id="consentText">I consent to receive <strong>push notifications</strong> and informational messages in the selected messenger. This will help stay updated on new features and CardGift opportunities.</span>
                    </div>
                </div>

                <button type="submit" id="submitBtn" class="submit-btn" disabled>
                    üéÅ <span id="submitBtnText">GET GENERATOR AS GIFT!</span>
                </button>

                <!-- –ù–ï–ü–†–ò–ú–ï–¢–ù–ê–Ø –ö–ù–û–ü–ö–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö–û–®–ï–õ–¨–ö–ê -->
                <div class="wallet-connect-small">
                    <button type="button" id="walletBtnSmall" class="wallet-btn-small" onclick="connectWallet()">
                        <span id="walletBtnText">üîó Connect Wallet</span>
                    </button>
                    <div id="walletStatusSmall" class="wallet-status-small">
                        <span id="walletConnectedText">‚úÖ Wallet Connected</span>
                    </div>
                </div>
            </form>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ -->
            <div id="successMessage" class="success-message">
                <div class="icon">‚úÖ</div>
                <h3 id="successTitle">Congratulations!</h3>
                <p id="successDesc">Greeting card generator is ready to use</p>
                <p id="successId">Your unique ID: <strong id="newUserId"></strong></p>
                <p id="walletInfo" style="display: none;">Wallet: <strong id="userWallet"></strong></p>
                <p id="countdownText">Redirecting in <span class="countdown" id="countdown">5</span> seconds...</p>
            </div>

            <!-- –ù–û–í–û–ï: WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï –ó–ê–†–ê–ë–û–¢–ö–ê -->
            <div id="web3Offer" class="web3-offer">
                <div class="offer-icon">üí∞</div>
                <h3 id="web3OfferTitle">Want to Earn Money?</h3>
                <p id="web3OfferDesc">Invite friends and earn cryptocurrency rewards for each activation!</p>
                
                <div class="benefits">
                    <h4 id="web3BenefitsTitle">üíé Benefits of Web3 Activation:</h4>
                    <ul>
                        <li id="web3Benefit1">Earn 0.015 opBNB for each friend who activates</li>
                        <li id="web3Benefit2">Get access to 5-level referral system</li>
                        <li id="web3Benefit3">Unlimited card storage in blockchain</li>
                        <li id="web3Benefit4">Advanced analytics and team management</li>
                        <li id="web3Benefit5">Push notifications to your referrals</li>
                    </ul>
                </div>

                <div class="web3-offer-buttons">
                    <button onclick="goToWeb3Dashboard()" class="web3-offer-btn" id="startEarningBtn">
                        üöÄ START EARNING NOW
                    </button>
                    <button onclick="skipWeb3Offer()" class="web3-offer-btn secondary" id="maybeLaterBtn">
                        Maybe Later
                    </button>
                </div>

                <div class="requirement">
                    <span id="requirementText">üí° Requires SafePal or MetaMask wallet connection</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/wallet.js"></script>
    <script src="/js/api.js"></script>
    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentLanguage = 'en';
        let referralId = null;
        let walletConnected = false;
        let userWalletAddress = null;
        let registeredUserId = null;

        // –ú–£–õ–¨–¢–ò–Ø–ó–´–ß–ù–û–°–¢–¨ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–ª—è WEB3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
        const translations = {
            en: {
                pageTitle: "üéÅ CardGift - Get Card Generator",
                referralText: "You were invited by user",
                referralSubtext: "Get free greeting card generator!",
                mainTitle: "üéÅ Get Generator as Gift",
                nameLabel: "üë§ Your Name:",
                namePlaceholder: "How should we address you?",
                nameHint: "Enter your name or nickname",
                messengerLabel: "üì± Where to find you:",
                messengerPlaceholder: "Choose messenger",
                messengerHint: "Choose convenient way to contact",
                contactLabel: "üìû Your Contact:",
                consentText: "I consent to receive <strong>push notifications</strong> and informational messages in the selected messenger. This will help stay updated on new features and CardGift opportunities.",
                submitBtnText: "GET GENERATOR AS GIFT!",
                walletBtnText: "üîó Connect Wallet",
                walletConnectedText: "‚úÖ Wallet Connected",
                successTitle: "Congratulations!",
                successDesc: "Greeting card generator is ready to use",
                successId: "Your unique ID:",
                walletInfoText: "Wallet:",
                countdownText: "Redirecting in",
                seconds: "seconds...",
                // WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï
                web3OfferTitle: "Want to Earn Money?",
                web3OfferDesc: "Invite friends and earn cryptocurrency rewards for each activation!",
                web3BenefitsTitle: "üíé Benefits of Web3 Activation:",
                web3Benefit1: "Earn 0.015 opBNB for each friend who activates",
                web3Benefit2: "Get access to 5-level referral system",
                web3Benefit3: "Unlimited card storage in blockchain",
                web3Benefit4: "Advanced analytics and team management", 
                web3Benefit5: "Push notifications to your referrals",
                startEarningBtn: "üöÄ START EARNING NOW",
                maybeLaterBtn: "Maybe Later",
                requirementText: "üí° Requires SafePal or MetaMask wallet connection",
                messengers: {
                    telegram: { placeholder: "@username or +380123456789", hint: "Enter your Telegram username (with @) or phone number" },
                    whatsapp: { placeholder: "+380123456789", hint: "Enter phone number with country code (e.g.: +380123456789)" },
                    email: { placeholder: "your@email.com", hint: "Enter your email address" },
                    instagram: { placeholder: "@username", hint: "Enter your Instagram username (with @)" },
                    viber: { placeholder: "+380123456789", hint: "Enter phone number with country code" },
                    facebook: { placeholder: "facebook.com/username or full name", hint: "Enter profile link or your full name on Facebook" },
                    tiktok: { placeholder: "@username", hint: "Enter your TikTok username (with @)" },
                    twitter: { placeholder: "@username", hint: "Enter your Twitter/X username (with @)" }
                }
            },
            ru: {
                pageTitle: "üéÅ CardGift - –ü–æ–ª—É—á–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–∫",
                referralText: "–í–∞—Å –ø—Ä–∏–≥–ª–∞—Å–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                referralSubtext: "–ü–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–∫!",
                mainTitle: "üéÅ –ü–æ–ª—É—á–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤ –ø–æ–¥–∞—Ä–æ–∫",
                nameLabel: "üë§ –í–∞—à–µ –∏–º—è:",
                namePlaceholder: "–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?",
                nameHint: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –Ω–∏–∫–Ω–µ–π–º",
                messengerLabel: "üì± –ì–¥–µ –≤–∞—Å –Ω–∞–π—Ç–∏:",
                messengerPlaceholder: "–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä",
                messengerHint: "–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏",
                contactLabel: "üìû –í–∞—à –∫–æ–Ω—Ç–∞–∫—Ç:",
                consentText: "–Ø –¥–∞—é —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ <strong>push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</strong> –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –∫—É—Ä—Å–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π CardGift.",
                submitBtnText: "–ü–û–õ–£–ß–ò–¢–¨ –ì–ï–ù–ï–†–ê–¢–û–† –í –ü–û–î–ê–†–û–ö!",
                walletBtnText: "üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫",
                walletConnectedText: "‚úÖ –ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω",
                successTitle: "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
                successDesc: "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–∫ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é",
                successId: "–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID:",
                walletInfoText: "–ö–æ—à–µ–ª–µ–∫:",
                countdownText: "–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑",
                seconds: "—Å–µ–∫—É–Ω–¥—ã...",
                // WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï
                web3OfferTitle: "–•–æ—Ç–∏—Ç–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–µ–Ω—å–≥–∏?",
                web3OfferDesc: "–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ –∑–∞ –∫–∞–∂–¥—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é!",
                web3BenefitsTitle: "üíé –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Web3 –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:",
                web3Benefit1: "–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ 0.015 opBNB –∑–∞ –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞",
                web3Benefit2: "–ü–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ 5-—É—Ä–æ–≤–Ω–µ–≤–æ–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ",
                web3Benefit3: "–ë–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ–∫ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ",
                web3Benefit4: "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π",
                web3Benefit5: "Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –≤–∞—à–∏—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤",
                startEarningBtn: "üöÄ –ù–ê–ß–ê–¢–¨ –ó–ê–†–ê–ë–ê–¢–´–í–ê–¢–¨",
                maybeLaterBtn: "–í–æ–∑–º–æ–∂–Ω–æ –ø–æ–∑–∂–µ",
                requirementText: "üí° –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ SafePal –∏–ª–∏ MetaMask",
                messengers: {
                    telegram: { placeholder: "@username –∏–ª–∏ +380123456789", hint: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Telegram username (—Å @) –∏–ª–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" },
                    whatsapp: { placeholder: "+380123456789", hint: "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å –∫–æ–¥–æ–º —Å—Ç—Ä–∞–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: +380123456789)" },
                    email: { placeholder: "–≤–∞—à@email.com", hint: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email –∞–¥—Ä–µ—Å" },
                    instagram: { placeholder: "@username", hint: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Instagram username (—Å @)" },
                    viber: { placeholder: "+380123456789", hint: "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å –∫–æ–¥–æ–º —Å—Ç—Ä–∞–Ω—ã" },
                    facebook: { placeholder: "facebook.com/username –∏–ª–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è", hint: "–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –∏–ª–∏ –≤–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è –≤ Facebook" },
                    tiktok: { placeholder: "@username", hint: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à TikTok username (—Å @)" },
                    twitter: { placeholder: "@username", hint: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Twitter/X username (—Å @)" }
                }
            },
            ua: {
                pageTitle: "üéÅ CardGift - –û—Ç—Ä–∏–º–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ª–∏—Å—Ç—ñ–≤–æ–∫",
                referralText: "–í–∞—Å –∑–∞–ø—Ä–æ—Å–∏–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á",
                referralSubtext: "–û—Ç—Ä–∏–º–∞–π—Ç–µ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ª–∏—Å—Ç—ñ–≤–æ–∫!",
                mainTitle: "üéÅ –û—Ç—Ä–∏–º–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤ –ø–æ–¥–∞—Ä—É–Ω–æ–∫",
                nameLabel: "üë§ –í–∞—à–µ —ñ–º'—è:",
                namePlaceholder: "–Ø–∫ –¥–æ –≤–∞—Å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è?",
                nameHint: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è –∞–±–æ –Ω—ñ–∫–Ω–µ–π–º",
                messengerLabel: "üì± –î–µ –≤–∞—Å –∑–Ω–∞–π—Ç–∏:",
                messengerPlaceholder: "–û–±–µ—Ä—ñ—Ç—å –º–µ—Å–µ–Ω–¥–∂–µ—Ä",
                messengerHint: "–û–±–µ—Ä—ñ—Ç—å –∑—Ä—É—á–Ω–∏–π —Å–ø–æ—Å—ñ–± –∑–≤'—è–∑–∫—É",
                contactLabel: "üìû –í–∞—à –∫–æ–Ω—Ç–∞–∫—Ç:",
                consentText: "–Ø –¥–∞—é –∑–≥–æ–¥—É –Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è <strong>push-—Å–ø–æ–≤—ñ—â–µ–Ω—å</strong> —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É –≤–∏–±—Ä–∞–Ω–æ–º—É –º–µ—Å–µ–Ω–¥–∂–µ—Ä—ñ. –¶–µ –¥–æ–ø–æ–º–æ–∂–µ –±—É—Ç–∏ –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π —Ç–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π CardGift.",
                submitBtnText: "–û–¢–†–ò–ú–ê–¢–ò –ì–ï–ù–ï–†–ê–¢–û–† –í –ü–û–î–ê–†–£–ù–û–ö!",
                walletBtnText: "üîó –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å",
                walletConnectedText: "‚úÖ –ì–∞–º–∞–Ω–µ—Ü—å –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ",
                successTitle: "–í—ñ—Ç–∞—î–º–æ!",
                successDesc: "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ª–∏—Å—Ç—ñ–≤–æ–∫ –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è",
                successId: "–í–∞—à —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID:",
                walletInfoText: "–ì–∞–º–∞–Ω–µ—Ü—å:",
                countdownText: "–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑",
                seconds: "—Å–µ–∫—É–Ω–¥–∏...",
                // WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï
                web3OfferTitle: "–•–æ—á–µ—Ç–µ –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≥—Ä–æ—à—ñ?",
                web3OfferDesc: "–ó–∞–ø—Ä–æ—à—É–π—Ç–µ –¥—Ä—É–∑—ñ–≤ —Ç–∞ –æ—Ç—Ä–∏–º—É–π—Ç–µ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ñ –∑–∞ –∫–æ–∂–Ω—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—é!",
                web3BenefitsTitle: "üíé –ü–µ—Ä–µ–≤–∞–≥–∏ Web3 –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó:",
                web3Benefit1: "–ó–∞—Ä–æ–±–ª—è–π—Ç–µ 0.015 opBNB –∑–∞ –∫–æ–∂–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ–≥–æ –¥—Ä—É–≥–∞",
                web3Benefit2: "–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ 5-—Ä—ñ–≤–Ω–µ–≤–æ—ó —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏",
                web3Benefit3: "–ë–µ–∑–ª—ñ–º—ñ—Ç–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤–æ–∫ —É –±–ª–æ–∫—á–µ–π–Ω—ñ",
                web3Benefit4: "–ü—Ä–æ–≥—Ä–µ—Å–∏–≤–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–º–∞–Ω–¥–æ—é",
                web3Benefit5: "Push-—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –¥–ª—è –≤–∞—à–∏—Ö —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤",
                startEarningBtn: "üöÄ –ü–û–ß–ê–¢–ò –ó–ê–†–û–ë–õ–Ø–¢–ò",
                maybeLaterBtn: "–ú–æ–∂–ª–∏–≤–æ –ø—ñ–∑–Ω—ñ—à–µ",
                requirementText: "üí° –ü–æ—Ç—Ä—ñ–±–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≥–∞–º–∞–Ω—Ü—è SafePal –∞–±–æ MetaMask",
                messengers: {
                    telegram: { placeholder: "@username –∞–±–æ +380123456789", hint: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à Telegram username (–∑ @) –∞–±–æ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É" },
                    whatsapp: { placeholder: "+380123456789", hint: "–í–≤–µ–¥—ñ—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –∑ –∫–æ–¥–æ–º –∫—Ä–∞—ó–Ω–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: +380123456789)" },
                    email: { placeholder: "–≤–∞—à@email.com", hint: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à—É email –∞–¥—Ä–µ—Å—É" },
                    instagram: { placeholder: "@username", hint: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à Instagram username (–∑ @)" },
                    viber: { placeholder: "+380123456789", hint: "–í–≤–µ–¥—ñ—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –∑ –∫–æ–¥–æ–º –∫—Ä–∞—ó–Ω–∏" },
                    facebook: { placeholder: "facebook.com/username –∞–±–æ –ø–æ–≤–Ω–µ —ñ–º'—è", hint: "–í–≤–µ–¥—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ—Ñ—ñ–ª—å –∞–±–æ –≤–∞—à–µ –ø–æ–≤–Ω–µ —ñ–º'—è –≤ Facebook" },
                    tiktok: { placeholder: "@username", hint: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à TikTok username (–∑ @)" },
                    twitter: { placeholder: "@username", hint: "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à Twitter/X username (–∑ @)" }
                }
            }
        };

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–∑—ã–∫–∞
            initializeLanguage();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
            checkReferralLink();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
            initializeForm();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
            checkWalletConnection();
        });

        // –§–£–ù–ö–¶–ò–ò –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –Ø–ó–´–ö–ê
        function switchLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('preferredLanguage', lang);
            updateLanguageButtons();
            updatePageContent();
        }

        function initializeLanguage() {
            const urlParams = new URLSearchParams(window.location.search);
            const langFromUrl = urlParams.get('lang');
            const savedLang = localStorage.getItem('preferredLanguage');
            
            currentLanguage = langFromUrl || savedLang || 'en';
            updateLanguageButtons();
            updatePageContent();
        }

        function updateLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`lang${currentLanguage.charAt(0).toUpperCase() + currentLanguage.slice(1)}`).classList.add('active');
        }

        function updatePageContent() {
            const trans = translations[currentLanguage];
            
            // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
            document.getElementById('pageTitle').textContent = trans.pageTitle;
            document.title = trans.pageTitle;
            document.getElementById('referralText').innerHTML = `${trans.referralText} <span id="referrerDisplay">ID</span>`;
            document.getElementById('referralSubtext').textContent = trans.referralSubtext;
            document.getElementById('mainTitle').textContent = trans.mainTitle;
            document.getElementById('nameLabel').textContent = trans.nameLabel;
            document.getElementById('userName').placeholder = trans.namePlaceholder;
            document.getElementById('nameHint').textContent = trans.nameHint;
            document.getElementById('messengerLabel').textContent = trans.messengerLabel;
            document.getElementById('messengerPlaceholder').textContent = trans.messengerPlaceholder;
            document.getElementById('messengerHint').textContent = trans.messengerHint;
            document.getElementById('contactLabel').textContent = trans.contactLabel;
            document.getElementById('consentText').innerHTML = trans.consentText;
            document.getElementById('submitBtnText').textContent = trans.submitBtnText;
            document.getElementById('walletBtnText').textContent = trans.walletBtnText;
            document.getElementById('walletConnectedText').textContent = trans.walletConnectedText;
            document.getElementById('successTitle').textContent = trans.successTitle;
            document.getElementById('successDesc').textContent = trans.successDesc;
            document.getElementById('successId').innerHTML = `${trans.successId} <strong id="newUserId"></strong>`;
            document.getElementById('countdownText').innerHTML = `${trans.countdownText} <span class="countdown" id="countdown">5</span> ${trans.seconds}`;
            
            // WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï
            document.getElementById('web3OfferTitle').textContent = trans.web3OfferTitle;
            document.getElementById('web3OfferDesc').textContent = trans.web3OfferDesc;
            document.getElementById('web3BenefitsTitle').textContent = trans.web3BenefitsTitle;
            document.getElementById('web3Benefit1').textContent = trans.web3Benefit1;
            document.getElementById('web3Benefit2').textContent = trans.web3Benefit2;
            document.getElementById('web3Benefit3').textContent = trans.web3Benefit3;
            document.getElementById('web3Benefit4').textContent = trans.web3Benefit4;
            document.getElementById('web3Benefit5').textContent = trans.web3Benefit5;
            document.getElementById('startEarningBtn').textContent = trans.startEarningBtn;
            document.getElementById('maybeLaterBtn').textContent = trans.maybeLaterBtn;
            document.getElementById('requirementText').textContent = trans.requirementText;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ placeholder –∏ hint –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —è–∑—ã–∫–∞
            const messengerSelect = document.getElementById('messengerSelect');
            if (messengerSelect.value) {
                updateContactField(messengerSelect.value);
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –†–ï–§–ï–†–ê–õ–¨–ù–û–ô –°–°–´–õ–ö–ò
        function checkReferralLink() {
            const urlParams = new URLSearchParams(window.location.search);
            referralId = urlParams.get('ref') || urlParams.get('referral') || urlParams.get('r');
            
            if (referralId) {
                document.getElementById('referrerDisplay').textContent = referralId;
                document.getElementById('referralInfo').classList.add('show');
            }
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –§–û–†–ú–´
        function initializeForm() {
            const form = document.getElementById('registrationForm');
            const submitBtn = document.getElementById('submitBtn');
            const nameInput = document.getElementById('userName');
            const messengerSelect = document.getElementById('messengerSelect');
            const contactInput = document.getElementById('contactInput');
            const consentCheckbox = document.getElementById('pushConsent');

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞
            messengerSelect.addEventListener('change', function() {
                const selectedMessenger = this.value;
                if (selectedMessenger) {
                    updateContactField(selectedMessenger);
                    document.getElementById('contactInputGroup').style.display = 'block';
                } else {
                    document.getElementById('contactInputGroup').style.display = 'none';
                }
                checkFormValidity();
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º—ã
            [nameInput, messengerSelect, contactInput, consentCheckbox].forEach(element => {
                element.addEventListener('input', checkFormValidity);
                element.addEventListener('change', checkFormValidity);
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            form.addEventListener('submit', handleFormSubmit);
        }

        function updateContactField(messenger) {
            const trans = translations[currentLanguage];
            const contactInput = document.getElementById('contactInput');
            const contactHint = document.getElementById('contactHint');
            
            if (trans.messengers[messenger]) {
                contactInput.placeholder = trans.messengers[messenger].placeholder;
                contactHint.textContent = trans.messengers[messenger].hint;
            }
        }

        function checkFormValidity() {
            const name = document.getElementById('userName').value.trim();
            const messenger = document.getElementById('messengerSelect').value;
            const contact = document.getElementById('contactInput').value.trim();
            const consent = document.getElementById('pushConsent').checked;
            
            const isValid = name && messenger && contact && consent;
            const submitBtn = document.getElementById('submitBtn');
            
            if (isValid) {
                submitBtn.disabled = false;
            } else {
                submitBtn.disabled = true;
            }
        }

        // –û–ë–†–ê–ë–û–¢–ß–ò–ö –û–¢–ü–†–ê–í–ö–ò –§–û–†–ú–´
        async function handleFormSubmit(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;

            try {
                const userData = {
                    name: document.getElementById('userName').value.trim(),
                    messenger: document.getElementById('messengerSelect').value,
                    contact: document.getElementById('contactInput').value.trim(),
                    language: currentLanguage,
                    referredBy: referralId,
                    walletAddress: userWalletAddress,
                    registrationDate: new Date().toISOString()
                };

                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const result = await saveUser(userData);
                
                if (result.success) {
                    registeredUserId = result.userId;
                    showSuccess(result.userId, userData.walletAddress);
                } else {
                    throw new Error(result.error || 'Registration failed');
                }

            } catch (error) {
                console.error('Registration error:', error);
                showError('Registration failed. Please try again.');
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –£–°–ü–ï–•–ê
        function showSuccess(userId, walletAddress) {
            document.getElementById('registrationForm').style.display = 'none';
            
            const successMessage = document.getElementById('successMessage');
            document.getElementById('newUserId').textContent = userId;
            
            if (walletAddress) {
                document.getElementById('userWallet').textContent = 
                    walletAddress.substring(0, 6) + '...' + walletAddress.substring(walletAddress.length - 4);
                document.getElementById('walletInfo').style.display = 'block';
            }
            
            successMessage.classList.add('show');
            
            // –ù–û–í–û–ï: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º WEB3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã (–µ—Å–ª–∏ –∫–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω)
            if (!walletAddress) {
                setTimeout(() => {
                    showWeb3Offer();
                }, 3000);
            } else {
                // –ï—Å–ª–∏ –∫–æ—à–µ–ª–µ–∫ —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω, –ø–µ—Ä–µ—Ö–æ–¥–∏–º —Å—Ä–∞–∑—É –Ω–∞ –¥–∞—à–±–æ—Ä–¥
                startCountdown(userId);
            }
        }

        // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü–û–ö–ê–ó WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø
        function showWeb3Offer() {
            const web3Offer = document.getElementById('web3Offer');
            web3Offer.classList.add('show');
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—ã—á–Ω—ã–π countdown
            clearInterval(window.countdownInterval);
            document.getElementById('countdownText').style.display = 'none';
        }

        // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü–ï–†–ï–•–û–î –ù–ê WEB3 –î–ê–®–ë–û–†–î
        function goToWeb3Dashboard() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–ª–∞–≥ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ WEB3
            localStorage.setItem('pendingWeb3Activation', 'true');
            localStorage.setItem('registeredUserId', registeredUserId);
            
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –¥–∞—à–±–æ—Ä–¥ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            const params = new URLSearchParams({
                userId: registeredUserId,
                upgrade: 'true',
                lang: currentLanguage
            });
            
            window.location.href = `/dashboard.html?${params.toString()}`;
        }

        // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü–†–û–ü–£–°–ö WEB3 –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø
        function skipWeb3Offer() {
            // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –æ–±—ã—á–Ω—ã–π countdown
            document.getElementById('web3Offer').classList.remove('show');
            document.getElementById('countdownText').style.display = 'block';
            startCountdown(registeredUserId);
        }

        function startCountdown(userId) {
            let timeLeft = 5;
            const countdownElement = document.getElementById('countdown');
            
            window.countdownInterval = setInterval(() => {
                timeLeft--;
                countdownElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(window.countdownInterval);
                    // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ–±—ã—á–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (–±–µ–∑ WEB3)
                    window.location.href = `/generator.html?userId=${userId}&lang=${currentLanguage}`;
                }
            }, 1000);
        }

        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.classList.add('show');
            
            setTimeout(() => {
                errorElement.classList.remove('show');
            }, 5000);
        }

        // –§–£–ù–ö–¶–ò–ò –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö–û–®–ï–õ–¨–ö–ê
        async function connectWallet() {
            const walletBtn = document.getElementById('walletBtnSmall');
            walletBtn.disabled = true;
            walletBtn.innerHTML = '<span>üîÑ Connecting...</span>';

            try {
                if (typeof window.ethereum !== 'undefined') {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    if (accounts.length > 0) {
                        userWalletAddress = accounts[0];
                        walletConnected = true;
                        showWalletConnected();
                    }
                } else {
                    throw new Error('Wallet not found');
                }
            } catch (error) {
                console.error('Wallet connection error:', error);
                walletBtn.disabled = false;
                walletBtn.innerHTML = '<span id="walletBtnText">üîó Connect Wallet</span>';
                updatePageContent();
                showError('Failed to connect wallet. Please install SafePal or MetaMask.');
            }
        }

        function showWalletConnected() {
            document.getElementById('walletBtnSmall').style.display = 'none';
            document.getElementById('walletStatusSmall').classList.add('show');
        }

        async function checkWalletConnection() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                    if (accounts.length > 0) {
                        userWalletAddress = accounts[0];
                        walletConnected = true;
                        showWalletConnected();
                    }
                } catch (error) {
                    console.log('Wallet not connected');
                }
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (–ó–ê–ì–õ–£–®–ö–ê - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é)
        async function saveUser(userData) {
            return new Promise((resolve) => {
                // –ò–º–∏—Ç–∞—Ü–∏—è API –≤—ã–∑–æ–≤–∞
                setTimeout(() => {
                    const userId = 'CG' + Date.now().toString().slice(-6);
                    resolve({
                        success: true,
                        userId: userId
                    });
                }, 1000);
            });
        }
    </script>
</body>
</html>